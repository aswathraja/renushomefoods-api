import{r as s,j as e,F as ge,P as ue,U as he,X as xe,d as pe,e as ye}from"./vendor-react-Bv33ryjV.js";import{C as je}from"./dropdown-menu-BDj5FxyU.js";import{I as ve}from"./InventoryNavBar-CIk6Z_D_.js";import{u as fe,B as d,A as E,e as q,c as l}from"./index-BgzncNPj.js";import{P as $}from"./PhotoGallaryModal-D9I193v8.js";import{C as B,a as K,b as X,c as R}from"./card-dPuP1Ci1.js";import{D as be,a as Ne,b as Ce,c as ke,d as we}from"./dialog-DjJou7Bz.js";import{I as k}from"./input-B6PrAciv.js";import{L as n}from"./label-bvSFhUHd.js";import{S as G,a as z,b as H,c as M,d as L}from"./select-CpYWT6P5.js";import{T as De,a as Se,b as U,c as u,d as Fe,e as m}from"./table-bzACJohG.js";import{T as Te}from"./textarea-C9SzNJ62.js";import"./TopBar-D2vj-zy0.js";import"./vendor-pdf-DxqLLkkN.js";import"./index-BlLmK--u.js";const Je=()=>{const{effectiveTheme:i}=fe(),[V,w]=s.useState([]),[Q,j]=s.useState(!1),[h,D]=s.useState(null),[t,o]=s.useState({category:"",description:"",image:null,displayOrder:"",type:""}),[S,p]=s.useState(""),[F,v]=s.useState(""),[Y,y]=s.useState(!1),[T,I]=s.useState(null),[J,f]=s.useState({}),x=s.useRef(null),[W,Z]=s.useState(!1),[P,_]=s.useState(""),[O,ee]=s.useState(""),[b,ae]=s.useState("all"),[N,re]=s.useState("all"),se=[{value:"all",label:"All"},{value:"true",label:"Has Image"},{value:"false",label:"No Image"}],te=[{value:"all",label:"All"},{value:"Product",label:"Product"},{value:"Item",label:"Item"}],le=[{value:"Product",label:"Product"},{value:"Item",label:"Item"}],C=()=>{const a={type:N!=="all"?N:null,category:P||null,description:O||null,image:b!=="all"?b==="true":null};E.postData({endpoint:"/inventory/get-categories",body:{request:q(a)},successCallback:r=>{Array.isArray(r)?w(r):w([])},errorCallback:()=>{w([]),l.error("Failed to fetch categories")}})};s.useEffect(()=>{C()},[]),s.useEffect(()=>{C()},[P,O,b,N]);const ie=a=>{if(a.preventDefault(),!t.category.trim()){l.error("Category name is required");return}if(!t.displayOrder||isNaN(Number(t.displayOrder))){l.error("Display Order must be a valid number");return}if(!F){l.error("Type is required");return}const r=localStorage.getItem("token");if(!r){l.error("No token found");return}const A={category:t.category,description:t.description,displayOrder:parseInt(t.displayOrder),type:F,image:h?.image||"",token:r};h&&(A.id=h.id);const g=new FormData;g.append("request",q(A)),t.image&&g.append("file",t.image),E.postFormData({endpoint:"/inventory/save-category",body:g,Authorization:`Bearer ${r}`,successCallback:c=>{l.success(h?"Category updated successfully":"Category added successfully"),j(!1),D(null),o({category:"",description:"",image:null,displayOrder:"",type:""}),v(""),p(""),f({}),x.current&&(x.current.value=""),C()},errorCallback:c=>{l.error("Failed to save category"),console.error("Error saving category:",c)}})},ne=a=>{D(a),o({category:a.category,description:a.description||"",image:null,displayOrder:a.displayOrder?.toString()||"",type:a.type}),v(a.type),p("/static/inventory"+a.image||""),j(!0)},oe=a=>{I(a),y(!0)},ce=()=>{if(!T)return;const a=localStorage.getItem("token");if(!a){l.error("No token found");return}E.postData({endpoint:"/inventory/delete-category",body:{request:q({id:T.id,token:a})},successCallback:r=>{l.success("Category deleted successfully"),C(),y(!1),I(null)},errorCallback:r=>{l.error(r.error||"Failed to delete category"),y(!1),I(null)}})},de=a=>{const r=a.target.files?.[0];if(r){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(r.type)){f(c=>({...c,image:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));return}if(r.size>5*1024*1024){f(c=>({...c,image:"File size must be less than 5MB"}));return}o({...t,image:r}),f(c=>({...c,image:""}));const g=new FileReader;g.onload=()=>{p(g.result)},g.readAsDataURL(r)}},me=()=>{o({...t,image:null}),p(""),x.current&&(x.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ve,{}),e.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Categories"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",onClick:()=>Z(!W),className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Filters"]}),e.jsxs(d,{variant:"outline",onClick:()=>{D(null),o({category:"",description:"",image:null,displayOrder:"",type:""}),v(""),p(""),j(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Add Category"]})]})]}),W&&e.jsxs(B,{className:"mb-6",children:[e.jsx(K,{children:e.jsx(X,{children:"Filters"})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category"}),e.jsx(k,{value:P,onChange:a=>_(a.target.value),placeholder:"Enter category name",className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(k,{value:O,onChange:a=>ee(a.target.value),placeholder:"Enter description",className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(G,{value:N,onValueChange:re,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{})}),e.jsx(M,{children:te.map(a=>e.jsx(L,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Image"}),e.jsxs(G,{value:b,onValueChange:ae,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{})}),e.jsx(M,{children:se.map(a=>e.jsx(L,{value:a.value,children:a.label},a.value))})]})]})]})})]}),Q&&e.jsxs(B,{className:"mb-6",children:[e.jsx(K,{children:e.jsx(X,{children:h?"Edit Category":"Add Category"})}),e.jsx("form",{onSubmit:ie,children:e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category Name"}),e.jsx(k,{value:t.category,onChange:a=>o({...t,category:a.target.value}),required:!0,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Display Order"}),e.jsx(k,{type:"text",value:t.displayOrder,onChange:a=>o({...t,displayOrder:a.target.value.replace(/[^0-9]/g,"")}),onKeyDown:a=>{!/[0-9]/.test(a.key)&&a.key!=="Backspace"&&a.key!=="Delete"&&a.key!=="ArrowLeft"&&a.key!=="ArrowRight"&&a.key!=="Tab"&&a.preventDefault()},onPaste:a=>{const r=a.clipboardData.getData("text");/^[0-9]*$/.test(r)||a.preventDefault()},required:!0,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(Te,{value:t.description,onChange:a=>o({...t,description:a.target.value}),rows:3,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(G,{value:F,onValueChange:v,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{placeholder:"Select type"})}),e.jsx(M,{children:le.map(a=>e.jsx(L,{value:a.value,children:a.label},a.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Image ",e.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),S?e.jsxs("div",{className:"relative flex",children:[e.jsx("div",{className:"aspect-[3/2] sm:aspect-[3/2] md:aspect-[30/9] lg:aspect-[30/9] object-contain overflow-hidden rounded-lg border",children:e.jsx($,{title:"Category Image",imageSrcs:[S],children:e.jsx("img",{src:S,alt:"Preview",className:"w-full h-full object-contain"})})}),e.jsx("button",{type:"button",onClick:me,className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(xe,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>x.current?.click(),children:[e.jsx(he,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload an image"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),e.jsx("input",{ref:x,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:de,className:"hidden"})]}),J.image&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:J.image})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(d,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[h?"Update":"Add"," Category"]})]})]})})]}),e.jsx(B,{children:e.jsx(R,{className:"p-0",children:e.jsxs(De,{children:[e.jsx(Se,{children:e.jsxs(U,{children:[e.jsx(u,{children:"ID"}),e.jsx(u,{children:"Display Order"}),e.jsx(u,{children:"Category"}),e.jsx(u,{children:"Description"}),e.jsx(u,{children:"Type"}),e.jsx(u,{children:"Image"}),e.jsx(u,{children:"Actions"})]})}),e.jsxs(Fe,{children:[V.map(a=>e.jsxs(U,{children:[e.jsx(m,{children:a.id}),e.jsx(m,{children:a.displayOrder}),e.jsx(m,{children:a.category}),e.jsx(m,{children:a.description||"-"}),e.jsx(m,{children:a.type}),e.jsx(m,{children:a.image?e.jsx($,{title:"Category Image",imageSrcs:["/static/inventory"+a.image],children:e.jsx("img",{src:"/static/inventory"+a.image,alt:a.category,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):e.jsx("span",{className:"text-muted-foreground",children:"No Image"})}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ne(a),children:[e.jsx(pe,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>oe(a),className:"border-red-600 text-red-600 hover:bg-red-50",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},a.id)),V.length===0&&e.jsx(U,{children:e.jsx(m,{colSpan:7,className:"text-center",children:"No categories found."})})]})]})})})]})]}),e.jsx(be,{open:Y,onOpenChange:y,children:e.jsxs(Ne,{className:i==="dark"?"bg-gray-900 text-white":"",children:[e.jsx(Ce,{children:e.jsx(ke,{children:"Confirm Delete"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{children:['Are you sure you want to delete the category "',T?.category,'"?']}),e.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),e.jsxs(we,{children:[e.jsx(d,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:ce,children:"Delete"})]})]})}),e.jsx(je,{})]})};export{Je as default};
