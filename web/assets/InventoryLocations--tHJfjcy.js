import{u as ce,r as a,j as e,B as m,A,e as T,c as n}from"./index-DbPu8K_2.js";import{X as de,C as me}from"./dropdown-menu-ndXhbIqo.js";import{I as xe}from"./InventoryNavBar-Cyk7ZMcH.js";import{P as z}from"./PhotoGallaryModal-B6q__LCK.js";import{C as I,a as M,b as U,c as $}from"./card-BaY4vyi0.js";import{D as he,a as ue,b as ge,c as ye,d as pe}from"./dialog-CLav4IZ4.js";import{I as i}from"./input-uIhbwgE_.js";import{L as o}from"./label-Dx_XjS3E.js";import{S as je,a as fe,b as ve,c as Ne,d as be}from"./select-KOpAoyEo.js";import{F as ke}from"./funnel-CYFOiLLx.js";import{P as Ce}from"./plus-CAVwJglQ.js";import{U as Fe}from"./upload-6cL1VcWr.js";import{S as we}from"./square-pen-BU1ldGM8.js";import{T as Se}from"./trash-2-WSuUzwgI.js";import"./TopBar-BblwwY8A.js";import"./chevron-left-BlR7maOI.js";import"./index-DsFJuTvR.js";import"./chevron-down-mIi7_xTw.js";const Ve=()=>{const{effectiveTheme:s}=ce(),[W,N]=a.useState([]),[O,p]=a.useState(!1),[h,b]=a.useState(null),[r,c]=a.useState({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),[k,g]=a.useState(""),[H,y]=a.useState(!1),[C,F]=a.useState(null),[G,j]=a.useState({}),u=a.useRef(null),[B,J]=a.useState(!1),[w,V]=a.useState(""),[S,X]=a.useState(""),[L,K]=a.useState(""),[P,Q]=a.useState(""),[Y,Le]=a.useState(""),[D,Z]=a.useState(""),[q,_]=a.useState(""),[E,ee]=a.useState(""),[f,te]=a.useState("all"),re=[{value:"all",label:"All"},{value:"true",label:"With Photo"},{value:"false",label:"Without Photo"}],v=()=>{const t={name:w||null,floor:S||null,room:L||null,rack:P||null,city:D||null,state:q||null,country:E||null,photo:f!=="all"?f==="true":null};A.postData({endpoint:"/inventory/locations",body:{request:T(t)},successCallback:l=>{Array.isArray(l)?N(l):N([])},errorCallback:()=>{N([]),n.error("Failed to fetch locations")}})};a.useEffect(()=>{v()},[]),a.useEffect(()=>{v()},[w,S,L,P,Y,D,q,E,f]);const ae=t=>{if(t.preventDefault(),!r.name.trim()){n.error("Name is required");return}if(!r.floor.trim()){n.error("Floor is required");return}if(!r.room.trim()){n.error("Room is required");return}if(!r.rack.trim()){n.error("Rack is required");return}if(!r.city.trim()){n.error("City is required");return}if(!r.state.trim()){n.error("State is required");return}if(!r.country.trim()){n.error("Country is required");return}const l=localStorage.getItem("token");if(!l){n.error("No token found");return}const R={name:r.name,floor:r.floor,room:r.room,rack:r.rack,addressLine1:r.addressLine1,city:r.city,state:r.state,country:r.country,photo:h?.photo||"",token:l};h&&(R.id=h.id);const x=new FormData;x.append("request",T(R)),r.photo&&x.append("file",r.photo),A.postFormData({endpoint:"/inventory/save-location",body:x,Authorization:`Bearer ${l}`,successCallback:d=>{n.success(h?"Location updated successfully":"Location added successfully"),p(!1),b(null),c({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),g(""),v()},errorCallback:d=>{n.error("Failed to save location"),console.error("Error saving location:",d)}})},se=t=>{b(t),c({name:t.name,floor:t.floor,room:t.room,rack:t.rack,city:t.city,state:t.state,country:t.country,addressLine1:t.addressLine1,photo:null}),g(t.photo&&"/static/inventory"+t.photo||""),p(!0)},oe=t=>{F(t),y(!0)},le=()=>{if(!C)return;const t=localStorage.getItem("token");if(!t){n.error("No token found");return}A.postData({endpoint:"/inventory/delete-location",body:{request:T({id:C.id,token:t})},successCallback:l=>{n.success("Location deleted successfully"),v(),y(!1),F(null)},errorCallback:l=>{n.error(l.error||"Failed to delete location"),y(!1),F(null)}})},ie=t=>{const l=t.target.files?.[0];if(l){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(l.type)){j(d=>({...d,photo:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));return}if(l.size>5*1024*1024){j(d=>({...d,photo:"File size must be less than 5MB"}));return}c({...r,photo:l}),j(d=>({...d,photo:""}));const x=new FileReader;x.onload=()=>{g(x.result)},x.readAsDataURL(l)}},ne=()=>{c({...r,photo:null}),g(""),u.current&&(u.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen",children:[e.jsx(xe,{}),e.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Locations"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>J(!B),className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Filters"]}),e.jsxs(m,{variant:"outline",onClick:()=>{b(null),c({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),g(""),j({}),u.current&&(u.current.value=""),p(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})]}),B&&e.jsxs(I,{className:"mb-6",children:[e.jsx(M,{children:e.jsx(U,{children:"Filters"})}),e.jsxs($,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Name"}),e.jsx(i,{value:w,onChange:t=>V(t.target.value),placeholder:"Enter Name",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Floor"}),e.jsx(i,{value:S,onChange:t=>X(t.target.value),placeholder:"Enter Floor",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Room"}),e.jsx(i,{value:L,onChange:t=>K(t.target.value),placeholder:"Enter Room",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Rack"}),e.jsx(i,{value:P,onChange:t=>Q(t.target.value),placeholder:"Enter Rack",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"City"}),e.jsx(i,{value:D,onChange:t=>Z(t.target.value),placeholder:"Enter City",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"State"}),e.jsx(i,{value:q,onChange:t=>_(t.target.value),placeholder:"Enter State",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Country"}),e.jsx(i,{value:E,onChange:t=>ee(t.target.value),placeholder:"Enter Country",className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Photo"}),e.jsxs(je,{value:f,onValueChange:te,children:[e.jsx(fe,{className:s==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(ve,{})}),e.jsx(Ne,{children:re.map(t=>e.jsx(be,{value:t.value,children:t.label},t.value))})]})]})]})]})]}),O&&e.jsxs(I,{className:"mb-6",children:[e.jsx(M,{children:e.jsx(U,{children:h?"Edit Location":"Add Location"})}),e.jsx("form",{onSubmit:ae,children:e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Location Name"}),e.jsx(i,{value:r.name,onChange:t=>c({...r,name:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Floor"}),e.jsx(i,{value:r.floor,onChange:t=>c({...r,floor:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Room"}),e.jsx(i,{value:r.room,onChange:t=>c({...r,room:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Rack"}),e.jsx(i,{value:r.rack,onChange:t=>c({...r,rack:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Address"}),e.jsx(i,{value:r.addressLine1,onChange:t=>c({...r,addressLine1:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"City"}),e.jsx(i,{value:r.city,onChange:t=>c({...r,city:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"State"}),e.jsx(i,{value:r.state,onChange:t=>c({...r,state:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Country"}),e.jsx(i,{value:r.country,onChange:t=>c({...r,country:t.target.value}),required:!0,className:s==="dark"?"bg-gray-800 text-white border-gray-600":""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:["Photo ",e.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),k?e.jsxs("div",{className:"relative",children:[e.jsx(z,{title:"Location Photo",imageSrcs:[k],children:e.jsx("img",{src:k,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})}),e.jsx("button",{type:"button",onClick:ne,className:"absolute top-0 left-20 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(de,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>u.current?.click(),children:[e.jsx(Fe,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload a photo"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),e.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:ie,className:"hidden"})]}),G.photo&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:G.photo})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsxs(m,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[h?"Update":"Add"," Location"]})]})]})})]}),e.jsx(I,{children:e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:`w-full ${s==="dark"?"dark":""}`,children:[e.jsx("thead",{className:`${s==="dark"?"bg-gray-800":"bg-gray-50"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Floor"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Room"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rack"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Photo"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:W.map(t=>e.jsxs("tr",{className:`${s==="dark"?"bg-gray-900 hover:bg-gray-800":"bg-white hover:bg-gray-50"}`,children:[e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:t.id}),e.jsx("td",{className:"px-4 py-4 text-sm font-medium text-gray-900 dark:text-gray-100",children:t.name}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:t.floor}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:t.room}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:t.rack}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:`${t.addressLine1}, ${t.city}, ${t.state}, ${t.country}`}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:t.photo?e.jsx(z,{title:"Location Photo",imageSrcs:["/static/inventory"+t.photo],children:e.jsx("img",{src:"/static/inventory"+t.photo,alt:t.name,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):e.jsx("span",{className:"text-muted-foreground",children:"No Photo"})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>se(t),children:[e.jsx(we,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>oe(t),className:"border-red-600 text-red-600 hover:bg-red-50",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},t.id))})]})})})})]})]}),e.jsx(he,{open:H,onOpenChange:y,children:e.jsxs(ue,{className:s==="dark"?"bg-gray-900 text-white":"",children:[e.jsx(ge,{children:e.jsx(ye,{children:"Confirm Delete"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{children:['Are you sure you want to delete the location "',C?.name,'"?']}),e.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),e.jsxs(pe,{children:[e.jsx(m,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:le,children:"Delete"})]})]})}),e.jsx(me,{})]})};export{Ve as default};
