import{a as e,j as t}from"./vendor-animation-CcgChT4Y.js";import{C as a}from"./dropdown-menu-DjLdUzkQ.js";import{c as s,i as l,G as n,I as o,a as r,t as i,b as c}from"./InteractivePieChart-e0UyLK3L.js";import{I as d}from"./InventoryNavBar-BrPxNHYZ.js";import{u as m,A as u,e as h,B as x}from"./index-QkJ4t2go.js";import{C as g}from"./calendar-D3_6b9UR.js";import{C as f,c as p,a as j,b}from"./card-CZoDjOMW.js";import{C as y}from"./checkbox-_sSNwR25.js";import{L as v}from"./label-CdSwSrYM.js";import{P as S,a as k,b as N}from"./popover-8ziMr3tt.js";import{R as I,F as w,f as C,W as A,_ as L,$ as D,a0 as F,x as $,i as T,a1 as R}from"./vendor-icons-BYe_-sqm.js";import{f as Q}from"./vendor-dates-BQQoqOpn.js";import"./vendor-radix-CgisZDtL.js";import"./vendor-charts-1c3qO8Q0.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./vendor-print-DRS-tmGd.js";import"./vendor-pdf-export-F3dE0gEs.js";import"./TopBar-CO3pAy7f.js";const M=({title:e,value:a,icon:s,trend:l,trendUp:n,isLoading:o,lastUpdated:r})=>t.jsxs(f,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[t.jsx(j,{className:"pb-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:e}),t.jsx("div",{className:"p-2 rounded-lg bg-primary/10 text-primary",children:s})]})}),t.jsxs(p,{children:[t.jsx("div",{className:"text-2xl font-bold mb-1",children:o?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(I,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):a}),l&&t.jsxs("div",{className:"flex items-center text-xs "+(n?"text-green-600":"text-red-600"),children:[n?t.jsx(T,{className:"w-3 h-3 mr-1"}):t.jsx(R,{className:"w-3 h-3 mr-1"}),l]}),r&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Updated: ",Q(r,"HH:mm:ss")]})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),V=({isAutoRefreshEnabled:e,onToggleAutoRefresh:a})=>t.jsx("div",{className:"flex basis-43",children:t.jsxs(x,{variant:"outline",size:"default",onClick:a,className:"items-center gap-3 flex basis-43 w-full transition-colors hover:text-primary "+(e?"text-green-600 border-green-600":"text-muted-foreground"),children:[t.jsx(I,{className:"w-4 h-4 "+(e?"animate-spin":"")}),"Auto-Refresh"]})}),U=()=>{const{effectiveTheme:T}=m(),R=e.useRef(null),U=new Date,K=new Date(U.getFullYear(),U.getMonth(),1),O=U,[E,H]=e.useState({from:K,to:O}),P=E?.from,B=E?.to,[q,z]=e.useState([]),[G,W]=e.useState([]),[X,Y]=e.useState([]),[_,J]=e.useState(!1),[Z,ee]=e.useState("All"),[te,ae]=e.useState("All"),[se,le]=e.useState("All"),[ne,oe]=e.useState([]),[re,ie]=e.useState([]),[ce,de]=e.useState([]),[me,ue]=e.useState([]),[he,xe]=e.useState(null),[ge,fe]=e.useState(!0),[pe,je]=e.useState(null),[be,ye]=e.useState(!1),[ve,Se]=e.useState(!1),[ke,Ne]=e.useState({fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null}),[Ie,we]=e.useState([]),[Ce,Ae]=e.useState([]),[Le,De]=e.useState([]),[Fe,$e]=e.useState({totalItems:0,totalCategories:0,availableStock:0,unfulfilledItems:0,fulfilledStock:0}),[Te,Re]=e.useState([]),[Qe,Me]=e.useState([]),[Ve,Ue]=e.useState([]),[Ke,Oe]=e.useState([]);e.useEffect(()=>{u.postData({endpoint:"/inventory/get-categories",body:{request:h({type:"Product"})},successCallback:e=>{Array.isArray(e)?we(e):we([])},errorCallback:()=>{we([])}})},[]),e.useEffect(()=>{De([{id:1,name:"Main Kitchen"},{id:2,name:"Pantry A"},{id:3,name:"Store Room"},{id:4,name:"Cold Storage"}])},[]);const Ee=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t={categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null};u.postData({endpoint:"/inventory/filters",body:{request:h(t)},Authorization:`Bearer ${e}`,successCallback:e=>{we(e.categories||[]),Ae(e.items||[]),De(e.locations||[])},errorCallback:e=>{we([]),Ae([]),De([])}})},[q,G,X]);e.useEffect(()=>{Ee()},[Ee]),e.useEffect(()=>{Ne({fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null})},[P,B,q,G,X]);const He=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t=Xe(),a=Ye(),s=_e(),l=t.length>0?t:q,n=a.length>0?a:G,o=s.length>0?s:X,r={fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:l.length>0?l:null,itemIds:n.length>0?n:null,locationIds:o.length>0?o:null};u.postData({endpoint:"/inventory/kpis",body:{request:h(r)},Authorization:`Bearer ${e}`,successCallback:e=>{$e({totalItems:e.totalItems||0,totalCategories:e.totalCategories||0,availableStock:e.availableStock||0,unfulfilledItems:e.pendingQuantity||0,fulfilledStock:e.fulfilledQuantity||0}),je(new Date)},errorCallback:e=>{je(new Date)}})},[P,B,q,G,X,Z,se,te,Ie,Ce,Le]),Pe=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t=Xe(),a=Ye(),s=_e(),l=t.length>0?t:q,n=a.length>0?a:G,o=s.length>0?s:X,r={fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:l.length>0?l:null,itemIds:n.length>0?n:null,locationIds:o.length>0?o:null};Se(!0),u.postData({endpoint:"/inventory/chart-data",body:{request:h(r)},Authorization:`Bearer ${e}`,successCallback:e=>{Re(e.byCategory?.map(e=>({category:e.categoryName,totalStock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0}))||[]),Me(e.byLocation?.map(e=>({name:e.locationName,totalStock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0}))||[]),Ue(e.byItem?.map(e=>({item:e.name,stock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0,unit:"kg"}))||[]),Oe(e.topItems?.map(e=>({product:e.name,availableStock:parseInt(e.availableStock)||0,unfulfilledQuantity:parseInt(e.pendingQuantity)||0,fulfilledQuantity:parseInt(e.fulfilledQuantity)||0,unit:"kg"}))||[]),je(new Date),Se(!1)},errorCallback:e=>{je(new Date),Se(!1)}})},[P,B,q,G,X,Z,se,te,Ie,Ce,Le]);e.useEffect(()=>{He(),Pe()},[He,Pe]),e.useEffect(()=>{let e;return ge&&(e=window.setInterval(()=>{He(),Pe()},6e4)),()=>{e&&clearInterval(e)}},[ge,He,Pe]);const Be=e.useCallback(()=>{fe(e=>!e)},[]),qe=()=>P&&B?`${Q(P,"dd/MM/yyyy")} - ${Q(B,"dd/MM/yyyy")}`:"Select date range",ze=e=>{const t=Ie.find(t=>t.name===e);return t?t.id:null},Ge=e=>{const t=Ce.find(t=>t.name===e);return t?t.id:null},We=e=>{const t=Le.find(t=>t.name===e);return t?t.id:null},Xe=()=>{if("All"===Z)return[];const e=ze(Z);return e?[e]:[]},Ye=()=>{if("All"===se)return[];const e=Ge(se);return e?[e]:[]},_e=()=>{if("All"===te)return[];const e=We(te);return e?[e]:[]},Je=e=>{const t=se!==e;if(le(e===se?"All":e),t){const t=Ge(e);t&&!G.includes(t)&&W(e=>[...e,t])}else{const t=Ge(e);t&&W(e=>e.filter(e=>e!==t))}},Ze=e.useCallback(e=>{},[]),et=e.useCallback(e=>{xe(e)},[]),tt=e.useCallback(e=>{},[]),at=e.useCallback(e=>{xe(e)},[]),st=e.useCallback(e=>{},[]),lt=e.useCallback(e=>{xe(e)},[]),nt=e.useCallback(e=>{},[]),ot=e.useCallback(e=>{xe(e)},[]),rt=e.useMemo(()=>s(Te.map((e,t)=>({...e,name:e.category,value:e.totalStock,color:l.normal[t%l.normal.length]}))),[Te]),it=e.useMemo(()=>s(Qe.map((e,t)=>({...e,name:e.name,value:e.totalStock||0,color:l.normal[t%l.normal.length],costValue:e.costValue||0}))),[Qe]),ct=e.useMemo(()=>s(Ve.map((e,t)=>({...e,name:e.item,value:e.stock,color:l.normal[t%l.normal.length]}))),[Ve]),dt=e.useMemo(()=>{const e=Ke.reduce((e,t)=>e+t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity,0);return Ke.map((t,a)=>({...t,name:t.product,value:t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity,percentage:e>0?(t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity)/e*100:0,color:l.normal[a%l.normal.length]}))},[Ke]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"min-h-screen",ref:R,children:[t.jsx(d,{}),t.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[t.jsx("div",{className:"p-0 m-0 flex justify-end items-center",children:pe&&t.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated: ",Q(pe,"dd/MM/yyyy HH:mm:ss")]})}),t.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-4",children:[t.jsx("h1",{className:"text-primary text-2xl font-bold",children:"Inventory Dashboard"}),t.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsx(V,{isAutoRefreshEnabled:ge,onToggleAutoRefresh:Be}),t.jsxs(x,{variant:"outline",onClick:()=>{He(),Pe()},disabled:be,className:"flex items-center gap-2 flex basis-47 dark:border-green-600 hover:text-primary",children:[t.jsx(I,{className:"h-4 w-4 "+(be?"animate-spin":"")}),"Refresh"]})]}),t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsxs(x,{variant:"outline",onClick:()=>J(!_),className:"flex items-center gap-2 hover:text-primary transition-colors flex basis-40 dark:border-green-600",children:[t.jsx(w,{className:"h-4 w-4"}),"Filters"]}),t.jsx(n,{dashboardRef:R,title:"Inventory Dashboard",dateRange:qe(),filterState:ke,tableData:Ce,tableColumns:[{key:"id",label:"ID"},{key:"name",label:"Item Name"},{key:"categoryName",label:"Category"},{key:"availableStock",label:"Available Stock"},{key:"locationName",label:"Location"}]})]})]})]}),_&&t.jsx(f,{className:"mb-6 shadow-sm border-0 bg-card/50 backdrop-blur-sm",children:t.jsx(p,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(v,{children:"Date Range"}),t.jsxs(S,{children:[t.jsx(k,{asChild:!0,children:t.jsxs(x,{variant:"outline",className:`w-full justify-start text-left font-normal hover:bg-accent transition-colors ${!P&&!B&&"text-muted-foreground"}`,children:[t.jsx(C,{className:"mr-2 h-4 w-4"}),qe()]})}),t.jsx(N,{className:"w-auto p-0",align:"start",children:t.jsx(g,{mode:"range",selected:E,onSelect:H,numberOfMonths:1,autoFocus:!0})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(v,{children:"Category"}),t.jsxs(S,{children:[t.jsx(k,{asChild:!0,children:t.jsx(x,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:q.length>0?1===q.length?`${q.length} category selected`:`${q.length} categories selected`:"Select categories"})}),t.jsx(N,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Ie.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(y,{id:`category-${e.id}`,checked:q.includes(e.id),onCheckedChange:t=>{const a=q.includes(e.id);t&&!a?z([...q,e.id]):!t&&a&&z(q.filter(t=>t!==e.id))}}),t.jsx(v,{htmlFor:`category-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(v,{children:"Item"}),t.jsxs(S,{children:[t.jsx(k,{asChild:!0,children:t.jsx(x,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:G.length>0?`${G.length} item(s) selected`:"Select items"})}),t.jsx(N,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Ce.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(y,{id:`item-${e.id}`,checked:G.includes(e.id),onCheckedChange:t=>{const a=G.includes(e.id);t&&!a?W([...G,e.id]):!t&&a&&W(G.filter(t=>t!==e.id))}}),t.jsx(v,{htmlFor:`item-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(v,{children:"Location"}),t.jsxs(S,{children:[t.jsx(k,{asChild:!0,children:t.jsx(x,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:X.length>0?`${X.length} location(s) selected`:"Select locations"})}),t.jsx(N,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Le.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(y,{id:`location-${e.id}`,checked:X.includes(e.id),onCheckedChange:t=>{const a=X.includes(e.id);t&&!a?Y([...X,e.id]):!t&&a&&Y(X.filter(t=>t!==e.id))}}),t.jsx(v,{htmlFor:`location-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]})]})})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsx(M,{title:"Total Items",value:Fe.totalItems,icon:t.jsx(A,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Total Categories",value:Fe.totalCategories,icon:t.jsx(L,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Available Stock",value:Fe.availableStock,icon:t.jsx(D,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Unfulfilled Items",value:Fe.unfulfilledItems,icon:t.jsx(F,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Fulfilled Stock",value:Fe.fulfilledStock,icon:t.jsx($,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(f,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(j,{children:t.jsxs(b,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Category"]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsx(o,{data:Te,title:"Stock by Category",dataKey:"totalStock",nameKey:"category",selectedItems:ne,onItemClick:Ze,onItemHover:et,theme:T,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]}),innerRadius:100,outerRadius:120}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),t.jsx(r,{data:rt,selectedItems:ne,onItemToggle:e=>{oe(t=>i(t,e)),(e=>{const t=Z!==e;if(ee(e===Z?"All":e),t){const t=ze(e);t&&!q.includes(t)&&z(e=>[...e,t])}else{const t=ze(e);t&&z(e=>e.filter(e=>e!==t))}})(e)},theme:T,formatAsCurrency:!1})]})]})]}),t.jsxs(f,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(j,{children:t.jsxs(b,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Items"]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsx(o,{data:Ve,title:"Stock by Items",dataKey:"stock",nameKey:"item",selectedItems:ce,onItemClick:st,onItemHover:lt,theme:T,innerRadius:100,outerRadius:120,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]})}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Legend"}),t.jsx(r,{data:ct,selectedItems:ce,onItemToggle:e=>{de(t=>i(t,e)),Je(e)},theme:T,formatAsCurrency:!1})]})]})]}),t.jsxs(f,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(j,{children:t.jsxs(b,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Location"]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsx(o,{data:it,title:"Stock by Location",dataKey:"value",nameKey:"name",selectedItems:re,onItemClick:tt,onItemHover:at,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]}),theme:T,innerRadius:100,outerRadius:120}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),t.jsx(r,{data:it,selectedItems:re,onItemToggle:e=>{ie(t=>i(t,e)),(e=>{const t=te!==e;if(ae(e===te?"All":e),t){const t=We(e);t&&!X.includes(t)&&Y(e=>[...e,t])}else{const t=We(e);t&&Y(e=>e.filter(e=>e!==t))}})(e)},theme:T,showPercentage:!0,formatAsCurrency:!1})]})]})]}),t.jsxs(f,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(j,{children:t.jsxs(b,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Top Items by Stock"]})}),t.jsxs(p,{className:"space-y-4",children:[t.jsx(c,{data:Ke,title:"Top Items by Stock",bars:[{dataKey:"availableStock",name:"Available Stock",color:"#059669"},{dataKey:"unfulfilledQuantity",name:"Unfulfilled Quantity",color:"#f69568"},{dataKey:"fulfilledQuantity",name:"Fulfilled Quantity",color:"#894829"}],selectedItems:me,onItemClick:nt,onItemHover:ot,theme:T,showPercentage:!0,yAxisTickFormatter:e=>e.toLocaleString()}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Legend"}),t.jsx(r,{data:dt,selectedItems:me,onItemToggle:e=>{ue(t=>i(t,e)),Je(e)},theme:T,showPercentage:!0,formatAsCurrency:!1})]})]})]})]})]})]}),t.jsx("div",{className:"no-print",children:t.jsx(a,{})})]})};export{U as default};
