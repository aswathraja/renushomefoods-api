import{r as e,j as s,Q as a,F as t,G as l,V as r,W as n,p as o,Y as d}from"./vendor-react-Tc4xLtOv.js";import{A as i}from"./AdminNavBar-nV0t9olM.js";import{C as c}from"./dropdown-menu-Dweh6OYL.js";import{O as m}from"./OrdersTable-D1Fx7FXr.js";import{u,A as h,e as x,B as p}from"./index-CCl3TzR2.js";import{A as g,c as j,i as b,G as f,I as y,a as v,t as N,b as S}from"./InteractivePieChart-A8OblnrW.js";import{C as w}from"./calendar-Cnbaz_2s.js";import{C as A,c as C,a as k,b as I}from"./card-ZRElQZzO.js";import{L as O}from"./label-DxpSIJ1C.js";import{P as D,a as T,b as P}from"./popover-B3nRiRzT.js";import{S as $,a as F,b as L,c as Q,d as M}from"./select-BWzYtSB5.js";import{f as R}from"./vendor-dates-BQQoqOpn.js";import"./vendor-charts-DKw1ZHYY.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./TopBar-DKySbC2h.js";import"./vendor-radix-O0RUyoIw.js";import"./badge-BZaNuTv-.js";import"./table-DDweQ1vw.js";import"./vendor-pdf-export-C4gp01y5.js";import"./vendor-animation-BGrdDg6I.js";import"./vendor-print-DSbiJ92d.js";const U=({title:e,value:t,icon:l,trend:r,trendUp:o,isLoading:d,lastUpdated:i})=>s.jsxs(A,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsx(k,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:e}),s.jsx("div",{className:"p-2 rounded-lg bg-primary/10 text-primary",children:l})]})}),s.jsxs(C,{children:[s.jsx("div",{className:"text-2xl font-bold mb-1",children:d?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(a,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):t}),r&&s.jsxs("div",{className:"flex items-center text-xs "+(o?"text-green-600":"text-red-600"),children:[s.jsx(n,{className:"w-3 h-3 mr-1"}),r]}),i&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Updated: ",R(i,"HH:mm:ss")]})]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),E=({isAutoRefreshEnabled:e,onToggleAutoRefresh:t})=>s.jsx("div",{className:"flex basis-43",children:s.jsxs(p,{variant:"outline",size:"default",onClick:t,className:"items-center gap-3 flex basis-43 w-full transition-colors hover:text-primary "+(e?"text-green-600 border-green-600":"text-muted-foreground"),children:[s.jsx(a,{className:"w-4 h-4 "+(e?"animate-spin":"")}),"Auto-Refresh"]})}),K=()=>{const{effectiveTheme:K}=u(),V=e.useRef(null),H=new Date,q=new Date(H.getFullYear(),H.getMonth(),1),B=H,[z,J]=e.useState({from:q,to:B}),{from:Y,to:G}=z||{},[W,X]=e.useState("All"),[Z,_]=e.useState("All"),[ee,se]=e.useState("All"),[ae,te]=e.useState("All"),[le,re]=e.useState(!1),[ne,oe]=e.useState([]),[de,ie]=e.useState([]),[ce,me]=e.useState([]),[ue,he]=e.useState([]),[xe,pe]=e.useState(null),[ge,je]=e.useState(!0),[be,fe]=e.useState(null),[ye,ve]=e.useState(!1),[Ne,Se]=e.useState({fromDate:Y?Y.toISOString().split("T")[0]:null,toDate:G?G.toISOString().split("T")[0]:null,orderStatus:"All"!==W?W:null,category:"All"!==Z?Z:null,product:"All"!==ee?ee:null,name:null,phone:null}),we=["Payment Processed","Ordered","Processing","Packed","Shipped"],Ae=e=>"Pending"===e?we:"Delivered"===e?["Delivered"]:"Cancelled"===e?["Cancelled"]:[],[Ce,ke]=e.useState([]),[Ie,Oe]=e.useState([]),[De,Te]=e.useState([]),[Pe,$e]=e.useState([]),[Fe,Le]=e.useState([]),[Qe,Me]=e.useState([]),[Re,Ue]=e.useState([]),[Ee,Ke]=e.useState({totalSales:0,avgOrderValue:0,totalOrders:0,pendingOrders:0}),[Ve,He]=e.useState([]),[qe,Be]=e.useState(null),[ze]=e.useState(()=>new g);e.useEffect(()=>{h.postData({endpoint:"/inventory/get-categories",body:{request:x({type:"Product"})},successCallback:e=>{Array.isArray(e)?ke(e):ke([])},errorCallback:()=>ke([])})},[]),e.useEffect(()=>{const e=localStorage.getItem("token");e&&h.get("/admin/user-list",{Authorization:`Bearer ${e}`}).then(e=>{Array.isArray(e?.users)?Te(e?.users||[]):Te([])}).catch(e=>{Te([])})},[]),e.useEffect(()=>{h.postData({endpoint:"/inventory/get-products",body:{request:x({category:"All"===Z?void 0:Z})},successCallback:e=>{Oe(e)}})},[Z]);const Je=e.useCallback(()=>{ve(!0);const e=localStorage.getItem("token");if(!e)return void ve(!1);const s=(e=>{if("All"===e||!e)return{name:null,phone:null};try{const s=JSON.parse(e);return{name:s.name,phone:s.phone}}catch(s){return{name:null,phone:null}}})(ae),a={fromDate:Y?Y.toISOString().split("T")[0]:null,toDate:G?G.toISOString().split("T")[0]:null,orderStatus:"All"!==W?W:null,category:"All"!==Z?Z:null,product:"All"!==ee?ee:null,name:s.name,phone:s.phone};Se(a),h.postData({endpoint:"/admin/dashboard-kpis",body:{request:x(a)},Authorization:`Bearer ${e}`,successCallback:e=>{Ke(e)},errorCallback:e=>{}}),h.postData({endpoint:"/admin/chart-data",body:{request:x(a)},Authorization:`Bearer ${e}`,successCallback:e=>{$e(e.totalsalesbycategory||[]),Le(e.totalsalesbyproduct||[]),Me(e.totalsalesbyorderstatus||[]),Ue(e.productswithquantitiesbyorderstatus||[])},errorCallback:e=>{}}),h.postData({endpoint:"/admin/fetch-orders",body:{request:x(a)},Authorization:`Bearer ${e}`,successCallback:e=>{He(e.orders||[]),fe(new Date),ve(!1)},errorCallback:e=>{ve(!1)}})},[Y,G,W,Z,ee,ae]);e.useEffect(()=>(ge?ze.start(()=>{Je()},3e4):ze.stop(),()=>{ze.stop()}),[ge,Je,ze]),e.useEffect(()=>{me(Ae(W))},[W]),e.useEffect(()=>{Je()},[Je]);const Ye=e.useCallback(e=>{},[]),Ge=e.useCallback(e=>{},[]),We=e.useCallback(e=>{},[]),Xe=e.useCallback(e=>{},[]),Ze=e.useCallback(e=>{pe(e)},[]),_e=e.useCallback(e=>{pe(e)},[]),es=e.useCallback(e=>{pe(e)},[]),ss=e.useCallback(e=>{pe(e)},[]),as=e.useCallback(()=>{je(e=>!e)},[]),ts=()=>Y&&G?`${R(Y,"dd/MM/yyyy")} - ${R(G,"dd/MM/yyyy")}`:"Select date range",ls=e.useMemo(()=>j(Pe.map((e,s)=>({...e,name:e.category,value:e.totalSales,color:b.normal[s%b.normal.length]}))),[Pe]),rs=e.useMemo(()=>j(Fe.map((e,s)=>({...e,name:e.product,value:e.totalSales,color:b.normal[(s+3)%b.normal.length]}))),[Fe]),ns=e.useMemo(()=>j(Qe.map((e,s)=>({...e,name:e.orderStatus,value:e.totalSales,color:b.normal[(s+6)%b.normal.length]}))),[Qe]),os=e.useMemo(()=>{const e=Re.reduce((e,s)=>e+(s.pendingQuantity||0)+(s.fulfilledQuantity||0),0);return Re.map((s,a)=>({...s,name:s.product,value:(s.pendingQuantity||0)+(s.fulfilledQuantity||0),percentage:e>0?((s.pendingQuantity||0)+(s.fulfilledQuantity||0))/e*100:0,color:b.normal[a%b.normal.length]}))},[Re]);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"min-h-screen",children:[s.jsx(i,{}),s.jsxs("div",{className:"container mx-auto p-6 space-y-6",ref:V,children:[s.jsx("div",{className:"p-0 m-0 flex justify-end items-center",children:be&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated: ",R(be,"dd/mm/yyyy HH:mm:ss")]})}),s.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-4",children:[s.jsx("h1",{className:"text-primary text-2xl font-bold",children:"Admin Dashboard"}),s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsx("div",{className:"flex basis-43",children:s.jsx(E,{isAutoRefreshEnabled:ge,onToggleAutoRefresh:as})}),s.jsxs(p,{variant:"outline",onClick:Je,disabled:ye,className:"flex items-center gap-2 flex basis-47 dark:border-green-600 hover:text-primary",children:[s.jsx(a,{className:"h-4 w-4 "+(ye?"animate-spin":"")}),"Refresh"]})]}),s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsxs(p,{variant:"outline",onClick:()=>re(!le),className:"flex items-center gap-2 hover:text-primary transition-colors flex basis-40 dark:border-green-600",children:[s.jsx(t,{className:"h-4 w-4"}),"Filters"]}),s.jsx("div",{className:"flex-1",children:s.jsx(f,{dashboardRef:V,tableData:Ve,filterState:Ne,tableColumns:[{key:"orderId",label:"Order ID"},{key:"customerName",label:"Customer"},{key:"orderStatus",label:"Status"},{key:"totalAmount",label:"Amount"},{key:"orderDate",label:"Date"}],title:"Admin Dashboard",kpis:Ee,dateRange:ts()})})]})]})]}),le&&s.jsx(A,{className:"mb-6 shadow-sm border-0 bg-card/50 backdrop-blur-sm",children:s.jsx(C,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(O,{children:"Date Range"}),s.jsxs(D,{children:[s.jsx(T,{asChild:!0,children:s.jsxs(p,{variant:"outline",className:`w-full justify-start text-left font-normal hover:bg-accent transition-colors ${!Y&&!G&&"text-muted-foreground"}`,children:[s.jsx(l,{className:"mr-2 h-4 w-4"}),ts()]})}),s.jsx(P,{className:"w-auto p-0",align:"start",children:s.jsx(w,{mode:"range",selected:z,onSelect:J,numberOfMonths:1,autoFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(O,{children:"Order Status"}),s.jsxs($,{value:W,onValueChange:X,children:[s.jsx(F,{className:"hover:bg-accent transition-colors",children:s.jsx(L,{placeholder:"Select status"})}),s.jsxs(Q,{children:[s.jsx(M,{value:"All",children:"All"}),s.jsx(M,{value:"Pending",children:"Pending"}),s.jsx(M,{value:"Delivered",children:"Delivered"}),s.jsx(M,{value:"Cancelled",children:"Cancelled"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(O,{children:"Category"}),s.jsxs($,{value:Z,onValueChange:_,children:[s.jsx(F,{className:"hover:bg-accent transition-colors",children:s.jsx(L,{placeholder:"Select Category"})}),s.jsxs(Q,{children:[s.jsx(M,{value:"All",children:"All"}),Ce.map(e=>s.jsx(M,{value:e.category,children:e.category},e.category))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(O,{children:"Product"}),s.jsxs($,{value:ee,onValueChange:se,children:[s.jsx(F,{className:"hover:bg-accent transition-colors",children:s.jsx(L,{placeholder:"Select product"})}),s.jsxs(Q,{children:[s.jsx(M,{value:"All",children:"All"}),Ie?.map(e=>s.jsx(M,{value:e.name,children:e.name},e.name))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(O,{children:"User"}),s.jsxs($,{value:ae,onValueChange:te,children:[s.jsx(F,{className:"hover:bg-accent transition-colors",children:s.jsx(L,{placeholder:"Select user"})}),s.jsxs(Q,{children:[s.jsx(M,{value:"All",children:"All"}),De.map(e=>s.jsxs(M,{value:JSON.stringify(e),children:[e.name," (",e.phone,")"]},`${e.name}-${e.phone}`))]})]})]})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(U,{title:"Total Sales",value:`₹${Ee.totalSales?.toLocaleString()||"0"}`,icon:s.jsx(r,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Avg Order Value",value:`₹${Ee.avgOrderValue?.toFixed(2).toLocaleString()||"0.00"}`,icon:s.jsx(n,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Total Orders",value:Ee.totalOrders||0,icon:s.jsx(o,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Pending Orders",value:Ee.pendingOrders||0,icon:s.jsx(d,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(A,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"category",children:[s.jsx(k,{children:s.jsxs(I,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Category"]})}),s.jsxs(C,{className:"space-y-4",children:[s.jsx(y,{data:Pe,title:"Total Sales by Category",dataKey:"totalSales",nameKey:"category",selectedItems:ne,onItemClick:Ye,onItemHover:Ze,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`,theme:K}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(v,{data:ls,selectedItems:ne,onItemToggle:e=>{oe(s=>N(s,e)),_(e===Z?"All":e)},theme:K})]})]})]}),s.jsxs(A,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"product",children:[s.jsx(k,{children:s.jsxs(I,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Product"]})}),s.jsxs(C,{className:"space-y-4",children:[s.jsx(y,{data:rs,title:"Total Sales by Product",dataKey:"value",nameKey:"name",selectedItems:de,onItemClick:Ge,onItemHover:_e,theme:K,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(v,{data:rs,selectedItems:de,onItemToggle:e=>{ie(s=>N(s,e)),he(s=>N(s,e)),se(e===ee?"All":e)},theme:K})]})]})]}),s.jsxs(A,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"status",children:[s.jsx(k,{children:s.jsxs(I,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Order Status"]})}),s.jsxs(C,{className:"space-y-4",children:[s.jsx(y,{data:Qe,title:"Total Sales by Order Status",dataKey:"totalSales",nameKey:"orderStatus",selectedItems:ce,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`,onItemClick:We,onItemHover:es,theme:K}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(v,{data:ns,selectedItems:ce,onItemToggle:e=>{const s=(e=>we.includes(e)?"Pending":e)(e);X(s===W?"All":s),me(Ae(s===W?"All":s))},theme:K})]})]})]}),s.jsxs(A,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"quantities",children:[s.jsx(k,{children:s.jsxs(I,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Products with Quantities by Order Status"]})}),s.jsxs(C,{className:"space-y-4",children:[s.jsx(S,{data:Re,title:"Products with Quantities by Order Status",bars:[{dataKey:"pendingQuantity",name:"Pending",color:"#f69568"},{dataKey:"fulfilledQuantity",name:"Fulfilled",color:"#059669"}],selectedItems:ue,onItemClick:Xe,onItemHover:ss,theme:K,showPercentage:!0,yAxisTickFormatter:e=>e.toLocaleString()}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(v,{data:os,selectedItems:ue,onItemToggle:e=>{he(s=>N(s,e)),ie(s=>N(s,e)),se(e===ee?"All":e)},theme:K,showPercentage:!0,formatAsCurrency:!1})]})]})]})]}),s.jsx(A,{className:"shadow-lg border-0 bg-card/50 backdrop-blur-sm",children:s.jsx(C,{children:s.jsx(m,{orders:Ve,expandedOrderId:qe,setExpandedOrderId:Be,viewType:"ViewOnly"})})})]})]}),s.jsx("div",{className:"no-print",children:s.jsx(c,{})})]})};export{K as default};
