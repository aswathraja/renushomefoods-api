import{a as e,j as t,b as r}from"./vendor-animation-CcgChT4Y.js";import{p as s,a8 as a,a9 as n,aa as l,ab as i,X as c,N as o,l as u}from"./vendor-icons-BYe_-sqm.js";import{B as d}from"./index-QkJ4t2go.js";import{D as m,a as h,b,c as v,d as p}from"./dialog-B1BfGlYi.js";const f=({src:r,poster:c,className:o=""})=>{const u=e.useRef(null),d=e.useRef(null),[m,h]=e.useState(!1),[b,v]=e.useState(0),[p,f]=e.useState(0),[x,g]=e.useState(1),[w,k]=e.useState(!1),[j,N]=e.useState(!1),[y,E]=e.useState(!0),[L,C]=e.useState(!0),z=e.useRef(null),S=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,M=e.useCallback(()=>{u.current&&(m?u.current.pause():u.current.play(),h(!m))},[m]),T=()=>{u.current&&(u.current.muted=!w,k(!w))},$=()=>{d.current&&(j?document.exitFullscreen?.():d.current.requestFullscreen?.(),N(!j))};e.useEffect(()=>{const e=u.current;if(!e)return;const t=()=>v(e.currentTime),r=()=>f(e.duration),s=()=>h(!0),a=()=>h(!1),n=()=>C(!0),l=()=>C(!1),i=()=>h(!1);return e.addEventListener("timeupdate",t),e.addEventListener("durationchange",r),e.addEventListener("play",s),e.addEventListener("pause",a),e.addEventListener("waiting",n),e.addEventListener("canplay",l),e.addEventListener("ended",i),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("durationchange",r),e.removeEventListener("play",s),e.removeEventListener("pause",a),e.removeEventListener("waiting",n),e.removeEventListener("canplay",l),e.removeEventListener("ended",i)}},[]),e.useEffect(()=>{const e=()=>{N(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]);const A=e.useCallback(()=>{E(!0),z.current&&clearTimeout(z.current),m&&(z.current=setTimeout(()=>{E(!1)},3e3))},[m]);return e.useEffect(()=>(A(),()=>{z.current&&clearTimeout(z.current)}),[m,A]),e.useEffect(()=>{const e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))switch(e.key){case" ":case"k":e.preventDefault(),M();break;case"m":T();break;case"f":$();break;case"ArrowLeft":e.preventDefault(),u.current&&(u.current.currentTime=Math.max(0,u.current.currentTime-10));break;case"ArrowRight":e.preventDefault(),u.current&&(u.current.currentTime=Math.min(p,u.current.currentTime+10));break;case"ArrowUp":if(e.preventDefault(),u.current){const e=Math.min(1,x+.1);g(e),u.current.volume=e,k(0===e)}break;case"ArrowDown":if(e.preventDefault(),u.current){const e=Math.max(0,x-.1);g(e),u.current.volume=e,k(0===e)}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[M,p,x]),t.jsxs("div",{ref:d,className:`relative group bg-black rounded-lg overflow-hidden ${o}`,onMouseMove:A,onMouseLeave:()=>m&&E(!1),children:[t.jsx("video",{ref:u,src:r,poster:c,className:"w-full h-full object-contain relative z-0",onClick:M,playsInline:!0}),L&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-20",children:t.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"})}),!m&&!L&&t.jsx("button",{onClick:M,className:"absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 transition-colors z-10",children:t.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/90 flex items-center justify-center hover:bg-primary transition-colors z-20",children:t.jsx(s,{className:"w-8 h-8 text-primary-foreground fill-primary-foreground ml-1"})})}),t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent px-4 py-3 transition-opacity duration-300 z-30 "+(y?"opacity-100":"opacity-0"),children:[t.jsx("div",{className:"relative mb-3",children:t.jsx("input",{type:"range",min:0,max:p||100,value:b,onChange:e=>{const t=parseFloat(e.target.value);v(t),u.current&&(u.current.currentTime=t)},className:"w-full h-1 z-[100] bg-white/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-125",style:{background:`linear-gradient(to right, hsl(var(--primary)) ${b/p*100}%, rgba(255,255,255,0.3) ${b/p*100}%)`}})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:M,className:"text-white hover:text-primary transition-colors",children:m?t.jsx(a,{className:"w-6 h-6"}):t.jsx(s,{className:"w-6 h-6"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:T,className:"text-white hover:text-primary transition-colors",children:w||0===x?t.jsx(n,{className:"w-5 h-5"}):t.jsx(l,{className:"w-5 h-5"})}),t.jsx("input",{type:"range",min:0,max:1,step:.1,value:w?0:x,onChange:e=>{const t=parseFloat(e.target.value);g(t),u.current&&(u.current.volume=t,k(0===t))},className:"w-20 h-1 bg-white/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer"})]}),t.jsxs("span",{className:"text-white text-sm",children:[S(b)," / ",S(p)]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsx("button",{onClick:$,className:"text-white hover:text-primary transition-colors",children:t.jsx(i,{className:"w-5 h-5"})})})]})]})]})},x=({title:s,imageSrcs:a,imageSrc:n,children:l,open:i,onOpenChange:x})=>{const[g,w]=e.useState(!1),[k,j]=e.useState(0),N=void 0!==i?i:g,y=x||w,E=r.useMemo(()=>a&&a.length>0?a:n?[n]:[],[a,n]),L=E[k]&&(e=>{const t=[".mp4",".mov",".avi",".webm",".mkv",".m4v"].some(t=>e.toLowerCase().endsWith(t)),r=e.startsWith("data:video/");return t||r})(E[k])?"video":"image";e.useEffect(()=>{N&&j(0)},[N]),e.useEffect(()=>{if(!N)return;const e=e=>{"ArrowLeft"===e.key?C():"ArrowRight"===e.key?z():"Escape"===e.key&&y(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[N,E.length]);const C=e.useCallback(()=>{j(e=>0===e?E.length-1:e-1)},[E.length]),z=e.useCallback(()=>{j(e=>e===E.length-1?0:e+1)},[E.length]),S=e.useCallback(e=>{j(e)},[]),M=()=>{y(!1)},T=E.length>1;return 0===E.length?null:t.jsxs(t.Fragment,{children:[l&&t.jsx("div",{onClick:()=>y(!0),className:"cursor-pointer",children:l}),t.jsx(m,{open:N,onOpenChange:y,children:t.jsxs(h,{className:"sm:max-w-2xl max-h-[90vh] p-0 overflow-hidden z-[100]",children:[t.jsx("button",{onClick:M,className:"absolute right-4 top-4 z-50 rounded-full bg-background/80 p-1 hover:bg-background/100 transition-colors",children:t.jsx(c,{className:"h-4 w-4"})}),t.jsx(b,{className:"px-6 pt-6 pb-2 z-10 relative",children:t.jsx(v,{className:"pr-8",children:s})}),t.jsxs("div",{className:"relative w-full h-[60vh] max-h-[60vh] bg-muted/30",children:[t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:"video"===L?t.jsx(f,{src:E[k],className:"w-full h-full z-10 relative"}):t.jsx("img",{src:E[k],alt:`${s} - ${k+1} of ${E.length}`,className:"max-w-full max-h-full object-contain z-10 relative",onError:e=>{e.target.src="/static/logo.webp"}})}),T&&t.jsxs(t.Fragment,{children:[t.jsx(d,{variant:"outline",size:"sm",className:"absolute left-2 top-1/2 -translate-y-1/2 w-10 h-10 p-0 rounded-full bg-background/80 backdrop-blur-sm hover:bg-background/100 z-20",onClick:C,children:t.jsx(o,{className:"w-5 h-5"})}),t.jsx(d,{variant:"outline",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 w-10 h-10 p-0 rounded-full bg-background/80 backdrop-blur-sm hover:bg-background/100 z-20",onClick:z,children:t.jsx(u,{className:"w-5 h-5"})})]}),T&&t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-20",children:E.map((e,r)=>t.jsx("button",{className:"w-2.5 h-2.5 rounded-full transition-all "+(r===k?"bg-primary scale-110":"bg-background/60 hover:bg-background/80"),onClick:()=>S(r)},r))})]}),T&&t.jsxs("div",{className:"text-center text-sm text-muted-foreground pb-2 z-10 relative",children:[k+1," / ",E.length]}),t.jsx(p,{className:"px-6 pb-6 z-10 relative",children:t.jsx(d,{variant:"outline",onClick:M,children:"Close"})})]})})]})};export{f as C,x as P};
