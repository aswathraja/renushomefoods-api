import{u as ge,r as s,j as e,B as d,A as E,e as q,c as l}from"./index-BoxPh3JM.js";import{X as ue,C as he}from"./dropdown-menu-BLfYlWZi.js";import{I as pe}from"./InventoryNavBar-BqA39-k7.js";import{P as $}from"./PhotoGallaryModal-DX5Vw7HN.js";import{C as B,a as K,b as X,c as R}from"./card-DTmY7R92.js";import{D as xe,a as ye,b as je,c as ve,d as fe}from"./dialog-BPO4MNaU.js";import{I as k}from"./input-Dho7y00w.js";import{L as n}from"./label-uPPhbx3V.js";import{S as G,a as z,b as H,c as M,d as L}from"./select-p4rO5IUQ.js";import{T as be,a as Ne,b as U,c as u,d as Ce,e as m}from"./table-D8PF9qXY.js";import{T as ke}from"./textarea-DKVie1lc.js";import{F as we}from"./funnel-BwFhYy_a.js";import{P as De}from"./plus-Btgo1p-c.js";import{U as Se}from"./upload-DWVc7Jz4.js";import{S as Te}from"./square-pen-DzgK4WZe.js";import{T as Fe}from"./trash-2-BSaUFU3P.js";import"./TopBar-CX_8npq5.js";import"./chevron-left-C0smFANY.js";import"./index-BAkI59ym.js";import"./chevron-down-Bb5q4sof.js";const Qe=()=>{const{effectiveTheme:i}=ge(),[V,w]=s.useState([]),[Q,j]=s.useState(!1),[h,D]=s.useState(null),[t,o]=s.useState({category:"",description:"",image:null,displayOrder:"",type:""}),[S,x]=s.useState(""),[T,v]=s.useState(""),[Y,y]=s.useState(!1),[F,I]=s.useState(null),[J,f]=s.useState({}),p=s.useRef(null),[W,Z]=s.useState(!1),[P,_]=s.useState(""),[O,ee]=s.useState(""),[b,re]=s.useState("all"),[N,ae]=s.useState("all"),se=[{value:"all",label:"All"},{value:"true",label:"Has Image"},{value:"false",label:"No Image"}],te=[{value:"all",label:"All"},{value:"Product",label:"Product"},{value:"Item",label:"Item"}],le=[{value:"Product",label:"Product"},{value:"Item",label:"Item"}],C=()=>{const r={type:N!=="all"?N:null,category:P||null,description:O||null,image:b!=="all"?b==="true":null};E.postData({endpoint:"/inventory/get-categories",body:{request:q(r)},successCallback:a=>{Array.isArray(a)?w(a):w([])},errorCallback:()=>{w([]),l.error("Failed to fetch categories")}})};s.useEffect(()=>{C()},[]),s.useEffect(()=>{C()},[P,O,b,N]);const ie=r=>{if(r.preventDefault(),!t.category.trim()){l.error("Category name is required");return}if(!t.displayOrder||isNaN(Number(t.displayOrder))){l.error("Display Order must be a valid number");return}if(!T){l.error("Type is required");return}const a=localStorage.getItem("token");if(!a){l.error("No token found");return}const A={category:t.category,description:t.description,displayOrder:parseInt(t.displayOrder),type:T,image:h?.image||"",token:a};h&&(A.id=h.id);const g=new FormData;g.append("request",q(A)),t.image&&g.append("file",t.image),E.postFormData({endpoint:"/inventory/save-category",body:g,Authorization:`Bearer ${a}`,successCallback:c=>{l.success(h?"Category updated successfully":"Category added successfully"),j(!1),D(null),o({category:"",description:"",image:null,displayOrder:"",type:""}),v(""),x(""),f({}),p.current&&(p.current.value=""),C()},errorCallback:c=>{l.error("Failed to save category"),console.error("Error saving category:",c)}})},ne=r=>{D(r),o({category:r.category,description:r.description||"",image:null,displayOrder:r.displayOrder?.toString()||"",type:r.type}),v(r.type),x("/static/inventory"+r.image||""),j(!0)},oe=r=>{I(r),y(!0)},ce=()=>{if(!F)return;const r=localStorage.getItem("token");if(!r){l.error("No token found");return}E.postData({endpoint:"/inventory/delete-category",body:{request:q({id:F.id,token:r})},successCallback:a=>{l.success("Category deleted successfully"),C(),y(!1),I(null)},errorCallback:a=>{l.error(a.error||"Failed to delete category"),y(!1),I(null)}})},de=r=>{const a=r.target.files?.[0];if(a){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(a.type)){f(c=>({...c,image:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));return}if(a.size>5*1024*1024){f(c=>({...c,image:"File size must be less than 5MB"}));return}o({...t,image:a}),f(c=>({...c,image:""}));const g=new FileReader;g.onload=()=>{x(g.result)},g.readAsDataURL(a)}},me=()=>{o({...t,image:null}),x(""),p.current&&(p.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen",children:[e.jsx(pe,{}),e.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Categories"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",onClick:()=>Z(!W),className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Filters"]}),e.jsxs(d,{variant:"outline",onClick:()=>{D(null),o({category:"",description:"",image:null,displayOrder:"",type:""}),v(""),x(""),j(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Add Category"]})]})]}),W&&e.jsxs(B,{className:"mb-6",children:[e.jsx(K,{children:e.jsx(X,{children:"Filters"})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category"}),e.jsx(k,{value:P,onChange:r=>_(r.target.value),placeholder:"Enter category name",className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(k,{value:O,onChange:r=>ee(r.target.value),placeholder:"Enter description",className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(G,{value:N,onValueChange:ae,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{})}),e.jsx(M,{children:te.map(r=>e.jsx(L,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Image"}),e.jsxs(G,{value:b,onValueChange:re,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{})}),e.jsx(M,{children:se.map(r=>e.jsx(L,{value:r.value,children:r.label},r.value))})]})]})]})})]}),Q&&e.jsxs(B,{className:"mb-6",children:[e.jsx(K,{children:e.jsx(X,{children:h?"Edit Category":"Add Category"})}),e.jsx("form",{onSubmit:ie,children:e.jsxs(R,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Category Name"}),e.jsx(k,{value:t.category,onChange:r=>o({...t,category:r.target.value}),required:!0,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Display Order"}),e.jsx(k,{type:"text",value:t.displayOrder,onChange:r=>o({...t,displayOrder:r.target.value.replace(/[^0-9]/g,"")}),onKeyDown:r=>{!/[0-9]/.test(r.key)&&r.key!=="Backspace"&&r.key!=="Delete"&&r.key!=="ArrowLeft"&&r.key!=="ArrowRight"&&r.key!=="Tab"&&r.preventDefault()},onPaste:r=>{const a=r.clipboardData.getData("text");/^[0-9]*$/.test(a)||r.preventDefault()},required:!0,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(ke,{value:t.description,onChange:r=>o({...t,description:r.target.value}),rows:3,className:i==="dark"?"bg-gray-800 text-white border-gray-600":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(G,{value:T,onValueChange:v,children:[e.jsx(z,{className:i==="dark"?"bg-gray-800 text-white border-gray-600":"",children:e.jsx(H,{placeholder:"Select type"})}),e.jsx(M,{children:le.map(r=>e.jsx(L,{value:r.value,children:r.label},r.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Image ",e.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),S?e.jsxs("div",{className:"relative flex",children:[e.jsx("div",{className:"aspect-[3/2] sm:aspect-[3/2] md:aspect-[30/9] lg:aspect-[30/9] object-contain overflow-hidden rounded-lg border",children:e.jsx($,{title:"Category Image",imageSrcs:[S],children:e.jsx("img",{src:S,alt:"Preview",className:"w-full h-full object-contain"})})}),e.jsx("button",{type:"button",onClick:me,className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(ue,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>p.current?.click(),children:[e.jsx(Se,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload an image"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),e.jsx("input",{ref:p,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:de,className:"hidden"})]}),J.image&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:J.image})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(d,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[h?"Update":"Add"," Category"]})]})]})})]}),e.jsx(B,{children:e.jsx(R,{className:"p-0",children:e.jsxs(be,{children:[e.jsx(Ne,{children:e.jsxs(U,{children:[e.jsx(u,{children:"ID"}),e.jsx(u,{children:"Display Order"}),e.jsx(u,{children:"Category"}),e.jsx(u,{children:"Description"}),e.jsx(u,{children:"Type"}),e.jsx(u,{children:"Image"}),e.jsx(u,{children:"Actions"})]})}),e.jsxs(Ce,{children:[V.map(r=>e.jsxs(U,{children:[e.jsx(m,{children:r.id}),e.jsx(m,{children:r.displayOrder}),e.jsx(m,{children:r.category}),e.jsx(m,{children:r.description||"-"}),e.jsx(m,{children:r.type}),e.jsx(m,{children:r.image?e.jsx($,{title:"Category Image",imageSrcs:["/static/inventory"+r.image],children:e.jsx("img",{src:"/static/inventory"+r.image,alt:r.category,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):e.jsx("span",{className:"text-muted-foreground",children:"No Image"})}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ne(r),children:[e.jsx(Te,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>oe(r),className:"border-red-600 text-red-600 hover:bg-red-50",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},r.id)),V.length===0&&e.jsx(U,{children:e.jsx(m,{colSpan:7,className:"text-center",children:"No categories found."})})]})]})})})]})]}),e.jsx(xe,{open:Y,onOpenChange:y,children:e.jsxs(ye,{className:i==="dark"?"bg-gray-900 text-white":"",children:[e.jsx(je,{children:e.jsx(ve,{children:"Confirm Delete"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{children:['Are you sure you want to delete the category "',F?.category,'"?']}),e.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),e.jsxs(fe,{children:[e.jsx(d,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:ce,children:"Delete"})]})]})}),e.jsx(he,{})]})};export{Qe as default};
