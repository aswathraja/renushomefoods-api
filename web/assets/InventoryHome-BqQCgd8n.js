import{r as e,j as t,Q as a,F as s,G as l,ap as n,as as o,at as r,au as i,ae as c,W as d,av as m}from"./vendor-react-Tc4xLtOv.js";import{C as u}from"./dropdown-menu-Dweh6OYL.js";import{c as h,i as x,G as g,I as f,a as p,t as j,b}from"./InteractivePieChart-A8OblnrW.js";import{I as y}from"./InventoryNavBar-CfaS1G4w.js";import{u as v,A as S,e as k,B as N}from"./index-CCl3TzR2.js";import{C as I}from"./calendar-Cnbaz_2s.js";import{C as w,c as C,a as A,b as L}from"./card-ZRElQZzO.js";import{C as D}from"./checkbox-C1BQOpNB.js";import{L as F}from"./label-DxpSIJ1C.js";import{P as T,a as $,b as Q}from"./popover-B3nRiRzT.js";import{f as R}from"./vendor-dates-BQQoqOpn.js";import"./vendor-charts-DKw1ZHYY.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./vendor-radix-O0RUyoIw.js";import"./vendor-print-DSbiJ92d.js";import"./vendor-pdf-export-C4gp01y5.js";import"./TopBar-DKySbC2h.js";import"./vendor-animation-BGrdDg6I.js";const M=({title:e,value:s,icon:l,trend:n,trendUp:o,isLoading:r,lastUpdated:i})=>t.jsxs(w,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[t.jsx(A,{className:"pb-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(L,{className:"text-sm font-medium text-muted-foreground",children:e}),t.jsx("div",{className:"p-2 rounded-lg bg-primary/10 text-primary",children:l})]})}),t.jsxs(C,{children:[t.jsx("div",{className:"text-2xl font-bold mb-1",children:r?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(a,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):s}),n&&t.jsxs("div",{className:"flex items-center text-xs "+(o?"text-green-600":"text-red-600"),children:[o?t.jsx(d,{className:"w-3 h-3 mr-1"}):t.jsx(m,{className:"w-3 h-3 mr-1"}),n]}),i&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Updated: ",R(i,"HH:mm:ss")]})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),V=({isAutoRefreshEnabled:e,onToggleAutoRefresh:s})=>t.jsx("div",{className:"flex basis-43",children:t.jsxs(N,{variant:"outline",size:"default",onClick:s,className:"items-center gap-3 flex basis-43 w-full transition-colors hover:text-primary "+(e?"text-green-600 border-green-600":"text-muted-foreground"),children:[t.jsx(a,{className:"w-4 h-4 "+(e?"animate-spin":"")}),"Auto-Refresh"]})}),U=()=>{const{effectiveTheme:d}=v(),m=e.useRef(null),U=new Date,K=new Date(U.getFullYear(),U.getMonth(),1),O=U,[E,H]=e.useState({from:K,to:O}),P=E?.from,B=E?.to,[q,z]=e.useState([]),[G,W]=e.useState([]),[X,Y]=e.useState([]),[J,Z]=e.useState(!1),[_,ee]=e.useState("All"),[te,ae]=e.useState("All"),[se,le]=e.useState("All"),[ne,oe]=e.useState([]),[re,ie]=e.useState([]),[ce,de]=e.useState([]),[me,ue]=e.useState([]),[he,xe]=e.useState(null),[ge,fe]=e.useState(!0),[pe,je]=e.useState(null),[be,ye]=e.useState(!1),[ve,Se]=e.useState(!1),[ke,Ne]=e.useState({fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null}),[Ie,we]=e.useState([]),[Ce,Ae]=e.useState([]),[Le,De]=e.useState([]),[Fe,Te]=e.useState({totalItems:0,totalCategories:0,availableStock:0,unfulfilledItems:0,fulfilledStock:0}),[$e,Qe]=e.useState([]),[Re,Me]=e.useState([]),[Ve,Ue]=e.useState([]),[Ke,Oe]=e.useState([]);e.useEffect(()=>{S.postData({endpoint:"/inventory/get-categories",body:{request:k({type:"Product"})},successCallback:e=>{Array.isArray(e)?we(e):we([])},errorCallback:()=>{we([])}})},[]),e.useEffect(()=>{De([{id:1,name:"Main Kitchen"},{id:2,name:"Pantry A"},{id:3,name:"Store Room"},{id:4,name:"Cold Storage"}])},[]);const Ee=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t={categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null};S.postData({endpoint:"/inventory/filters",body:{request:k(t)},Authorization:`Bearer ${e}`,successCallback:e=>{we(e.categories||[]),Ae(e.items||[]),De(e.locations||[])},errorCallback:e=>{we([]),Ae([]),De([])}})},[q,G,X]);e.useEffect(()=>{Ee()},[Ee]),e.useEffect(()=>{Ne({fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:q.length>0?q:null,itemIds:G.length>0?G:null,locationIds:X.length>0?X:null})},[P,B,q,G,X]);const He=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t=Xe(),a=Ye(),s=Je(),l=t.length>0?t:q,n=a.length>0?a:G,o=s.length>0?s:X,r={fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:l.length>0?l:null,itemIds:n.length>0?n:null,locationIds:o.length>0?o:null};S.postData({endpoint:"/inventory/kpis",body:{request:k(r)},Authorization:`Bearer ${e}`,successCallback:e=>{Te({totalItems:e.totalItems||0,totalCategories:e.totalCategories||0,availableStock:e.availableStock||0,unfulfilledItems:e.pendingQuantity||0,fulfilledStock:e.fulfilledQuantity||0}),je(new Date)},errorCallback:e=>{je(new Date)}})},[P,B,q,G,X,_,se,te,Ie,Ce,Le]),Pe=e.useCallback(()=>{const e=localStorage.getItem("token");if(!e)return;const t=Xe(),a=Ye(),s=Je(),l=t.length>0?t:q,n=a.length>0?a:G,o=s.length>0?s:X,r={fromDate:P?P.toISOString().split("T")[0]:null,toDate:B?B.toISOString().split("T")[0]:null,categoryIds:l.length>0?l:null,itemIds:n.length>0?n:null,locationIds:o.length>0?o:null};Se(!0),S.postData({endpoint:"/inventory/chart-data",body:{request:k(r)},Authorization:`Bearer ${e}`,successCallback:e=>{Qe(e.byCategory?.map(e=>({category:e.categoryName,totalStock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0}))||[]),Me(e.byLocation?.map(e=>({name:e.locationName,totalStock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0}))||[]),Ue(e.byItem?.map(e=>({item:e.name,stock:parseInt(e.availableStock)||0,costValue:parseFloat(e.costValue)||0,unit:"kg"}))||[]),Oe(e.topItems?.map(e=>({product:e.name,availableStock:parseInt(e.availableStock)||0,unfulfilledQuantity:parseInt(e.pendingQuantity)||0,fulfilledQuantity:parseInt(e.fulfilledQuantity)||0,unit:"kg"}))||[]),je(new Date),Se(!1)},errorCallback:e=>{je(new Date),Se(!1)}})},[P,B,q,G,X,_,se,te,Ie,Ce,Le]);e.useEffect(()=>{He(),Pe()},[He,Pe]),e.useEffect(()=>{let e;return ge&&(e=window.setInterval(()=>{He(),Pe()},6e4)),()=>{e&&clearInterval(e)}},[ge,He,Pe]);const Be=e.useCallback(()=>{fe(e=>!e)},[]),qe=()=>P&&B?`${R(P,"dd/MM/yyyy")} - ${R(B,"dd/MM/yyyy")}`:"Select date range",ze=e=>{const t=Ie.find(t=>t.name===e);return t?t.id:null},Ge=e=>{const t=Ce.find(t=>t.name===e);return t?t.id:null},We=e=>{const t=Le.find(t=>t.name===e);return t?t.id:null},Xe=()=>{if("All"===_)return[];const e=ze(_);return e?[e]:[]},Ye=()=>{if("All"===se)return[];const e=Ge(se);return e?[e]:[]},Je=()=>{if("All"===te)return[];const e=We(te);return e?[e]:[]},Ze=e=>{const t=se!==e;if(le(e===se?"All":e),t){const t=Ge(e);t&&!G.includes(t)&&W(e=>[...e,t])}else{const t=Ge(e);t&&W(e=>e.filter(e=>e!==t))}},_e=e.useCallback(e=>{},[]),et=e.useCallback(e=>{xe(e)},[]),tt=e.useCallback(e=>{},[]),at=e.useCallback(e=>{xe(e)},[]),st=e.useCallback(e=>{},[]),lt=e.useCallback(e=>{xe(e)},[]),nt=e.useCallback(e=>{},[]),ot=e.useCallback(e=>{xe(e)},[]),rt=e.useMemo(()=>h($e.map((e,t)=>({...e,name:e.category,value:e.totalStock,color:x.normal[t%x.normal.length]}))),[$e]),it=e.useMemo(()=>h(Re.map((e,t)=>({...e,name:e.name,value:e.totalStock||0,color:x.normal[t%x.normal.length],costValue:e.costValue||0}))),[Re]),ct=e.useMemo(()=>h(Ve.map((e,t)=>({...e,name:e.item,value:e.stock,color:x.normal[t%x.normal.length]}))),[Ve]),dt=e.useMemo(()=>{const e=Ke.reduce((e,t)=>e+t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity,0);return Ke.map((t,a)=>({...t,name:t.product,value:t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity,percentage:e>0?(t.availableStock+t.unfulfilledQuantity+t.fulfilledQuantity)/e*100:0,color:x.normal[a%x.normal.length]}))},[Ke]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"min-h-screen",ref:m,children:[t.jsx(y,{}),t.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[t.jsx("div",{className:"p-0 m-0 flex justify-end items-center",children:pe&&t.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated: ",R(pe,"dd/MM/yyyy HH:mm:ss")]})}),t.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-4",children:[t.jsx("h1",{className:"text-primary text-2xl font-bold",children:"Inventory Dashboard"}),t.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsx(V,{isAutoRefreshEnabled:ge,onToggleAutoRefresh:Be}),t.jsxs(N,{variant:"outline",onClick:()=>{He(),Pe()},disabled:be,className:"flex items-center gap-2 flex basis-47 dark:border-green-600 hover:text-primary",children:[t.jsx(a,{className:"h-4 w-4 "+(be?"animate-spin":"")}),"Refresh"]})]}),t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsxs(N,{variant:"outline",onClick:()=>Z(!J),className:"flex items-center gap-2 hover:text-primary transition-colors flex basis-40 dark:border-green-600",children:[t.jsx(s,{className:"h-4 w-4"}),"Filters"]}),t.jsx(g,{dashboardRef:m,title:"Inventory Dashboard",dateRange:qe(),filterState:ke,tableData:Ce,tableColumns:[{key:"id",label:"ID"},{key:"name",label:"Item Name"},{key:"categoryName",label:"Category"},{key:"availableStock",label:"Available Stock"},{key:"locationName",label:"Location"}]})]})]})]}),J&&t.jsx(w,{className:"mb-6 shadow-sm border-0 bg-card/50 backdrop-blur-sm",children:t.jsx(C,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{children:"Date Range"}),t.jsxs(T,{children:[t.jsx($,{asChild:!0,children:t.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal hover:bg-accent transition-colors ${!P&&!B&&"text-muted-foreground"}`,children:[t.jsx(l,{className:"mr-2 h-4 w-4"}),qe()]})}),t.jsx(Q,{className:"w-auto p-0",align:"start",children:t.jsx(I,{mode:"range",selected:E,onSelect:H,numberOfMonths:1,autoFocus:!0})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{children:"Category"}),t.jsxs(T,{children:[t.jsx($,{asChild:!0,children:t.jsx(N,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:q.length>0?1===q.length?`${q.length} category selected`:`${q.length} categories selected`:"Select categories"})}),t.jsx(Q,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Ie.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(D,{id:`category-${e.id}`,checked:q.includes(e.id),onCheckedChange:t=>{const a=q.includes(e.id);t&&!a?z([...q,e.id]):!t&&a&&z(q.filter(t=>t!==e.id))}}),t.jsx(F,{htmlFor:`category-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{children:"Item"}),t.jsxs(T,{children:[t.jsx($,{asChild:!0,children:t.jsx(N,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:G.length>0?`${G.length} item(s) selected`:"Select items"})}),t.jsx(Q,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Ce.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(D,{id:`item-${e.id}`,checked:G.includes(e.id),onCheckedChange:t=>{const a=G.includes(e.id);t&&!a?W([...G,e.id]):!t&&a&&W(G.filter(t=>t!==e.id))}}),t.jsx(F,{htmlFor:`item-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{children:"Location"}),t.jsxs(T,{children:[t.jsx($,{asChild:!0,children:t.jsx(N,{variant:"outline",role:"combobox",className:"w-full justify-between hover:bg-accent transition-colors",children:X.length>0?`${X.length} location(s) selected`:"Select locations"})}),t.jsx(Q,{className:"w-full p-0",align:"start",children:t.jsx("div",{className:"p-3 space-y-2",children:Le.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(D,{id:`location-${e.id}`,checked:X.includes(e.id),onCheckedChange:t=>{const a=X.includes(e.id);t&&!a?Y([...X,e.id]):!t&&a&&Y(X.filter(t=>t!==e.id))}}),t.jsx(F,{htmlFor:`location-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))})})]})]})]})})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsx(M,{title:"Total Items",value:Fe.totalItems,icon:t.jsx(n,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Total Categories",value:Fe.totalCategories,icon:t.jsx(o,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Available Stock",value:Fe.availableStock,icon:t.jsx(r,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Unfulfilled Items",value:Fe.unfulfilledItems,icon:t.jsx(i,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe}),t.jsx(M,{title:"Fulfilled Stock",value:Fe.fulfilledStock,icon:t.jsx(c,{className:"h-4 w-4"}),isLoading:be,lastUpdated:pe})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(w,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(A,{children:t.jsxs(L,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Category"]})}),t.jsxs(C,{className:"space-y-4",children:[t.jsx(f,{data:$e,title:"Stock by Category",dataKey:"totalStock",nameKey:"category",selectedItems:ne,onItemClick:_e,onItemHover:et,theme:d,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]}),innerRadius:100,outerRadius:120}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),t.jsx(p,{data:rt,selectedItems:ne,onItemToggle:e=>{oe(t=>j(t,e)),(e=>{const t=_!==e;if(ee(e===_?"All":e),t){const t=ze(e);t&&!q.includes(t)&&z(e=>[...e,t])}else{const t=ze(e);t&&z(e=>e.filter(e=>e!==t))}})(e)},theme:d,formatAsCurrency:!1})]})]})]}),t.jsxs(w,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(A,{children:t.jsxs(L,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Items"]})}),t.jsxs(C,{className:"space-y-4",children:[t.jsx(f,{data:Ve,title:"Stock by Items",dataKey:"stock",nameKey:"item",selectedItems:ce,onItemClick:st,onItemHover:lt,theme:d,innerRadius:100,outerRadius:120,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]})}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Legend"}),t.jsx(p,{data:ct,selectedItems:ce,onItemToggle:e=>{de(t=>j(t,e)),Ze(e)},theme:d,formatAsCurrency:!1})]})]})]}),t.jsxs(w,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(A,{children:t.jsxs(L,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Stock by Location"]})}),t.jsxs(C,{className:"space-y-4",children:[t.jsx(f,{data:it,title:"Stock by Location",dataKey:"value",nameKey:"name",selectedItems:re,onItemClick:tt,onItemHover:at,labelFormatter:(e,t,a)=>`${e} (${t.toLocaleString()})`,tooltipFormatter:(e,a,s)=>t.jsxs("div",{children:[t.jsxs("div",{children:["Stock: ",e.toLocaleString()]}),t.jsxs("div",{children:["Cost Value: ₹",s?.costValue?.toLocaleString()||"0"]})]}),theme:d,innerRadius:100,outerRadius:120}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),t.jsx(p,{data:it,selectedItems:re,onItemToggle:e=>{ie(t=>j(t,e)),(e=>{const t=te!==e;if(ae(e===te?"All":e),t){const t=We(e);t&&!X.includes(t)&&Y(e=>[...e,t])}else{const t=We(e);t&&Y(e=>e.filter(e=>e!==t))}})(e)},theme:d,showPercentage:!0,formatAsCurrency:!1})]})]})]}),t.jsxs(w,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm",children:[t.jsx(A,{children:t.jsxs(L,{className:"text-lg flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Top Items by Stock"]})}),t.jsxs(C,{className:"space-y-4",children:[t.jsx(b,{data:Ke,title:"Top Items by Stock",bars:[{dataKey:"availableStock",name:"Available Stock",color:"#059669"},{dataKey:"unfulfilledQuantity",name:"Unfulfilled Quantity",color:"#f69568"},{dataKey:"fulfilledQuantity",name:"Fulfilled Quantity",color:"#894829"}],selectedItems:me,onItemClick:nt,onItemHover:ot,theme:d,showPercentage:!0,yAxisTickFormatter:e=>e.toLocaleString()}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Legend"}),t.jsx(p,{data:dt,selectedItems:me,onItemToggle:e=>{ue(t=>j(t,e)),Ze(e)},theme:d,showPercentage:!0,formatAsCurrency:!1})]})]})]})]})]})]}),t.jsx("div",{className:"no-print",children:t.jsx(u,{})})]})};export{U as default};
