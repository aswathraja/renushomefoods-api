import{r as e,j as a,F as r,P as s,a4 as t,X as l,I as i,K as c}from"./vendor-react-Tc4xLtOv.js";import{C as n}from"./dropdown-menu-Dweh6OYL.js";import{I as d}from"./InventoryNavBar-CfaS1G4w.js";import{u as o,B as m,A as g,e as u,c as x}from"./index-CCl3TzR2.js";import{P as p}from"./PhotoGallaryModal-piAobPR-.js";import{C as h,a as j,b as y,c as v}from"./card-ZRElQZzO.js";import{D as b,a as N,b as f,c as C,d as k}from"./dialog-CT_0QHuT.js";import{I as w}from"./input-F4kRSedd.js";import{L as S}from"./label-DxpSIJ1C.js";import{S as D,a as I,b as O,c as P,d as A}from"./select-BWzYtSB5.js";import{T as F,a as T,b as E,c as q,d as B,e as G}from"./table-DDweQ1vw.js";import{T as z}from"./textarea-LiP7jPED.js";import"./vendor-charts-DKw1ZHYY.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./vendor-radix-O0RUyoIw.js";import"./TopBar-DKySbC2h.js";import"./vendor-pdf-export-C4gp01y5.js";import"./vendor-animation-BGrdDg6I.js";const R=()=>{const{effectiveTheme:R}=o(),[M,L]=e.useState([]),[U,V]=e.useState(!1),[J,K]=e.useState(null),[W,$]=e.useState({category:"",description:"",image:null,displayOrder:"",type:""}),[H,Y]=e.useState(""),[Q,X]=e.useState(""),[Z,_]=e.useState(!1),[ee,ae]=e.useState(null),[re,se]=e.useState({}),te=e.useRef(null),[le,ie]=e.useState(!1),[ce,ne]=e.useState(""),[de,oe]=e.useState(""),[me,ge]=e.useState("all"),[ue,xe]=e.useState("all"),pe=()=>{const e={type:"all"!==ue?ue:null,category:ce||null,description:de||null,image:"all"!==me?"true"===me:null};g.postData({endpoint:"/inventory/get-categories",body:{request:u(e)},successCallback:e=>{Array.isArray(e)?L(e):L([])},errorCallback:()=>{L([]),x.error("Failed to fetch categories")}})};e.useEffect(()=>{pe()},[]),e.useEffect(()=>{pe()},[ce,de,me,ue]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"min-h-screen",children:[a.jsx(d,{}),a.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Categories"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(m,{variant:"outline",onClick:()=>ie(!le),className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(r,{className:"w-4 h-4 mr-2"}),"Filters"]}),a.jsxs(m,{variant:"outline",onClick:()=>{K(null),$({category:"",description:"",image:null,displayOrder:"",type:""}),X(""),Y(""),V(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(s,{className:"w-4 h-4 mr-2"}),"Add Category"]})]})]}),le&&a.jsxs(h,{className:"mb-6",children:[a.jsx(j,{children:a.jsx(y,{children:"Filters"})}),a.jsx(v,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Category"}),a.jsx(w,{value:ce,onChange:e=>ne(e.target.value),placeholder:"Enter category name",className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Description"}),a.jsx(w,{value:de,onChange:e=>oe(e.target.value),placeholder:"Enter description",className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Type"}),a.jsxs(D,{value:ue,onValueChange:xe,children:[a.jsx(I,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(O,{})}),a.jsx(P,{children:[{value:"all",label:"All"},{value:"Product",label:"Product"},{value:"Item",label:"Item"}].map(e=>a.jsx(A,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Image"}),a.jsxs(D,{value:me,onValueChange:ge,children:[a.jsx(I,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(O,{})}),a.jsx(P,{children:[{value:"all",label:"All"},{value:"true",label:"Has Image"},{value:"false",label:"No Image"}].map(e=>a.jsx(A,{value:e.value,children:e.label},e.value))})]})]})]})})]}),U&&a.jsxs(h,{className:"mb-6",children:[a.jsx(j,{children:a.jsx(y,{children:J?"Edit Category":"Add Category"})}),a.jsx("form",{onSubmit:e=>{if(e.preventDefault(),!W.category.trim())return void x.error("Category name is required");if(!W.displayOrder||isNaN(Number(W.displayOrder)))return void x.error("Display Order must be a valid number");if(!Q)return void x.error("Type is required");const a=localStorage.getItem("token");if(!a)return void x.error("No token found");const r={category:W.category,description:W.description,displayOrder:parseInt(W.displayOrder),type:Q,image:J?.image||"",token:a};J&&(r.id=J.id);const s=new FormData;s.append("request",u(r)),W.image&&s.append("file",W.image),g.postFormData({endpoint:"/inventory/save-category",body:s,Authorization:`Bearer ${a}`,successCallback:e=>{x.success(J?"Category updated successfully":"Category added successfully"),V(!1),K(null),$({category:"",description:"",image:null,displayOrder:"",type:""}),X(""),Y(""),se({}),te.current&&(te.current.value=""),pe()},errorCallback:e=>{x.error("Failed to save category")}})},children:a.jsxs(v,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Category Name"}),a.jsx(w,{value:W.category,onChange:e=>$({...W,category:e.target.value}),required:!0,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Display Order"}),a.jsx(w,{type:"text",value:W.displayOrder,onChange:e=>$({...W,displayOrder:e.target.value.replace(/[^0-9]/g,"")}),onKeyDown:e=>{/[0-9]/.test(e.key)||"Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key||e.preventDefault()},onPaste:e=>{const a=e.clipboardData.getData("text");/^[0-9]*$/.test(a)||e.preventDefault()},required:!0,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Description"}),a.jsx(z,{value:W.description,onChange:e=>$({...W,description:e.target.value}),rows:3,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Type"}),a.jsxs(D,{value:Q,onValueChange:X,children:[a.jsx(I,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(O,{placeholder:"Select type"})}),a.jsx(P,{children:[{value:"Product",label:"Product"},{value:"Item",label:"Item"}].map(e=>a.jsx(A,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(S,{children:["Image ",a.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),H?a.jsxs("div",{className:"relative flex",children:[a.jsx("div",{className:"aspect-[3/2] sm:aspect-[3/2] md:aspect-[30/9] lg:aspect-[30/9] object-contain overflow-hidden rounded-lg border",children:a.jsx(p,{title:"Category Image",imageSrcs:[H],children:a.jsx("img",{src:H,alt:"Preview",className:"w-full h-full object-contain"})})}),a.jsx("button",{type:"button",onClick:()=>{$({...W,image:null}),Y(""),te.current&&(te.current.value="")},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:a.jsx(l,{className:"h-3 w-3"})})]}):a.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>te.current?.click(),children:[a.jsx(t,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload an image"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),a.jsx("input",{ref:te,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files?.[0];if(a){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(a.type))return void se(e=>({...e,image:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));if(a.size>5242880)return void se(e=>({...e,image:"File size must be less than 5MB"}));$({...W,image:a}),se(e=>({...e,image:""}));const e=new FileReader;e.onload=()=>{Y(e.result)},e.readAsDataURL(a)}},className:"hidden"})]}),re.image&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:re.image})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx(m,{type:"button",variant:"outline",onClick:()=>V(!1),children:"Cancel"}),a.jsxs(m,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[J?"Update":"Add"," Category"]})]})]})})]}),a.jsx(h,{children:a.jsx(v,{className:"p-0",children:a.jsxs(F,{children:[a.jsx(T,{children:a.jsxs(E,{children:[a.jsx(q,{children:"ID"}),a.jsx(q,{children:"Display Order"}),a.jsx(q,{children:"Category"}),a.jsx(q,{children:"Description"}),a.jsx(q,{children:"Type"}),a.jsx(q,{children:"Image"}),a.jsx(q,{children:"Actions"})]})}),a.jsxs(B,{children:[M.map(e=>a.jsxs(E,{children:[a.jsx(G,{children:e.id}),a.jsx(G,{children:e.displayOrder}),a.jsx(G,{children:e.category}),a.jsx(G,{children:e.description||"-"}),a.jsx(G,{children:e.type}),a.jsx(G,{children:e.image?a.jsx(p,{title:"Category Image",imageSrcs:["/static/inventory"+e.image],children:a.jsx("img",{src:"/static/inventory"+e.image,alt:e.category,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):a.jsx("span",{className:"text-muted-foreground",children:"No Image"})}),a.jsx(G,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(m,{variant:"outline",size:"sm",onClick:()=>{return K(a=e),$({category:a.category,description:a.description||"",image:null,displayOrder:a.displayOrder?.toString()||"",type:a.type}),X(a.type),Y("/static/inventory"+a.image||""),void V(!0);var a},children:[a.jsx(i,{className:"w-4 h-4 mr-2"})," Edit"]}),a.jsxs(m,{variant:"outline",size:"sm",onClick:()=>(ae(e),void _(!0)),className:"border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(c,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},e.id)),0===M.length&&a.jsx(E,{children:a.jsx(G,{colSpan:7,className:"text-center",children:"No categories found."})})]})]})})})]})]}),a.jsx(b,{open:Z,onOpenChange:_,children:a.jsxs(N,{className:"dark"===R?"bg-gray-900 text-white":"",children:[a.jsx(f,{children:a.jsx(C,{children:"Confirm Delete"})}),a.jsxs("div",{className:"py-4",children:[a.jsxs("p",{children:['Are you sure you want to delete the category "',ee?.category,'"?']}),a.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),a.jsxs(k,{children:[a.jsx(m,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),a.jsx(m,{variant:"destructive",onClick:()=>{if(!ee)return;const e=localStorage.getItem("token");e?g.postData({endpoint:"/inventory/delete-category",body:{request:u({id:ee.id,token:e})},successCallback:e=>{x.success("Category deleted successfully"),pe(),_(!1),ae(null)},errorCallback:e=>{x.error(e.error||"Failed to delete category"),_(!1),ae(null)}}):x.error("No token found")},children:"Delete"})]})]})}),a.jsx(n,{})]})};export{R as default};
