import{a as e,j as a}from"./vendor-animation-CcgChT4Y.js";import{C as r}from"./dropdown-menu-DjLdUzkQ.js";import{I as s}from"./InventoryNavBar-BrPxNHYZ.js";import{u as t,B as l,A as i,e as c,c as n}from"./index-QkJ4t2go.js";import{P as d}from"./PhotoGallaryModal-cbPzwdvL.js";import{C as o,a as m,b as g,c as u}from"./card-CZoDjOMW.js";import{D as x,a as h,b as p,c as j,d as y}from"./dialog-B1BfGlYi.js";import{I as v}from"./input-hHw7iIA9.js";import{L as b}from"./label-CdSwSrYM.js";import{S as N,a as f,b as C,c as k,d as w}from"./select-BywG2TtB.js";import{T as S,a as D,b as I,c as O,d as P,e as A}from"./table-18gPuSSS.js";import{T as F}from"./textarea-Dez3uDdp.js";import{F as T,P as E,o as q,X as B,g as G,h as z}from"./vendor-icons-BYe_-sqm.js";import"./vendor-radix-CgisZDtL.js";import"./vendor-charts-1c3qO8Q0.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./TopBar-CO3pAy7f.js";import"./vendor-pdf-export-F3dE0gEs.js";const R=()=>{const{effectiveTheme:R}=t(),[M,L]=e.useState([]),[U,V]=e.useState(!1),[J,W]=e.useState(null),[$,H]=e.useState({category:"",description:"",image:null,displayOrder:"",type:""}),[K,Y]=e.useState(""),[Q,X]=e.useState(""),[Z,_]=e.useState(!1),[ee,ae]=e.useState(null),[re,se]=e.useState({}),te=e.useRef(null),[le,ie]=e.useState(!1),[ce,ne]=e.useState(""),[de,oe]=e.useState(""),[me,ge]=e.useState("all"),[ue,xe]=e.useState("all"),he=()=>{const e={type:"all"!==ue?ue:null,category:ce||null,description:de||null,image:"all"!==me?"true"===me:null};i.postData({endpoint:"/inventory/get-categories",body:{request:c(e)},successCallback:e=>{Array.isArray(e)?L(e):L([])},errorCallback:()=>{L([]),n.error("Failed to fetch categories")}})};e.useEffect(()=>{he()},[]),e.useEffect(()=>{he()},[ce,de,me,ue]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"min-h-screen",children:[a.jsx(s,{}),a.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Categories"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(l,{variant:"outline",onClick:()=>ie(!le),className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(T,{className:"w-4 h-4 mr-2"}),"Filters"]}),a.jsxs(l,{variant:"outline",onClick:()=>{W(null),H({category:"",description:"",image:null,displayOrder:"",type:""}),X(""),Y(""),V(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Category"]})]})]}),le&&a.jsxs(o,{className:"mb-6",children:[a.jsx(m,{children:a.jsx(g,{children:"Filters"})}),a.jsx(u,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Category"}),a.jsx(v,{value:ce,onChange:e=>ne(e.target.value),placeholder:"Enter category name",className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Description"}),a.jsx(v,{value:de,onChange:e=>oe(e.target.value),placeholder:"Enter description",className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Type"}),a.jsxs(N,{value:ue,onValueChange:xe,children:[a.jsx(f,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(C,{})}),a.jsx(k,{children:[{value:"all",label:"All"},{value:"Product",label:"Product"},{value:"Item",label:"Item"}].map(e=>a.jsx(w,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Image"}),a.jsxs(N,{value:me,onValueChange:ge,children:[a.jsx(f,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(C,{})}),a.jsx(k,{children:[{value:"all",label:"All"},{value:"true",label:"Has Image"},{value:"false",label:"No Image"}].map(e=>a.jsx(w,{value:e.value,children:e.label},e.value))})]})]})]})})]}),U&&a.jsxs(o,{className:"mb-6",children:[a.jsx(m,{children:a.jsx(g,{children:J?"Edit Category":"Add Category"})}),a.jsx("form",{onSubmit:e=>{if(e.preventDefault(),!$.category.trim())return void n.error("Category name is required");if(!$.displayOrder||isNaN(Number($.displayOrder)))return void n.error("Display Order must be a valid number");if(!Q)return void n.error("Type is required");const a=localStorage.getItem("token");if(!a)return void n.error("No token found");const r={category:$.category,description:$.description,displayOrder:parseInt($.displayOrder),type:Q,image:J?.image||"",token:a};J&&(r.id=J.id);const s=new FormData;s.append("request",c(r)),$.image&&s.append("file",$.image),i.postFormData({endpoint:"/inventory/save-category",body:s,Authorization:`Bearer ${a}`,successCallback:e=>{n.success(J?"Category updated successfully":"Category added successfully"),V(!1),W(null),H({category:"",description:"",image:null,displayOrder:"",type:""}),X(""),Y(""),se({}),te.current&&(te.current.value=""),he()},errorCallback:e=>{n.error("Failed to save category")}})},children:a.jsxs(u,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Category Name"}),a.jsx(v,{value:$.category,onChange:e=>H({...$,category:e.target.value}),required:!0,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Display Order"}),a.jsx(v,{type:"text",value:$.displayOrder,onChange:e=>H({...$,displayOrder:e.target.value.replace(/[^0-9]/g,"")}),onKeyDown:e=>{/[0-9]/.test(e.key)||"Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key||e.preventDefault()},onPaste:e=>{const a=e.clipboardData.getData("text");/^[0-9]*$/.test(a)||e.preventDefault()},required:!0,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Description"}),a.jsx(F,{value:$.description,onChange:e=>H({...$,description:e.target.value}),rows:3,className:"dark"===R?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{children:"Type"}),a.jsxs(N,{value:Q,onValueChange:X,children:[a.jsx(f,{className:"dark"===R?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(C,{placeholder:"Select type"})}),a.jsx(k,{children:[{value:"Product",label:"Product"},{value:"Item",label:"Item"}].map(e=>a.jsx(w,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(b,{children:["Image ",a.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),K?a.jsxs("div",{className:"relative flex",children:[a.jsx("div",{className:"aspect-[3/2] sm:aspect-[3/2] md:aspect-[30/9] lg:aspect-[30/9] object-contain overflow-hidden rounded-lg border",children:a.jsx(d,{title:"Category Image",imageSrcs:[K],children:a.jsx("img",{src:K,alt:"Preview",className:"w-full h-full object-contain"})})}),a.jsx("button",{type:"button",onClick:()=>{H({...$,image:null}),Y(""),te.current&&(te.current.value="")},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:a.jsx(B,{className:"h-3 w-3"})})]}):a.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>te.current?.click(),children:[a.jsx(q,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload an image"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),a.jsx("input",{ref:te,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files?.[0];if(a){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(a.type))return void se(e=>({...e,image:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));if(a.size>5242880)return void se(e=>({...e,image:"File size must be less than 5MB"}));H({...$,image:a}),se(e=>({...e,image:""}));const e=new FileReader;e.onload=()=>{Y(e.result)},e.readAsDataURL(a)}},className:"hidden"})]}),re.image&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:re.image})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx(l,{type:"button",variant:"outline",onClick:()=>V(!1),children:"Cancel"}),a.jsxs(l,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[J?"Update":"Add"," Category"]})]})]})})]}),a.jsx(o,{children:a.jsx(u,{className:"p-0",children:a.jsxs(S,{children:[a.jsx(D,{children:a.jsxs(I,{children:[a.jsx(O,{children:"ID"}),a.jsx(O,{children:"Display Order"}),a.jsx(O,{children:"Category"}),a.jsx(O,{children:"Description"}),a.jsx(O,{children:"Type"}),a.jsx(O,{children:"Image"}),a.jsx(O,{children:"Actions"})]})}),a.jsxs(P,{children:[M.map(e=>a.jsxs(I,{children:[a.jsx(A,{children:e.id}),a.jsx(A,{children:e.displayOrder}),a.jsx(A,{children:e.category}),a.jsx(A,{children:e.description||"-"}),a.jsx(A,{children:e.type}),a.jsx(A,{children:e.image?a.jsx(d,{title:"Category Image",imageSrcs:["/static/inventory"+e.image],children:a.jsx("img",{src:"/static/inventory"+e.image,alt:e.category,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):a.jsx("span",{className:"text-muted-foreground",children:"No Image"})}),a.jsx(A,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{return W(a=e),H({category:a.category,description:a.description||"",image:null,displayOrder:a.displayOrder?.toString()||"",type:a.type}),X(a.type),Y("/static/inventory"+a.image||""),void V(!0);var a},children:[a.jsx(G,{className:"w-4 h-4 mr-2"})," Edit"]}),a.jsxs(l,{variant:"outline",size:"sm",onClick:()=>(ae(e),void _(!0)),className:"border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(z,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},e.id)),0===M.length&&a.jsx(I,{children:a.jsx(A,{colSpan:7,className:"text-center",children:"No categories found."})})]})]})})})]})]}),a.jsx(x,{open:Z,onOpenChange:_,children:a.jsxs(h,{className:"dark"===R?"bg-gray-900 text-white":"",children:[a.jsx(p,{children:a.jsx(j,{children:"Confirm Delete"})}),a.jsxs("div",{className:"py-4",children:[a.jsxs("p",{children:['Are you sure you want to delete the category "',ee?.category,'"?']}),a.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),a.jsxs(y,{children:[a.jsx(l,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),a.jsx(l,{variant:"destructive",onClick:()=>{if(!ee)return;const e=localStorage.getItem("token");e?i.postData({endpoint:"/inventory/delete-category",body:{request:c({id:ee.id,token:e})},successCallback:e=>{n.success("Category deleted successfully"),he(),_(!1),ae(null)},errorCallback:e=>{n.error(e.error||"Failed to delete category"),_(!1),ae(null)}}):n.error("No token found")},children:"Delete"})]})]})}),a.jsx(r,{})]})};export{R as default};
