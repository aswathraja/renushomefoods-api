import{a as e,j as a}from"./vendor-animation-CcgChT4Y.js";import{C as r}from"./dropdown-menu-DjLdUzkQ.js";import{I as t}from"./InventoryNavBar-BrPxNHYZ.js";import{u as s,B as l,A as o,e as i,c as d}from"./index-QkJ4t2go.js";import{P as n}from"./PhotoGallaryModal-cbPzwdvL.js";import{C as c,a as m,b as x,c as h}from"./card-CZoDjOMW.js";import{D as u,a as g,b as y,c as p,d as j}from"./dialog-B1BfGlYi.js";import{I as v}from"./input-hHw7iIA9.js";import{L as N}from"./label-CdSwSrYM.js";import{S as f,a as b,b as k,c as C,d as w}from"./select-BywG2TtB.js";import{F as S,P as L,o as P,X as F,g as q,h as A}from"./vendor-icons-BYe_-sqm.js";import"./vendor-radix-CgisZDtL.js";import"./vendor-charts-1c3qO8Q0.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./TopBar-CO3pAy7f.js";import"./vendor-pdf-export-F3dE0gEs.js";const E=()=>{const{effectiveTheme:E}=s(),[R,D]=e.useState([]),[I,G]=e.useState(!1),[B,z]=e.useState(null),[$,M]=e.useState({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),[W,O]=e.useState(""),[T,J]=e.useState(!1),[U,V]=e.useState(null),[Y,H]=e.useState({}),K=e.useRef(null),[Q,X]=e.useState(!1),[Z,_]=e.useState(""),[ee,ae]=e.useState(""),[re,te]=e.useState(""),[se,le]=e.useState(""),[oe,ie]=e.useState(""),[de,ne]=e.useState(""),[ce,me]=e.useState(""),[xe,he]=e.useState(""),[ue,ge]=e.useState("all"),ye=()=>{const e={name:Z||null,floor:ee||null,room:re||null,rack:se||null,city:de||null,state:ce||null,country:xe||null,photo:"all"!==ue?"true"===ue:null};o.postData({endpoint:"/inventory/locations",body:{request:i(e)},successCallback:e=>{Array.isArray(e)?D(e):D([])},errorCallback:()=>{D([]),d.error("Failed to fetch locations")}})};e.useEffect(()=>{ye()},[]),e.useEffect(()=>{ye()},[Z,ee,re,se,oe,de,ce,xe,ue]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"min-h-screen",children:[a.jsx(t,{}),a.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Locations"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(l,{variant:"outline",onClick:()=>X(!Q),className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(S,{className:"w-4 h-4 mr-2"}),"Filters"]}),a.jsxs(l,{variant:"outline",onClick:()=>{z(null),M({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),O(""),H({}),K.current&&(K.current.value=""),G(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(L,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})]}),Q&&a.jsxs(c,{className:"mb-6",children:[a.jsx(m,{children:a.jsx(x,{children:"Filters"})}),a.jsxs(h,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Name"}),a.jsx(v,{value:Z,onChange:e=>_(e.target.value),placeholder:"Enter Name",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Floor"}),a.jsx(v,{value:ee,onChange:e=>ae(e.target.value),placeholder:"Enter Floor",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Room"}),a.jsx(v,{value:re,onChange:e=>te(e.target.value),placeholder:"Enter Room",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Rack"}),a.jsx(v,{value:se,onChange:e=>le(e.target.value),placeholder:"Enter Rack",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"City"}),a.jsx(v,{value:de,onChange:e=>ne(e.target.value),placeholder:"Enter City",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"State"}),a.jsx(v,{value:ce,onChange:e=>me(e.target.value),placeholder:"Enter State",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Country"}),a.jsx(v,{value:xe,onChange:e=>he(e.target.value),placeholder:"Enter Country",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Photo"}),a.jsxs(f,{value:ue,onValueChange:ge,children:[a.jsx(b,{className:"dark"===E?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(k,{})}),a.jsx(C,{children:[{value:"all",label:"All"},{value:"true",label:"With Photo"},{value:"false",label:"Without Photo"}].map(e=>a.jsx(w,{value:e.value,children:e.label},e.value))})]})]})]})]})]}),I&&a.jsxs(c,{className:"mb-6",children:[a.jsx(m,{children:a.jsx(x,{children:B?"Edit Location":"Add Location"})}),a.jsx("form",{onSubmit:e=>{if(e.preventDefault(),!$.name.trim())return void d.error("Name is required");if(!$.floor.trim())return void d.error("Floor is required");if(!$.room.trim())return void d.error("Room is required");if(!$.rack.trim())return void d.error("Rack is required");if(!$.city.trim())return void d.error("City is required");if(!$.state.trim())return void d.error("State is required");if(!$.country.trim())return void d.error("Country is required");const a=localStorage.getItem("token");if(!a)return void d.error("No token found");const r={name:$.name,floor:$.floor,room:$.room,rack:$.rack,addressLine1:$.addressLine1,city:$.city,state:$.state,country:$.country,photo:B?.photo||"",token:a};B&&(r.id=B.id);const t=new FormData;t.append("request",i(r)),$.photo&&t.append("file",$.photo),o.postFormData({endpoint:"/inventory/save-location",body:t,Authorization:`Bearer ${a}`,successCallback:e=>{d.success(B?"Location updated successfully":"Location added successfully"),G(!1),z(null),M({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),O(""),ye()},errorCallback:e=>{d.error("Failed to save location")}})},children:a.jsxs(h,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Location Name"}),a.jsx(v,{value:$.name,onChange:e=>M({...$,name:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Floor"}),a.jsx(v,{value:$.floor,onChange:e=>M({...$,floor:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Room"}),a.jsx(v,{value:$.room,onChange:e=>M({...$,room:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Rack"}),a.jsx(v,{value:$.rack,onChange:e=>M({...$,rack:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Address"}),a.jsx(v,{value:$.addressLine1,onChange:e=>M({...$,addressLine1:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"City"}),a.jsx(v,{value:$.city,onChange:e=>M({...$,city:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"State"}),a.jsx(v,{value:$.state,onChange:e=>M({...$,state:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{children:"Country"}),a.jsx(v,{value:$.country,onChange:e=>M({...$,country:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(N,{children:["Photo ",a.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),W?a.jsxs("div",{className:"relative",children:[a.jsx(n,{title:"Location Photo",imageSrcs:[W],children:a.jsx("img",{src:W,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})}),a.jsx("button",{type:"button",onClick:()=>{M({...$,photo:null}),O(""),K.current&&(K.current.value="")},className:"absolute top-0 left-20 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:a.jsx(F,{className:"h-3 w-3"})})]}):a.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>K.current?.click(),children:[a.jsx(P,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload a photo"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),a.jsx("input",{ref:K,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files?.[0];if(a){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(a.type))return void H(e=>({...e,photo:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));if(a.size>5242880)return void H(e=>({...e,photo:"File size must be less than 5MB"}));M({...$,photo:a}),H(e=>({...e,photo:""}));const e=new FileReader;e.onload=()=>{O(e.result)},e.readAsDataURL(a)}},className:"hidden"})]}),Y.photo&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:Y.photo})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx(l,{type:"button",variant:"outline",onClick:()=>G(!1),children:"Cancel"}),a.jsxs(l,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[B?"Update":"Add"," Location"]})]})]})})]}),a.jsx(c,{children:a.jsx(h,{className:"p-0",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full "+("dark"===E?"dark":""),children:[a.jsx("thead",{className:""+("dark"===E?"bg-gray-800":"bg-gray-50"),children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"ID"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Floor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Room"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rack"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Address"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Photo"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:R.map(e=>a.jsxs("tr",{className:""+("dark"===E?"bg-gray-900 hover:bg-gray-800":"bg-white hover:bg-gray-50"),children:[a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.id}),a.jsx("td",{className:"px-4 py-4 text-sm font-medium text-gray-900 dark:text-gray-100",children:e.name}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.floor}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.room}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.rack}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:`${e.addressLine1}, ${e.city}, ${e.state}, ${e.country}`}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.photo?a.jsx(n,{title:"Location Photo",imageSrcs:["/static/inventory"+e.photo],children:a.jsx("img",{src:"/static/inventory"+e.photo,alt:e.name,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):a.jsx("span",{className:"text-muted-foreground",children:"No Photo"})}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{return z(a=e),M({name:a.name,floor:a.floor,room:a.room,rack:a.rack,city:a.city,state:a.state,country:a.country,addressLine1:a.addressLine1,photo:null}),O(a.photo&&"/static/inventory"+a.photo||""),void G(!0);var a},children:[a.jsx(q,{className:"w-4 h-4 mr-2"})," Edit"]}),a.jsxs(l,{variant:"outline",size:"sm",onClick:()=>(V(e),void J(!0)),className:"border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(A,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},e.id))})]})})})})]})]}),a.jsx(u,{open:T,onOpenChange:J,children:a.jsxs(g,{className:"dark"===E?"bg-gray-900 text-white":"",children:[a.jsx(y,{children:a.jsx(p,{children:"Confirm Delete"})}),a.jsxs("div",{className:"py-4",children:[a.jsxs("p",{children:['Are you sure you want to delete the location "',U?.name,'"?']}),a.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),a.jsxs(j,{children:[a.jsx(l,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),a.jsx(l,{variant:"destructive",onClick:()=>{if(!U)return;const e=localStorage.getItem("token");e?o.postData({endpoint:"/inventory/delete-location",body:{request:i({id:U.id,token:e})},successCallback:e=>{d.success("Location deleted successfully"),ye(),J(!1),V(null)},errorCallback:e=>{d.error(e.error||"Failed to delete location"),J(!1),V(null)}}):d.error("No token found")},children:"Delete"})]})]})}),a.jsx(r,{})]})};export{E as default};
