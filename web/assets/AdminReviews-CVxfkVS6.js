import{r as e,j as s,P as t,F as a,a3 as l,G as r,a4 as i,a5 as n,X as c,I as d,J as o,a6 as m,a7 as x,c as h}from"./vendor-react-Tc4xLtOv.js";import{A as u}from"./AdminNavBar-nV0t9olM.js";import{C as p}from"./dropdown-menu-Dweh6OYL.js";import{u as j,b as g,B as v,a as f,A as N,e as w,c as b}from"./index-CCl3TzR2.js";import{B as y}from"./badge-BZaNuTv-.js";import{C}from"./calendar-Cnbaz_2s.js";import{C as k,c as S,a as R,b as M}from"./card-ZRElQZzO.js";import{C as P}from"./checkbox-C1BQOpNB.js";import{D as F,a as D,b as A,c as $,d as I}from"./dialog-CT_0QHuT.js";import{I as B}from"./input-F4kRSedd.js";import{L as O}from"./label-DxpSIJ1C.js";import{P as L,a as q,b as z}from"./popover-B3nRiRzT.js";import{S as V}from"./switch-adH75S8E.js";import{T as E}from"./textarea-LiP7jPED.js";import{P as G}from"./PhotoGallaryModal-piAobPR-.js";import{T,a as W,b as H,c as J,d as U,e as K}from"./table-DDweQ1vw.js";import{f as Q}from"./vendor-dates-BQQoqOpn.js";import"./vendor-charts-DKw1ZHYY.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./TopBar-DKySbC2h.js";import"./vendor-radix-O0RUyoIw.js";import"./vendor-pdf-export-C4gp01y5.js";import"./vendor-animation-BGrdDg6I.js";const X=()=>{const{effectiveTheme:X}=j(),{user:Y}=g(),[Z,_]=e.useState([]),[ee,se]=e.useState(!1),[te,ae]=e.useState(!1),[le,re]=e.useState(!1),[ie,ne]=e.useState(null),[ce,de]=e.useState(!1),[oe,me]=e.useState(null),[xe,he]=e.useState(!1),[ue,pe]=e.useState(""),[je,ge]=e.useState(""),[ve,fe]=e.useState("All"),[Ne,we]=e.useState(!0),[be,ye]=e.useState({}),[Ce,ke]=e.useState([]),[Se,Re]=e.useState(""),[Me,Pe]=e.useState(""),[Fe,De]=e.useState(0),[Ae,$e]=e.useState(!1),[Ie,Be]=e.useState(""),[Oe,Le]=e.useState(""),[qe,ze]=e.useState(void 0),[Ve,Ee]=e.useState(!1),[Ge,Te]=e.useState(null),[We,He]=e.useState(null),[Je,Ue]=e.useState([]),[Ke,Qe]=e.useState([]),[Xe,Ye]=e.useState([]),[Ze,_e]=e.useState(!1),[es,ss]=e.useState(!1),[ts,as]=e.useState({}),ls=e.useRef(null),rs=()=>{se(!0);const e=localStorage.getItem("token");if(!e)return;const s={products:Ce.map(e=>e.id),highlight:Ne};ue.trim()&&(s.name=ue.trim()),je.trim()&&(s.location=je.trim()),"All"!==ve&&(s.rating=ve),be.from&&(s.fromDate=Q(be.from,"yyyy-MM-dd")),be.to&&(s.toDate=Q(be.to,"yyyy-MM-dd")),N.postData({endpoint:"/order/get-reviews",body:{request:w(s)},Authorization:`Bearer ${e}`,successCallback:e=>{_(e.reviews||[]),se(!1)},errorCallback:e=>{_([]),se(!1)}})};e.useEffect(()=>{rs(),Xe.length>0||(_e(!0),N.postData({endpoint:"/inventory/get-products",body:{request:w({})},successCallback:e=>{Ye(e||[]),_e(!1)},errorCallback:()=>{Ye([]),_e(!1)}}))},[ue,je,ve,Ne,be,Ce]);const is=Z,ns=()=>{Re(""),Pe(""),De(0),$e(!1),Be(""),Le(""),ze(void 0),Ee(!1),Te(null),He(null),Ue([]),Qe([]),as({}),re(!1),ne(null)},cs=(e,s)=>{Qe(s?[...Ke,e]:Ke.filter(s=>s.id!==e.id))},ds=(e,t=!1)=>s.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(a=>t?s.jsx("button",{type:"button",onClick:()=>(e=>{De(Fe===e?e-.5:e)})(a),className:"focus:outline-none transition-transform hover:scale-110",children:a<=Math.floor(e)?s.jsx(m,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e>=a-.5&&e<a?s.jsx(x,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):s.jsx(m,{className:"h-5 w-5 fill-muted text-muted"})},a):s.jsx(h.Fragment,{children:a<=Math.floor(e)?s.jsx(m,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}):e>=a-.5&&e<a?s.jsx(x,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}):s.jsx(m,{className:"h-4 w-4 fill-muted text-muted"})},a))}),os=e=>[".mp4",".mov",".avi",".webm",".mkv",".m4v"].some(s=>e.toLowerCase().endsWith(s));return s.jsxs("div",{children:[s.jsx(u,{}),s.jsxs("div",{className:"container mx-auto mt-6 p-6 min-h-screen",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Reviews"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(v,{variant:"outline",onClick:()=>{ns(),ae(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[s.jsx(t,{className:"w-4 h-4 mr-2"}),"Add"]}),s.jsxs(v,{variant:"outline",onClick:()=>he(!xe),className:"border-green-600 text-green-600 hover:text-primary",children:[s.jsx(a,{className:"w-4 h-4 mr-2"}),"Filters"]})]})]}),xe&&s.jsx(k,{className:"mb-6",children:s.jsxs(S,{className:"pt-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(O,{children:"Name"}),s.jsxs("div",{className:"relative mt-1",children:[s.jsx(l,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(B,{value:ue,onChange:e=>pe(e.target.value),placeholder:"Search by name",className:"pl-8"})]})]}),s.jsxs("div",{children:[s.jsx(O,{children:"Location"}),s.jsxs("div",{className:"relative mt-1",children:[s.jsx(l,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(B,{value:je,onChange:e=>ge(e.target.value),placeholder:"Search by location",className:"pl-8"})]})]}),s.jsxs("div",{children:[s.jsx(O,{children:"Rating"}),s.jsxs(L,{children:[s.jsx(q,{asChild:!0,children:s.jsx(v,{variant:"outline",className:`w-full justify-start text-left font-normal mt-1 ${"All"===ve&&"text-muted-foreground"}`,children:"All"===ve?"All Ratings":`${ve} Star`})}),s.jsx(z,{className:"w-auto p-0",align:"start",children:s.jsxs("div",{className:"p-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:()=>fe("All"),children:[s.jsx(P,{checked:"All"===ve,onCheckedChange:()=>fe("All")}),s.jsx(O,{className:"cursor-pointer",children:"All Ratings"})]}),[1,2,3,4,5].map(e=>s.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:()=>fe(e),children:[s.jsx(P,{checked:ve===e,onCheckedChange:()=>fe(e)}),s.jsxs(O,{className:"cursor-pointer flex items-center gap-1",children:[e," Star",1!==e&&"s"]})]},e))]})})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-3 gap-4 pt-2",children:[s.jsxs("div",{children:[s.jsx(O,{children:"Featured"}),s.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[s.jsx(V,{id:"filter-featured",checked:Ne,onCheckedChange:e=>we(e)}),s.jsx(O,{htmlFor:"filter-featured",className:"text-sm cursor-pointer",children:Ne?"Featured only":"Show all"})]})]}),s.jsxs("div",{children:[s.jsx(O,{children:"Date Range"}),s.jsxs(L,{children:[s.jsx(q,{asChild:!0,children:s.jsxs(v,{variant:"outline",className:`w-full justify-start text-left font-normal mt-1 ${!be.from&&!be.to&&"text-muted-foreground"}`,children:[s.jsx(r,{className:"mr-2 h-4 w-4"}),be.from?be.to?s.jsxs(s.Fragment,{children:[Q(be.from,"dd/MM/yyyy")," -"," ",Q(be.to,"dd/MM/yyyy")]}):Q(be.from,"dd/MM/yyyy"):"Select date range"]})}),s.jsx(z,{className:"w-auto p-0",align:"start",children:s.jsx(C,{autoFocus:!0,mode:"range",defaultMonth:be.from,selected:{from:be.from,to:be.to},onSelect:e=>ye(e||{}),numberOfMonths:2})})]})]}),s.jsxs("div",{children:[s.jsx(O,{children:"Products"}),s.jsxs(L,{children:[s.jsx(q,{asChild:!0,children:s.jsx(v,{variant:"outline",role:"combobox","aria-expanded":!1,className:`w-full justify-start text-left font-normal mt-1 ${0===Ce.length&&"text-muted-foreground"}`,children:Ce.length>0?`${Ce.length} product(s) selected`:"Select products"})}),s.jsxs(z,{className:"w-full p-0",align:"start",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[s.jsx("span",{className:"text-sm font-medium",children:"Filter by Products"}),Ce.length>0&&s.jsx("button",{type:"button",onClick:()=>ke([]),className:"text-xs text-primary hover:underline",children:"Clear all"})]}),Ze?s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Loading products..."}):0===Xe.length?s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No products available"}):s.jsx("div",{className:"max-h-[200px] overflow-y-auto p-3 space-y-2",children:Xe.map(e=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(P,{id:`filter-product-${e.id}`,checked:Ce.some(s=>s.id===e.id),onCheckedChange:s=>{const t=Ce.some(s=>s.id===e.id);s&&!t?ke([...Ce,e]):!s&&t&&ke(Ce.filter(s=>s.id!==e.id))}}),s.jsx(O,{htmlFor:`filter-product-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:e.name})]},e.id))})]})]}),Ce.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Ce.map(e=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary text-xs rounded-full",children:[e.name,s.jsx("button",{type:"button",onClick:()=>ke(Ce.filter(s=>s.id!==e.id)),className:"hover:text-primary/70",children:"×"})]},e.id))})]})]})]})}),te&&s.jsxs(k,{className:"mb-6",children:[s.jsx(R,{children:s.jsx(M,{children:le?"Edit Review":"Create Review"})}),s.jsxs(S,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsxs(O,{children:["Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(B,{value:Se,onChange:e=>Re(e.target.value),placeholder:"Enter name"}),ts.name&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:ts.name})]}),s.jsxs("div",{children:[s.jsxs(O,{children:["Phone ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(B,{value:Me,onChange:e=>Pe(e.target.value),placeholder:"Enter phone number"}),ts.phone&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:ts.phone})]}),s.jsxs("div",{children:[s.jsxs(O,{children:["Location ",s.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),s.jsx(B,{value:Oe,onChange:e=>Le(e.target.value),placeholder:"Enter location (e.g., Chennai, India)"})]}),s.jsxs("div",{children:[s.jsxs(O,{children:["Review Date ",s.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),s.jsxs(L,{open:Ve,onOpenChange:Ee,children:[s.jsx(q,{asChild:!0,children:s.jsxs(v,{variant:"outline",className:f("w-full justify-start text-left font-normal mt-1",!qe&&"text-muted-foreground"),children:[s.jsx(r,{className:"mr-2 h-4 w-4"}),qe?Q(qe,"dd/MM/yyyy"):"Select date"]})}),s.jsx(z,{className:"w-auto p-0",align:"start",children:s.jsx(C,{mode:"single",selected:qe,onSelect:e=>{ze(e),Ee(!1)},autoFocus:!0})})]})]}),s.jsxs("div",{className:"flex",children:[s.jsxs("div",{children:[s.jsxs(O,{children:["Rating ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"py-2 pr-2",children:ds(Fe,!0)}),Fe>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:[Fe," star",1!==Fe?"s":""]}),ts.rating&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:ts.rating})]}),s.jsxs("div",{children:[s.jsx(O,{children:"Highlight Review"}),s.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[s.jsx(V,{id:"highlight-review",checked:Ae,onCheckedChange:e=>$e(e)}),s.jsx(O,{htmlFor:"highlight-review",className:"text-sm cursor-pointer",children:Ae?"Highlighted":"Not highlighted"})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Highlighted reviews will be featured prominently"})]})]}),s.jsxs("div",{children:[s.jsxs(O,{children:["Photo/Video ",s.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),We?s.jsxs("div",{className:"relative",children:[s.jsx(G,{title:os(We)?"Review Video":"Review Photo",imageSrcs:[We],children:os(We)?s.jsxs("div",{className:"relative w-full h-32 rounded overflow-hidden cursor-pointer hover:opacity-80 transition-opacity group",children:[s.jsx("img",{src:We,alt:"Video Preview",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 group-hover:bg-black/50 transition-colors",children:s.jsx(n,{className:"h-8 w-8 text-white fill-white"})})]}):s.jsx("img",{src:We,alt:"Preview",className:"w-full h-32 object-cover rounded-lg cursor-pointer hover:opacity-80 transition-opacity"})}),s.jsx("button",{type:"button",onClick:()=>{Te(null),He(null),ls.current&&(ls.current.value="")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:s.jsx(c,{className:"h-3 w-3"})})]}):s.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>ls.current?.click(),children:[s.jsx(i,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload a photo or video"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Images: JPEG, PNG, WebP, GIF (max 5MB) • Videos: MP4, MOV, WebM (max 50MB)"}),s.jsx("input",{ref:ls,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif,video/mp4,video/quicktime,video/webm,video/x-matroska,video/x-m4v",onChange:e=>{if(e.target.files&&e.target.files.length>0){const s=e.target.files[0],t=["video/mp4","video/quicktime","video/x-msvideo","video/webm","video/x-matroska","video/x-m4v"];if(![...["image/jpeg","image/png","image/webp","image/gif"],...t].includes(s.type))return void as(e=>({...e,file:"Please upload a valid image (JPEG, PNG, WebP, GIF) or video (MP4, MOV, AVI, WebM)"}));const a=t.includes(s.type),l=a?52428800:5242880;if(s.size>l)return void as(e=>({...e,file:"File size must be less than "+(a?"50MB":"5MB")}));Te(s),as(e=>({...e,file:""}));const r=new FileReader;r.onloadend=()=>{He(r.result)},r.readAsDataURL(s)}else Te(null),He(null)},className:"hidden"})]}),ts.file&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:ts.file})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs(O,{children:["Products ",s.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),s.jsxs(L,{children:[s.jsx(q,{asChild:!0,children:s.jsx(v,{type:"button",variant:"outline",className:f("w-full justify-between text-left font-normal",0===Ke.length&&"text-muted-foreground"),children:Ke.length>0?`${Ke.length} product(s) selected`:"Select products"})}),s.jsxs(z,{className:"w-full p-0",align:"start",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[s.jsx("span",{className:"text-sm font-medium",children:"Select Products"}),Ke.length>0&&s.jsx("button",{type:"button",onClick:()=>{Qe([])},className:"text-xs text-primary hover:underline",children:"Clear all"})]}),Ze?s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Loading products..."}):0===Xe.length?s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No products available"}):s.jsx("div",{className:"max-h-[200px] overflow-y-auto p-3 space-y-2",children:Xe.map(e=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(P,{id:`product-${e.id}`,checked:Ke.some(s=>s.id===e.id),onCheckedChange:s=>{cs(e,s)}}),s.jsx(O,{htmlFor:`product-${e.id}`,className:"text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:e.name})]},e.id))})]})]}),Ke.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Ke.map(e=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary text-xs rounded-full",children:[e.name,s.jsx("button",{type:"button",onClick:()=>cs(e,!1),className:"hover:text-primary/70",children:"×"})]},e.id))})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs(O,{children:["Review ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(E,{rows:4,value:Ie,onChange:e=>Be(e.target.value),placeholder:"Share your experience..."}),ts.review&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:ts.review})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[s.jsx(v,{variant:"outline",onClick:()=>{ns(),ae(!1)},disabled:es,children:"Cancel"}),s.jsx(v,{onClick:()=>{if(!(()=>{const e={};Se.trim()||(e.name="Name is required."),Me.trim()?/^[0-9+\-\s]{7,15}$/.test(Me.trim())||(e.phone="Please enter a valid phone number"):e.phone="Phone number is required.";return 0===Fe&&(e.rating="Please select a rating."),Ie.trim()?Ie.trim().length<10&&(e.review="Review must be at least 10 characters long."):e.review="Review is required.",as(e),0===Object.keys(e).length})())return;ss(!0);const e=localStorage.getItem("token");if(!e)return void ss(!1);const s={id:le?ie?.id:void 0,name:Se.trim(),phone:Me.trim(),review:Ie.trim(),rating:Fe,highlight:Ae,location:Oe.trim()||null,reviewDate:qe?Q(qe,"yyyy-MM-dd"):null,userId:le?ie?.userId??Y?.id:Y?.id,products:Ke.map(e=>e.id)},t=new FormData;t.append("request",w(s)),Ge&&t.append("photo",Ge),N.postFormData({endpoint:"/order/save-review",body:t,Authorization:`Bearer ${e}`,successCallback:e=>{b.success(le?"Review updated successfully":"Review saved successfully"),rs(),ns(),ae(!1),ss(!1)},errorCallback:e=>{b.error(e?.error||e?.message||"Failed to save review"),ss(!1)}})},disabled:es,children:es?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"animate-spin mr-2",children:"⏳"}),le?"Updating...":"Saving..."]}):le?"Update Review":"Save Review"})]})]})]}),s.jsx(k,{children:s.jsx(S,{className:"p-0",children:ee?s.jsx("div",{className:"p-6 text-center",children:"Loading..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(T,{className:"table-fixed w-full min-w-[1400px]",children:[s.jsx(W,{children:s.jsxs(H,{children:[s.jsx(J,{className:"w-[120px]",children:"Name"}),s.jsx(J,{className:"w-[120px]",children:"Phone"}),s.jsx(J,{className:"w-[200px]",children:"Location"}),s.jsx(J,{className:"w-[150px]",children:"Review Date"}),s.jsx(J,{className:"w-[140px]",children:"Rating"}),s.jsx(J,{className:"w-[130px]",children:"Highlight"}),s.jsx(J,{className:"w-[300px]",children:"Review"}),s.jsx(J,{className:"w-[80px]",children:"Photo"}),s.jsx(J,{className:"w-[300px]",children:"Products"}),s.jsx(J,{className:"w-[100px] sticky right-0 bg-background z-10",children:"Actions"})]})}),s.jsxs(U,{children:[is.map((e,t)=>s.jsxs(H,{className:t%2==0?"bg-muted/20":"",children:[s.jsx(K,{className:"w-[120px] font-medium truncate",children:e.name}),s.jsx(K,{className:"w-[120px] truncate",children:e.phone}),s.jsx(K,{className:"w-[200px] truncate",children:e.location||"-"}),s.jsx(K,{className:"w-[150px]",children:e.reviewDate?Q(new Date(e.reviewDate),"dd/MM/yyyy"):"-"}),s.jsx(K,{className:"w-[140px]",children:s.jsxs("div",{className:"flex items-center gap-1",children:[ds(e.rating),s.jsxs("span",{className:"ml-1 text-sm text-muted-foreground",children:["(",e.rating,")"]})]})}),s.jsx(K,{className:"w-[130px]",children:e.highlight?s.jsx(y,{variant:"default",className:"bg-yellow-500 hover:bg-yellow-600",children:"★ Featured"}):s.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}),s.jsx(K,{className:"w-[300px]",children:s.jsx("div",{className:"truncate",title:e.review,children:e.review.length>80?e.review.substring(0,80)+"...":e.review})}),s.jsx(K,{className:"w-[80px]",children:e.photo?s.jsx(G,{title:os(e.photo)?"Review Video":"Review Photo",imageSrcs:[`/static${e.photo}`],children:os(e.photo)?s.jsxs("div",{className:"relative w-16 h-12 rounded overflow-hidden cursor-pointer hover:opacity-80 transition-opacity group",children:[s.jsx("img",{src:`/static${e.photo}`,alt:"Review",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 group-hover:bg-black/50 transition-colors",children:s.jsx(n,{className:"h-5 w-5 text-white fill-white"})})]}):s.jsx("img",{src:`/static${e.photo}`,alt:"Review",className:"w-16 h-12 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity"})}):s.jsx("span",{className:"text-muted-foreground text-sm",children:"No photo"})}),s.jsx(K,{className:"w-[180px]",children:s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.products?.slice(0,2).map(e=>s.jsx(y,{variant:"secondary",className:"text-xs",children:e.name},e.id)),e.products?.length>2&&s.jsxs(y,{variant:"outline",className:"text-xs",children:["+",e.products.length-2]}),(!e.products||0===e.products.length)&&s.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})]})}),s.jsx(K,{className:"w-[100px] sticky right-0 bg-background z-10",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx(v,{size:"sm",variant:"outline",title:"Edit Review",onClick:()=>(e=>{Re(e.name),Pe(e.phone),De(e.rating),$e(e.highlight||!1),Be(e.review),Le(e.location||""),ze(e.reviewDate?new Date(e.reviewDate):void 0),Te(null),e.photo?He(`/static${e.photo}`):He(null),e.products&&e.products.length>0?Qe(e.products.map(e=>({id:e.id,name:e.name}))):Qe([]),re(!0),ne(e),ae(!0)})(e),children:s.jsx(d,{className:"w-4 h-4"})}),s.jsx(v,{size:"sm",variant:"outline",title:"Delete Review",onClick:()=>{me(e),de(!0)},children:s.jsx(o,{className:"w-4 h-4"})})]})})]},e.id)),0===is.length&&s.jsx(H,{children:s.jsx(K,{colSpan:11,className:"text-center",children:"No Reviews found."})})]})]})})})})]}),s.jsx(F,{open:ce,onOpenChange:de,children:s.jsxs(D,{children:[s.jsx(A,{children:s.jsx($,{children:"Delete Review"})}),s.jsx("div",{className:"py-4",children:s.jsxs("p",{children:['Are you sure you want to delete this review by "',oe?.name,'"? This action cannot be undone.']})}),s.jsxs(I,{children:[s.jsx(v,{variant:"outline",onClick:()=>{de(!1),me(null)},children:"Cancel"}),s.jsx(v,{variant:"destructive",onClick:()=>{if(!oe)return;const e=localStorage.getItem("token");if(!e)return;const s={ids:[oe.id]};N.postData({endpoint:"/order/delete-review",body:{request:w(s)},Authorization:`Bearer ${e}`,successCallback:()=>{b.success("Review deleted successfully"),rs(),de(!1),me(null)},errorCallback:e=>{b.error(e?.error||e?.message||"Failed to delete review"),de(!1),me(null)}})},children:"Confirm Delete"})]})]})}),s.jsx(p,{})]})};export{X as default};
