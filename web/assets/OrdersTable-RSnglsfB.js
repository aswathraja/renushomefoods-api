import{j as e,b as s,a as r}from"./vendor-animation-CcgChT4Y.js";import{B as t,c as d,A as n,e as l}from"./index-QkJ4t2go.js";import{B as o}from"./badge-DjmmXEHi.js";import{T as a,a as i,b as c,c as x,d as m,e as h}from"./table-18gPuSSS.js";import{k as j,l as p,g as u,L as f,m as w}from"./vendor-icons-BYe_-sqm.js";const N=({orders:r,expandedOrderId:d,setExpandedOrderId:n,viewType:l="ViewOnly",onEditOrder:N,onDownloadInvoice:v,isDownloadingInvoiceMap:g})=>{const b=e=>{switch(e.toLowerCase()){case"ordered":case"shipped":case"delivered":return"default";case"payment processed":return"secondary";case"processing":case"packed":default:return"outline";case"cancelled":return"destructive"}},y=e=>{const s=e.orderTotal-e.productDiscount;return s+(s<999&&"Home Delivery"===e.shippingMethod?99-e.shippingDiscount:0)};return e.jsxs("div",{className:"w-full",children:[e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs(c,{className:"bg-muted/50",children:[e.jsx(x,{className:"w-[50px] text-left font-bold"}),e.jsx(x,{className:"min-w-[100px] text-left font-bold",children:"Order ID"}),e.jsx(x,{className:"min-w-[100px] text-left font-bold",children:"User ID"}),e.jsx(x,{className:"min-w-[150px] text-left font-bold",children:"Customer Name"}),e.jsx(x,{className:"min-w-[180px] text-left font-bold",children:"Customer Phone"}),e.jsx(x,{className:"min-w-[180px] text-left font-bold",children:"Customer Email"}),e.jsx(x,{className:"min-w-[120px] text-left font-bold",children:"Order Date"}),e.jsx(x,{className:"min-w-[175px] text-left font-bold",children:"Order Status"}),e.jsx(x,{className:"min-w-[120px] text-left font-bold",children:"Order Total"}),e.jsx(x,{className:"min-w-[175px] text-left font-bold",children:"Shipping Method"}),e.jsx(x,{className:"min-w-[180px] text-left font-bold",children:"Est. Delivery Date"}),e.jsx(x,{className:"min-w-[150px] text-left font-bold",children:"Delivery Name"}),e.jsx(x,{className:"min-w-[300px] text-left font-bold",children:"Address"}),e.jsx(x,{className:"min-w-[150px] text-left font-bold",children:"City"}),e.jsx(x,{className:"min-w-[120px] text-left font-bold",children:"State"}),e.jsx(x,{className:"min-w-[150px] text-left font-bold",children:"Country"}),e.jsx(x,{className:"min-w-[100px] text-left font-bold",children:"Pincode"}),e.jsx(x,{className:"min-w-[180px] text-left font-bold",children:"Delivery Phone"})]})}),e.jsx(m,{children:r.map(r=>e.jsxs(s.Fragment,{children:[e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{variant:"ghost",size:"sm",onClick:()=>n(d===r.orderId?null:r.orderId),className:"hover:text-primary",children:d===r.orderId?e.jsx(j,{className:"h-4 w-4"}):e.jsx(p,{className:"h-4 w-4"})}),"ManageOrders"===l&&e.jsxs(e.Fragment,{children:[N&&e.jsx(t,{variant:"outline",size:"sm",onClick:()=>N(r),className:"hover:text-primary",children:e.jsx(u,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>v(r.orderId),disabled:!0===g[r.orderId],className:"hover:text-primary",children:!0===g[r.orderId]?e.jsx(f,{className:"h-4 w-4 animate-spin"}):e.jsx(w,{className:"h-4 w-4"})})]})]})}),e.jsx(h,{className:"font-medium",children:r.orderId}),e.jsx(h,{children:r.userId}),e.jsx(h,{children:r.customerName}),e.jsx(h,{children:r.customerPhone}),e.jsx(h,{children:r.customerEmail}),e.jsx(h,{children:new Date(r.orderDate).toLocaleDateString()}),e.jsx(h,{children:e.jsx(o,{variant:b(r.orderStatus),children:r.orderStatus})}),e.jsxs(h,{className:"font-medium",children:["₹",y(r).toFixed(2)]}),e.jsx(h,{children:r.shippingMethod}),e.jsx(h,{children:new Date(r.expectedDeliveryDate).toLocaleDateString()}),e.jsx(h,{children:r.deliveryName}),e.jsx(h,{className:"max-w-[200px] truncate",children:r.addressLine1}),e.jsx(h,{children:r.city}),e.jsx(h,{children:r.state}),e.jsx(h,{children:r.country}),e.jsx(h,{children:r.pincode}),e.jsx(h,{children:r.deliveryPhone})]}),d===r.orderId&&e.jsx(c,{children:e.jsx(h,{colSpan:18,className:"p-0",children:e.jsxs("div",{className:"p-6 bg-muted/20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Order Details"}),e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs(c,{children:[e.jsx(x,{children:"Product Name"}),e.jsx(x,{children:"Category"}),e.jsx(x,{children:"Quantity"}),e.jsx(x,{children:"Price"}),e.jsx(x,{children:"Total"})]})}),e.jsxs(m,{children:[r.products.map((s,r)=>e.jsxs(c,{children:[e.jsx(h,{children:s.productName}),e.jsx(h,{children:s.categoryName}),e.jsx(h,{children:s.quantity}),e.jsxs(h,{children:["₹",s.price]}),e.jsxs(h,{children:["₹",s.productTotal]})]},r)),r.productDiscount>0&&e.jsxs(c,{children:[e.jsx(h,{colSpan:4,children:"Discount"}),e.jsxs(h,{className:"text-red-600",children:["-₹",r.productDiscount.toFixed(2)]})]}),(()=>{const s=r.orderTotal-r.productDiscount<999&&"Home Delivery"===r.shippingMethod,t=s?99-r.shippingDiscount:0;return s?e.jsxs(c,{children:[e.jsx(h,{colSpan:4,children:"Shipping"}),e.jsxs(h,{children:["₹",t]})]}):null})(),e.jsxs(c,{children:[e.jsx(h,{colSpan:4,children:e.jsx("strong",{children:"Order Total"})}),e.jsx(h,{children:e.jsxs("strong",{children:["₹",y(r).toFixed(2)]})})]})]})]})]}),r.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Order Notes"}),e.jsx("p",{className:"text-muted-foreground",children:r.notes})]})]})})})]},r.orderId))})]}),0===r.length&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No orders found"})]})},v=({viewType:s="ViewOnly",orders:t,expandedOrderId:o,setExpandedOrderId:a,onEditOrder:i})=>{const[c,x]=r.useState(""),[m,h]=r.useState(""),[j,p]=r.useState(void 0),[u,f]=r.useState({}),w=t.filter(e=>{const s=""===c||e.orderId.toString().includes(c)||e.customerName.toLowerCase().includes(c.toLowerCase())||e.customerPhone.includes(c)||e.customerEmail.toLowerCase().includes(c.toLowerCase()),r=""===m||"all-statuses"===m||e.orderStatus===m,t=!j||new Date(e.orderDate).toDateString()===j.toDateString();return s&&r&&t});return e.jsxs("div",{className:"space-y-6",children:["ViewOnly"===s&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Orders"}),e.jsxs("p",{className:"text-muted-foreground",children:[w.length," of ",t.length," orders"]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:e.jsx("input",{type:"text",placeholder:"Search orders...",value:c,onChange:e=>x(e.target.value),className:"px-3 py-2 border rounded-md text-sm w-full sm:w-64"})})]}),e.jsx(N,{orders:w,expandedOrderId:o,setExpandedOrderId:a,viewType:s,onEditOrder:i,onDownloadInvoice:async e=>{f(s=>({...s,[e]:!0}));try{const s=localStorage.getItem("token");if(!s)return void d.error("Authentication required to download invoice");await n.postData({endpoint:"/order/download-invoice",body:{request:l({orderId:e,token:s})},responseType:"blob",successCallback:s=>{const r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download=`Renus Home Foods - Order Invoice - ${e}.pdf`,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(r),document.body.removeChild(t),d.success("Invoice downloaded successfully!")},errorCallback:e=>{d.error("Failed to download invoice")}})}catch(s){d.error("Failed to download invoice")}finally{f(s=>({...s,[e]:!1}))}},isDownloadingInvoiceMap:u})]})};export{v as O};
