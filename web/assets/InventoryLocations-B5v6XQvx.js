import{r as e,j as a,F as r,P as t,a4 as s,X as l,I as o,K as i}from"./vendor-react-Tc4xLtOv.js";import{C as d}from"./dropdown-menu-Dweh6OYL.js";import{I as n}from"./InventoryNavBar-CfaS1G4w.js";import{u as c,B as m,A as x,e as h,c as u}from"./index-CCl3TzR2.js";import{P as g}from"./PhotoGallaryModal-piAobPR-.js";import{C as y,a as p,b as j,c as v}from"./card-ZRElQZzO.js";import{D as N,a as f,b,c as k,d as C}from"./dialog-CT_0QHuT.js";import{I as w}from"./input-F4kRSedd.js";import{L as S}from"./label-DxpSIJ1C.js";import{S as L,a as P,b as F,c as q,d as A}from"./select-BWzYtSB5.js";import"./vendor-charts-DKw1ZHYY.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./vendor-radix-O0RUyoIw.js";import"./TopBar-DKySbC2h.js";import"./vendor-pdf-export-C4gp01y5.js";import"./vendor-animation-BGrdDg6I.js";const E=()=>{const{effectiveTheme:E}=c(),[R,D]=e.useState([]),[I,G]=e.useState(!1),[B,z]=e.useState(null),[$,M]=e.useState({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),[W,O]=e.useState(""),[T,J]=e.useState(!1),[U,K]=e.useState(null),[V,Y]=e.useState({}),H=e.useRef(null),[Q,X]=e.useState(!1),[Z,_]=e.useState(""),[ee,ae]=e.useState(""),[re,te]=e.useState(""),[se,le]=e.useState(""),[oe,ie]=e.useState(""),[de,ne]=e.useState(""),[ce,me]=e.useState(""),[xe,he]=e.useState(""),[ue,ge]=e.useState("all"),ye=()=>{const e={name:Z||null,floor:ee||null,room:re||null,rack:se||null,city:de||null,state:ce||null,country:xe||null,photo:"all"!==ue?"true"===ue:null};x.postData({endpoint:"/inventory/locations",body:{request:h(e)},successCallback:e=>{Array.isArray(e)?D(e):D([])},errorCallback:()=>{D([]),u.error("Failed to fetch locations")}})};e.useEffect(()=>{ye()},[]),e.useEffect(()=>{ye()},[Z,ee,re,se,oe,de,ce,xe,ue]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"min-h-screen",children:[a.jsx(n,{}),a.jsxs("div",{className:"container mx-auto mt-6 px-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Locations"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(m,{variant:"outline",onClick:()=>X(!Q),className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(r,{className:"w-4 h-4 mr-2"}),"Filters"]}),a.jsxs(m,{variant:"outline",onClick:()=>{z(null),M({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),O(""),Y({}),H.current&&(H.current.value=""),G(!0)},className:"border-green-600 text-green-600 hover:text-primary",children:[a.jsx(t,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})]}),Q&&a.jsxs(y,{className:"mb-6",children:[a.jsx(p,{children:a.jsx(j,{children:"Filters"})}),a.jsxs(v,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Name"}),a.jsx(w,{value:Z,onChange:e=>_(e.target.value),placeholder:"Enter Name",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Floor"}),a.jsx(w,{value:ee,onChange:e=>ae(e.target.value),placeholder:"Enter Floor",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Room"}),a.jsx(w,{value:re,onChange:e=>te(e.target.value),placeholder:"Enter Room",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Rack"}),a.jsx(w,{value:se,onChange:e=>le(e.target.value),placeholder:"Enter Rack",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"City"}),a.jsx(w,{value:de,onChange:e=>ne(e.target.value),placeholder:"Enter City",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"State"}),a.jsx(w,{value:ce,onChange:e=>me(e.target.value),placeholder:"Enter State",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Country"}),a.jsx(w,{value:xe,onChange:e=>he(e.target.value),placeholder:"Enter Country",className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Photo"}),a.jsxs(L,{value:ue,onValueChange:ge,children:[a.jsx(P,{className:"dark"===E?"bg-gray-800 text-white border-gray-600":"",children:a.jsx(F,{})}),a.jsx(q,{children:[{value:"all",label:"All"},{value:"true",label:"With Photo"},{value:"false",label:"Without Photo"}].map(e=>a.jsx(A,{value:e.value,children:e.label},e.value))})]})]})]})]})]}),I&&a.jsxs(y,{className:"mb-6",children:[a.jsx(p,{children:a.jsx(j,{children:B?"Edit Location":"Add Location"})}),a.jsx("form",{onSubmit:e=>{if(e.preventDefault(),!$.name.trim())return void u.error("Name is required");if(!$.floor.trim())return void u.error("Floor is required");if(!$.room.trim())return void u.error("Room is required");if(!$.rack.trim())return void u.error("Rack is required");if(!$.city.trim())return void u.error("City is required");if(!$.state.trim())return void u.error("State is required");if(!$.country.trim())return void u.error("Country is required");const a=localStorage.getItem("token");if(!a)return void u.error("No token found");const r={name:$.name,floor:$.floor,room:$.room,rack:$.rack,addressLine1:$.addressLine1,city:$.city,state:$.state,country:$.country,photo:B?.photo||"",token:a};B&&(r.id=B.id);const t=new FormData;t.append("request",h(r)),$.photo&&t.append("file",$.photo),x.postFormData({endpoint:"/inventory/save-location",body:t,Authorization:`Bearer ${a}`,successCallback:e=>{u.success(B?"Location updated successfully":"Location added successfully"),G(!1),z(null),M({name:"",floor:"",room:"",rack:"",addressLine1:"",city:"",state:"",country:"",photo:null}),O(""),ye()},errorCallback:e=>{u.error("Failed to save location")}})},children:a.jsxs(v,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Location Name"}),a.jsx(w,{value:$.name,onChange:e=>M({...$,name:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Floor"}),a.jsx(w,{value:$.floor,onChange:e=>M({...$,floor:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Room"}),a.jsx(w,{value:$.room,onChange:e=>M({...$,room:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Rack"}),a.jsx(w,{value:$.rack,onChange:e=>M({...$,rack:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Address"}),a.jsx(w,{value:$.addressLine1,onChange:e=>M({...$,addressLine1:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"City"}),a.jsx(w,{value:$.city,onChange:e=>M({...$,city:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"State"}),a.jsx(w,{value:$.state,onChange:e=>M({...$,state:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(S,{children:"Country"}),a.jsx(w,{value:$.country,onChange:e=>M({...$,country:e.target.value}),required:!0,className:"dark"===E?"bg-gray-800 text-white border-gray-600":""})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(S,{children:["Photo ",a.jsx("span",{className:"text-muted-foreground",children:"(Optional)"})]}),W?a.jsxs("div",{className:"relative",children:[a.jsx(g,{title:"Location Photo",imageSrcs:[W],children:a.jsx("img",{src:W,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})}),a.jsx("button",{type:"button",onClick:()=>{M({...$,photo:null}),O(""),H.current&&(H.current.value="")},className:"absolute top-0 left-20 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:a.jsx(l,{className:"h-3 w-3"})})]}):a.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/30 rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>H.current?.click(),children:[a.jsx(s,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload a photo"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPEG, PNG, WebP, GIF (max 5MB)"}),a.jsx("input",{ref:H,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:e=>{const a=e.target.files?.[0];if(a){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(a.type))return void Y(e=>({...e,photo:"Please upload a valid image file (JPEG, PNG, WebP, GIF)"}));if(a.size>5242880)return void Y(e=>({...e,photo:"File size must be less than 5MB"}));M({...$,photo:a}),Y(e=>({...e,photo:""}));const e=new FileReader;e.onload=()=>{O(e.result)},e.readAsDataURL(a)}},className:"hidden"})]}),V.photo&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:V.photo})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx(m,{type:"button",variant:"outline",onClick:()=>G(!1),children:"Cancel"}),a.jsxs(m,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:[B?"Update":"Add"," Location"]})]})]})})]}),a.jsx(y,{children:a.jsx(v,{className:"p-0",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full "+("dark"===E?"dark":""),children:[a.jsx("thead",{className:""+("dark"===E?"bg-gray-800":"bg-gray-50"),children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"ID"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Floor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Room"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rack"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Address"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Photo"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 dark:text-gray-100",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:R.map(e=>a.jsxs("tr",{className:""+("dark"===E?"bg-gray-900 hover:bg-gray-800":"bg-white hover:bg-gray-50"),children:[a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.id}),a.jsx("td",{className:"px-4 py-4 text-sm font-medium text-gray-900 dark:text-gray-100",children:e.name}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.floor}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.room}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.rack}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:`${e.addressLine1}, ${e.city}, ${e.state}, ${e.country}`}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.photo?a.jsx(g,{title:"Location Photo",imageSrcs:["/static/inventory"+e.photo],children:a.jsx("img",{src:"/static/inventory"+e.photo,alt:e.name,className:"w-12 h-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity"})}):a.jsx("span",{className:"text-muted-foreground",children:"No Photo"})}),a.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(m,{variant:"outline",size:"sm",onClick:()=>{return z(a=e),M({name:a.name,floor:a.floor,room:a.room,rack:a.rack,city:a.city,state:a.state,country:a.country,addressLine1:a.addressLine1,photo:null}),O(a.photo&&"/static/inventory"+a.photo||""),void G(!0);var a},children:[a.jsx(o,{className:"w-4 h-4 mr-2"})," Edit"]}),a.jsxs(m,{variant:"outline",size:"sm",onClick:()=>(K(e),void J(!0)),className:"border-red-600 text-red-600 hover:bg-red-50",children:[a.jsx(i,{className:"w-4 h-4 mr-2"})," Delete"]})]})})]},e.id))})]})})})})]})]}),a.jsx(N,{open:T,onOpenChange:J,children:a.jsxs(f,{className:"dark"===E?"bg-gray-900 text-white":"",children:[a.jsx(b,{children:a.jsx(k,{children:"Confirm Delete"})}),a.jsxs("div",{className:"py-4",children:[a.jsxs("p",{children:['Are you sure you want to delete the location "',U?.name,'"?']}),a.jsx("p",{className:"text-red-600 mt-2",children:"This action cannot be undone."})]}),a.jsxs(C,{children:[a.jsx(m,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),a.jsx(m,{variant:"destructive",onClick:()=>{if(!U)return;const e=localStorage.getItem("token");e?x.postData({endpoint:"/inventory/delete-location",body:{request:h({id:U.id,token:e})},successCallback:e=>{u.success("Location deleted successfully"),ye(),J(!1),K(null)},errorCallback:e=>{u.error(e.error||"Failed to delete location"),J(!1),K(null)}}):u.error("No token found")},children:"Delete"})]})]})}),a.jsx(d,{})]})};export{E as default};
