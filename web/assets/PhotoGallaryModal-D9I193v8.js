import{r as s,j as e,k as A,a8 as H,a9 as U,aa as W,ab as B,n as K,X,ac as q,a6 as G}from"./vendor-react-Bv33ryjV.js";import{B as P}from"./index-BgzncNPj.js";import{D as _,a as J,b as Q,c as Y,d as Z}from"./dialog-DjJou7Bz.js";const ee=({src:C,poster:b,className:y=""})=>{const n=s.useRef(null),g=s.useRef(null),[c,v]=s.useState(!1),[p,d]=s.useState(0),[u,h]=s.useState(0),[m,l]=s.useState(1),[x,w]=s.useState(!1),[N,E]=s.useState(!1),[z,k]=s.useState(!0),[j,L]=s.useState(!0),r=s.useRef(null),o=t=>{const a=Math.floor(t/60),i=Math.floor(t%60);return`${a}:${i.toString().padStart(2,"0")}`},f=s.useCallback(()=>{n.current&&(c?n.current.pause():n.current.play(),v(!c))},[c]),M=t=>{const a=parseFloat(t.target.value);l(a),n.current&&(n.current.volume=a,w(a===0))},T=()=>{n.current&&(n.current.muted=!x,w(!x))},O=t=>{const a=parseFloat(t.target.value);d(a),n.current&&(n.current.currentTime=a)},F=()=>{g.current&&(N?document.exitFullscreen?.():g.current.requestFullscreen?.(),E(!N))};s.useEffect(()=>{const t=n.current;if(!t)return;const a=()=>d(t.currentTime),i=()=>h(t.duration),R=()=>v(!0),V=()=>v(!1),S=()=>L(!0),$=()=>L(!1),I=()=>v(!1);return t.addEventListener("timeupdate",a),t.addEventListener("durationchange",i),t.addEventListener("play",R),t.addEventListener("pause",V),t.addEventListener("waiting",S),t.addEventListener("canplay",$),t.addEventListener("ended",I),()=>{t.removeEventListener("timeupdate",a),t.removeEventListener("durationchange",i),t.removeEventListener("play",R),t.removeEventListener("pause",V),t.removeEventListener("waiting",S),t.removeEventListener("canplay",$),t.removeEventListener("ended",I)}},[]),s.useEffect(()=>{const t=()=>{E(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]);const D=s.useCallback(()=>{k(!0),r.current&&clearTimeout(r.current),c&&(r.current=setTimeout(()=>{k(!1)},3e3))},[c]);return s.useEffect(()=>(D(),()=>{r.current&&clearTimeout(r.current)}),[c,D]),s.useEffect(()=>{const t=a=>{if(!(a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement))switch(a.key){case" ":case"k":a.preventDefault(),f();break;case"m":T();break;case"f":F();break;case"ArrowLeft":a.preventDefault(),n.current&&(n.current.currentTime=Math.max(0,n.current.currentTime-10));break;case"ArrowRight":a.preventDefault(),n.current&&(n.current.currentTime=Math.min(u,n.current.currentTime+10));break;case"ArrowUp":if(a.preventDefault(),n.current){const i=Math.min(1,m+.1);l(i),n.current.volume=i,w(i===0)}break;case"ArrowDown":if(a.preventDefault(),n.current){const i=Math.max(0,m-.1);l(i),n.current.volume=i,w(i===0)}break}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[f,u,m]),e.jsxs("div",{ref:g,className:`relative group bg-black rounded-lg overflow-hidden ${y}`,onMouseMove:D,onMouseLeave:()=>c&&k(!1),children:[e.jsx("video",{ref:n,src:C,poster:b,className:"w-full h-full object-contain relative z-0",onClick:f,playsInline:!0}),j&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-20",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"})}),!c&&!j&&e.jsx("button",{onClick:f,className:"absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 transition-colors z-10",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/90 flex items-center justify-center hover:bg-primary transition-colors z-20",children:e.jsx(A,{className:"w-8 h-8 text-primary-foreground fill-primary-foreground ml-1"})})}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent px-4 py-3 transition-opacity duration-300 z-30 ${z?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"relative mb-3",children:e.jsx("input",{type:"range",min:0,max:u||100,value:p,onChange:O,className:"w-full h-1 z-[100] bg-white/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-125",style:{background:`linear-gradient(to right, hsl(var(--primary)) ${p/u*100}%, rgba(255,255,255,0.3) ${p/u*100}%)`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:f,className:"text-white hover:text-primary transition-colors",children:c?e.jsx(H,{className:"w-6 h-6"}):e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:T,className:"text-white hover:text-primary transition-colors",children:x||m===0?e.jsx(U,{className:"w-5 h-5"}):e.jsx(W,{className:"w-5 h-5"})}),e.jsx("input",{type:"range",min:0,max:1,step:.1,value:x?0:m,onChange:M,className:"w-20 h-1 bg-white/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer"})]}),e.jsxs("span",{className:"text-white text-sm",children:[o(p)," / ",o(u)]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:F,className:"text-white hover:text-primary transition-colors",children:e.jsx(B,{className:"w-5 h-5"})})})]})]})]})},re=({title:C,imageSrcs:b,imageSrc:y,children:n,open:g,onOpenChange:c})=>{const[v,p]=s.useState(!1),[d,u]=s.useState(0),h=g!==void 0?g:v,m=c||p,l=K.useMemo(()=>b&&b.length>0?b:y?[y]:[],[b,y]),x=r=>{const f=[".mp4",".mov",".avi",".webm",".mkv",".m4v"].some(T=>r.toLowerCase().endsWith(T)),M=r.startsWith("data:video/");return f||M},w=l[d]&&x(l[d])?"video":"image";s.useEffect(()=>{h&&u(0)},[h]),s.useEffect(()=>{if(!h)return;const r=o=>{o.key==="ArrowLeft"?N():o.key==="ArrowRight"?E():o.key==="Escape"&&m(!1)};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[h,l.length]);const N=s.useCallback(()=>{u(r=>r===0?l.length-1:r-1)},[l.length]),E=s.useCallback(()=>{u(r=>r===l.length-1?0:r+1)},[l.length]),z=s.useCallback(r=>{u(r)},[]),k=()=>{m(!1)},j=l.length>1,L=r=>{const o=r.target;o.src="/static/logo.webp"};return l.length===0?null:e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{onClick:()=>m(!0),className:"cursor-pointer",children:n}),e.jsx(_,{open:h,onOpenChange:m,children:e.jsxs(J,{className:"sm:max-w-2xl max-h-[90vh] p-0 overflow-hidden z-[100]",children:[e.jsx("button",{onClick:k,className:"absolute right-4 top-4 z-50 rounded-full bg-background/80 p-1 hover:bg-background/100 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(Q,{className:"px-6 pt-6 pb-2 z-10 relative",children:e.jsx(Y,{className:"pr-8",children:C})}),e.jsxs("div",{className:"relative w-full h-[60vh] max-h-[60vh] bg-muted/30",children:[e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:w==="video"?e.jsx(ee,{src:l[d],className:"w-full h-full z-10 relative"}):e.jsx("img",{src:l[d],alt:`${C} - ${d+1} of ${l.length}`,className:"max-w-full max-h-full object-contain z-10 relative",onError:L})}),j&&e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"outline",size:"sm",className:"absolute left-2 top-1/2 -translate-y-1/2 w-10 h-10 p-0 rounded-full bg-background/80 backdrop-blur-sm hover:bg-background/100 z-20",onClick:N,children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx(P,{variant:"outline",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 w-10 h-10 p-0 rounded-full bg-background/80 backdrop-blur-sm hover:bg-background/100 z-20",onClick:E,children:e.jsx(G,{className:"w-5 h-5"})})]}),j&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-20",children:l.map((r,o)=>e.jsx("button",{className:`w-2.5 h-2.5 rounded-full transition-all ${o===d?"bg-primary scale-110":"bg-background/60 hover:bg-background/80"}`,onClick:()=>z(o)},o))})]}),j&&e.jsxs("div",{className:"text-center text-sm text-muted-foreground pb-2 z-10 relative",children:[d+1," / ",l.length]}),e.jsx(Z,{className:"px-6 pb-6 z-10 relative",children:e.jsx(P,{variant:"outline",onClick:k,children:"Close"})})]})})]})};export{ee as C,re as P};
