import{r as e,j as t,aw as a,ax as r,ay as s,a2 as n,az as l,ae as i,ad as o}from"./vendor-react-Tc4xLtOv.js";import{l as c}from"./vendor-print-DSbiJ92d.js";import{c as d,A as m,e as u,B as h,u as f,a as x}from"./index-CCl3TzR2.js";import{c as p,E as g}from"./vendor-pdf-export-C4gp01y5.js";import{D as y,a as w,b,e as j,c as v,d as k}from"./dropdown-menu-Dweh6OYL.js";import{R as N,B as S,Y as C,X as L,T as $,b as E,P as R,d as F,C as P}from"./vendor-charts-DKw1ZHYY.js";const I={normal:["#894829","#f69568","#d97706","#dc2626","#059669","#7c3aed","#db2777","#0891b2"]},T=e=>{const t=e.reduce((e,t)=>e+(t.value||0),0);return 0===t?e.map(e=>({...e,percentage:0})):e.map(e=>({...e,percentage:(e.value||0)/t*100}))},A=(e,t)=>e.includes(t)?e.filter(e=>e!==t):[...e,t];class z{intervalId=null;callback=null;start(e,t=3e4){this.stop(),this.callback=e,this.intervalId=setInterval(e,t)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.callback=null}isRunning(){return null!==this.intervalId}getLastUpdateTime(){return null}}const U=({dashboardRef:n,tableData:l=[],tableColumns:i=[],title:o="Admin Dashboard",dateRange:f="",filterState:x,className:k=""})=>{const[N,S]=e.useState(!1),C=e.useRef(null),L=e.useCallback(()=>{if(!n?.current||!C.current)return null;const e=n.current,t=C.current;t.innerHTML="";const a=e.cloneNode(!0);a.querySelectorAll("*").forEach(e=>{const t=e;t.classList.value=t.classList.value.replace(/\s(md|lg|xl|2xl):/g," ").replace(/\s(md|lg|xl|2xl):\w+/g," ").replace(/\s+(md|lg|xl|2xl)\s+/g," ").trim()}),a.className=a.className.replace(/\scontainer-mobile/g,"").replace(/\s-mobile/g,"").trim(),a.style.width="100%",a.style.maxWidth="1280px",a.style.margin="0 auto",a.style.padding="24px";a.querySelectorAll('[class*="grid-cols-1"]').forEach(e=>{const t=e;t.className=t.className.replace(/grid-cols-1/g,"grid-cols-2").replace(/lg:grid-cols-2/g,"lg:grid-cols-2").replace(/md:grid-cols-2/g,"md:grid-cols-2")});return a.querySelectorAll('[class*="gap-4"]').forEach(e=>{const t=e;(t.innerHTML.includes("Total Sales")||t.innerHTML.includes("Avg Order Value"))&&(t.className=t.className.replace(/grid-cols-1/g,"grid-cols-4").replace(/lg:grid-cols-4/g,"lg:grid-cols-4").replace(/md:grid-cols-2/g,"md:grid-cols-4"))}),t.style.position="fixed",t.style.left="-9999px",t.style.top="0",t.style.width="1280px",t.style.backgroundColor="#ffffff",t.style.zIndex="-1",t.style.overflow="visible",t.appendChild(a),t},[n,C]),$=e.useCallback(()=>{C.current&&(C.current.innerHTML="")},[C]),E=c.useReactToPrint({contentRef:n,documentTitle:`${o} - ${f}`,onBeforePrint:()=>(S(!0),Promise.resolve()),onAfterPrint:()=>{S(!1),d.success("PDF printed successfully!")},onPrintError:e=>{S(!1),d.error("Failed to print PDF")}}),R=e.useCallback(async()=>{S(!0),L(),await new Promise(e=>setTimeout(e,100));const e=C.current;if(e)try{p.download(e,{quality:1,backgroundColor:"#ffffff",filename:`${o}.png`}).then(()=>{S(!1),$()}).catch(e=>{S(!1),$()})}catch(t){S(!1),$()}else S(!1)},[L,$]),[F,P]=e.useState("idle"),I=e.useCallback(async()=>{if(l.length&&i.length){S(!0);try{const e=localStorage.getItem("token");await new Promise((t,a)=>{m.postData({endpoint:"/admin/export-data",body:{request:u(x)},responseType:"blob",Authorization:`Bearer ${e}`,successCallback:e=>{const a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=`${o.toLowerCase().replace(/\s+/g,"-")}-data.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),t()},errorCallback:e=>{a(e)}})}),d.success("Table data exported successfully!")}catch(e){d.error(`Failed to export table: ${e instanceof Error?e.message:"Unknown error"}`)}finally{S(!1)}}else d.error("No table data available for export")},[l,i,o,f,x]),T=N||"preparing"===F;return t.jsxs("div",{className:`flex items-center gap-2 ${k}`,children:[t.jsx("div",{ref:C,className:"desktop-clone-container",style:{position:"fixed",left:"-9999px",top:"0",width:"1280px",backgroundColor:"#ffffff",zIndex:"-1",overflow:"visible"}}),t.jsxs(y,{children:[t.jsx(w,{asChild:!0,children:t.jsxs(h,{variant:"outline",size:"default",disabled:T,className:"flex items-center gap-2 basis-45 dark:border-green-600 hover:text-primary",children:[t.jsx(a,{className:"h-4 w-4"}),"preparing"===F?"Preparing...":"Export All"]})}),t.jsxs(b,{align:"end",className:"w-56",children:[t.jsx(j,{children:"Dashboard"}),t.jsx(v,{onClick:E,disabled:T||!n,children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(r,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:N?"Printing...":"Print"})]})}),t.jsx(v,{onClick:async()=>{S(!0),L(),await new Promise(e=>setTimeout(e,100));try{await(async(e,t={},a="Admin Dashboard")=>{const{quality:r=1,backgroundColor:s="#ffffff",format:n="a4",orientation:l="portrait"}=t;try{const t=Array.from(document.getElementsByTagName("html")[0].classList);t.indexOf("dark")>-1&&document.getElementsByTagName("html")[0].classList.remove("dark");const i=await p.toPng(e,{quality:r,backgroundColor:s,type:"png"});if(t.indexOf("dark")>-1&&document.getElementsByTagName("html")[0].classList.add("dark"),!i)throw new Error("Failed to capture element with Snapdom");const o=new g({orientation:l,unit:"mm",format:n}),c=o.internal.pageSize.getWidth(),d=o.internal.pageSize.getHeight(),m=i.width,u=i.height,h=Math.min(c/m,d/u),f=m*h,x=u*h,y=(c-f)/2,w=(d-x)/2;return o.addImage(i,"PNG",y,w,f,x),o.save(`${a}.pdf`),o.output("blob")}catch(i){throw new Error(`Failed to create PDF blob: ${i instanceof Error?i.message:"Unknown error"}`)}})(C?.current,{quality:1,backgroundColor:"#ffffff",format:"a4",orientation:"portrait"},o)}catch(e){}finally{S(!1),$()}},disabled:T||!n,className:"hidden lg:block",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(r,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:N?"Printing...":"Download PDF"})]})}),t.jsx(v,{onClick:R,disabled:T||!n,className:"hidden lg:block",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(r,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:N?"Printing...":"Download PNG"})]})}),t.jsxs(v,{onClick:I,disabled:T||!l.length||!i.length,children:[t.jsx(s,{className:"h-4 w-4 mr-2"}),"Data Tables (Excel)"]})]})]})]})},G=e=>{const t=e.cloneNode(!0),a=window.getComputedStyle(document.body).fontFamily||'var(--default-font-family, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji")';t.querySelectorAll("text, tspan").forEach(e=>{const t=e,r=window.getComputedStyle(e);t.style.fontFamily||(t.style.fontFamily=a),!t.style.fontSize&&r.fontSize&&(t.style.fontSize=r.fontSize),!t.style.fontWeight&&r.fontWeight&&(t.style.fontWeight=r.fontWeight),!t.style.fill&&r.color&&(t.style.fill=r.color)});const r=document.createElementNS("http://www.w3.org/2000/svg","style");return r.textContent=`\n    text, tspan {\n      font-family: ${a} !important;\n      font-size: inherit !important;\n      font-weight: inherit !important;\n      fill: inherit !important;\n    }\n  `,t.insertBefore(r,t.firstChild),t},K=(e,t=800,a=600)=>new Promise((r,s)=>{try{if(!e)return void s(new Error("SVG element is null or undefined"));if(!(e instanceof SVGElement))return void s(new Error("Provided element is not an SVG element"));const n=t,l=a,i=G(e),o=(new XMLSerializer).serializeToString(i);if(!o||0===o.length)return void s(new Error("Failed to serialize SVG element"));const c=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),d=URL.createObjectURL(c),m=new Image;m.crossOrigin="anonymous",m.onload=()=>{try{const e=document.createElement("canvas");e.width=n,e.height=l;const t=e.getContext("2d");if(!t)return URL.revokeObjectURL(d),void s(new Error("Could not get 2D context for canvas"));t.fillStyle="white",t.fillRect(0,0,n,l);const a=20,i=n-2*a,o=l-2*a,c=i/m.naturalWidth,u=o/m.naturalHeight,h=Math.min(c,u,1),f=m.naturalWidth*h,x=m.naturalHeight*h,p=a+(i-f)/2,g=a+(o-x)/2;t.drawImage(m,p,g,f,x);const y=e.toDataURL("image/png");if(URL.revokeObjectURL(d),!y||"data:,"===y)return void s(new Error("Failed to create PNG data URL"));r(y)}catch(e){URL.revokeObjectURL(d),s(e)}},m.onerror=()=>{URL.revokeObjectURL(d),s(new Error("Failed to load SVG image"))},m.src=d}catch(n){s(n)}}),D=async(e,t=800,a=600,r=3,s=100)=>{if(!e)return null;let n=null;for(let i=0;i<r;i++)try{if(!document.body.contains(e))throw new Error("Element is not attached to the document");const n=e.querySelector("svg");if(!n){if(i<r-1){await new Promise(e=>setTimeout(e,s));continue}return null}const l=window.getComputedStyle(n);if("none"===l.display||"hidden"===l.visibility)throw new Error("SVG element is hidden");const o=n.getBoundingClientRect();if(0===o.width||0===o.height){if(i<r-1){await new Promise(e=>setTimeout(e,s));continue}throw new Error("SVG element has zero dimensions")}const c=await K(n,t,a);if(!c||"data:,"===c)throw new Error("Failed to create PNG data URL from SVG");return c}catch(l){n=l,i<r-1&&await new Promise(e=>setTimeout(e,s))}return null},V=({containerRef:r,data:s,title:i,filename:o="chart",className:c="",variant:m="default"})=>{const[u,f]=e.useState(!1),x=async()=>{if(r.current){f(!0);try{await(async(e,t={})=>{const{filename:a="chart",width:r=800,height:s=600}=t;if(!e)throw new Error("Element is null or undefined");const n=await D(e,r,s);if(!n)throw new Error("Failed to convert chart to PNG after all retries");try{const e=document.createElement("a");e.download=`${a}.png`,e.href=n,document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(l){throw new Error(`Failed to trigger download: ${l}`)}})(r.current,{filename:o}),d.success("Chart exported as PNG successfully!")}catch(e){d.error(`Failed to export PNG: ${e}`)}finally{f(!1)}}},p=()=>{if(r.current)try{((e,t="chart")=>{const a=e.querySelector("svg");if(!a)throw new Error("No SVG element found");const r=G(a),s=(new XMLSerializer).serializeToString(r),n=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(n),i=document.createElement("a");i.href=l,i.download=`${t}.svg`,i.click(),URL.revokeObjectURL(l)})(r.current,o),d.success("Chart exported as SVG successfully!")}catch(e){d.error(`Failed to export SVG: ${e}`)}},g=async()=>{if(r.current){f(!0);try{await(async e=>{const t=await D(e);if(!t)throw new Error("Failed to convert chart to image");const a=await fetch(t),r=await a.blob();await navigator.clipboard.write([new ClipboardItem({[r.type]:r})])})(r.current),d.success("Chart copied to clipboard!")}catch(e){d.error(`Failed to copy chart: ${e}`)}finally{f(!1)}}},N=async()=>{f(!0);try{await(async(e,t)=>{const a=`${t}\n${e.map(e=>{if(e.totalStock||e.stock)return`${e.category||e.item||e.name}: Cost ₹${e.costValue?.toLocaleString()||0}, Stock: ${e.availableStock||e.totalStock||e.stock}`;if(e.locationName)return`${e.locationName}: Cost ₹${e.costValue?.toLocaleString()||0}, Stock: ${e.availableStock||e.totalStock}`;if(e?.availableStock>=0){const t=e?.costValue?`₹${e.costValue.toLocaleString()}`:"₹0",a=e?.availableStock||0,r=e?.pendingQuantity||e?.unfulfilledQuantity||0,s=e.fulfilledQuantity||0;return r>0||s>0?`${e.name||e.product} : ${t}, Stock: ${a}, ${s} Fulfilled, ${r} Pending`:`${e.name||e.product} : ${t}, Stock: ${a}`}return`${e.product||e.category||e.orderStatus}: ${e.totalSales?"₹"+e.totalSales:e.fulfilledQuantity+" Fulfilled, "+e.pendingQuantity+" Pending"}`}).join("\n")}`;await navigator.clipboard.writeText(a)})(s,i),d.success("Chart data copied to clipboard!")}catch(e){d.error(`Failed to copy data: ${e}`)}finally{f(!1)}};return"compact"===m?t.jsx("div",{className:`flex items-center gap-2 ${c}`,children:t.jsxs(y,{children:[t.jsx(w,{asChild:!0,children:t.jsx(h,{variant:"outline",size:"sm",disabled:u,className:"h-8 w-8 p-0",children:t.jsx(a,{className:"h-4 w-4"})})}),t.jsxs(b,{align:"end",children:[t.jsxs(v,{onClick:x,disabled:u,children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),"Download PNG"]}),t.jsxs(v,{onClick:p,children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),"Download SVG"]}),t.jsx(k,{}),t.jsxs(v,{onClick:g,disabled:u,children:[t.jsx(l,{className:"h-4 w-4 mr-2"}),"Copy Image"]}),t.jsxs(v,{onClick:N,disabled:u,children:[t.jsx(l,{className:"h-4 w-4 mr-2"}),"Copy Data"]})]})]})}):t.jsx("div",{className:`flex items-center gap-2 ${c}`,children:t.jsxs(y,{children:[t.jsx(w,{asChild:!0,children:t.jsxs(h,{variant:"outline",size:"sm",disabled:u,className:"flex items-center gap-2",children:[t.jsx(a,{className:"h-4 w-4"}),"Export"]})}),t.jsxs(b,{align:"end",className:"w-48",children:[t.jsx(j,{children:"Download"}),t.jsxs(v,{onClick:x,disabled:u,children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),"PNG Image"]}),t.jsxs(v,{onClick:p,children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),"SVG Vector"]}),t.jsx(k,{}),t.jsx(j,{children:"Copy"}),t.jsxs(v,{onClick:g,disabled:u,children:[t.jsx(l,{className:"h-4 w-4 mr-2"}),"Chart Image"]}),t.jsxs(v,{onClick:N,disabled:u,children:[t.jsx(l,{className:"h-4 w-4 mr-2"}),"Chart Data"]})]})]})})},M=({active:e,payload:a,label:r})=>e&&a&&a.length?t.jsxs("div",{className:"custom-tooltip",style:{padding:"10px",borderRadius:"10px",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)"},children:[t.jsx("p",{className:"font-bold text-sm pb-1",children:r}),a.map((e,a)=>t.jsxs("p",{className:"text-sm",children:["availableStock"===e.dataKey?"Available":"pendingQuantity"===e.dataKey||"unfulfilledQuantity"===e.dataKey?"Pending":"fulfilledQuantity"===e.dataKey?"Fulfilled":e.dataKey,": ",t.jsx("span",{className:"font-bold",children:e.value})]},a))]}):null,B=e.forwardRef(({className:a,data:r,bars:s,xAxisKey:n,showGrid:l=!0,showTooltip:i=!0,showLegend:o=!1,tooltipFormatter:c,yAxisTickFormatter:d,xAxisTickFormatter:m,onClick:u,onHover:h,selectedItems:p=[],layout:g="horizontal",stacked:y=!1,barSize:w},b)=>{const[j,v]=e.useState(null),{effectiveTheme:k}=f(),R="dark"===k?"#e5e5e5":"#1a1a1a",F=()=>{v(null),h&&h(null)},P=(e,t,a)=>{const r=j===`${e}-${t}`,n=s[a]?.color||"#8884d8";return r&&s[a]?.color?I(n,-20):n},I=(e,t)=>{const a=parseInt(e.replace("#",""),16),r=Math.round(2.55*t),s=(a>>16)+r,n=(a>>8&255)+r,l=(255&a)+r;return"#"+(16777216+65536*(s<255?s<1?0:s:255)+256*(n<255?n<1?0:n:255)+(l<255?l<1?0:l:255)).toString(16).slice(1)},T=d||(e=>e>=1e6?`₹${(e/1e6).toFixed(1)}M`:e>=1e3?`₹${(e/1e3).toFixed(1)}K`:`₹${e}`);return t.jsx("div",{ref:b,className:x("w-full",a),children:t.jsx(N,{width:"100%",height:485,children:t.jsxs(S,{data:r,layout:g,margin:{top:20,right:30,left:20,bottom:10},children:[l&&t.jsx(C,{tick:{fontSize:12,fill:R},axisLine:!1,tickLine:!1,tickFormatter:T}),t.jsx(L,{dataKey:n,tick:({x:e,y:a,payload:r})=>{const s=((e,t=12)=>{if(!e)return"";if(e.length<=t)return e;const a=e.split(" "),r=[];let s="";for(const n of a)(s+" "+n).trim().length<=t?s=(s+" "+n).trim():(s&&r.push(s),s=n);return s&&r.push(s),r.join("\n")})(String(r.value),10);return t.jsx("text",{x:e,y:a,fill:R,textAnchor:"end",transform:`rotate(-45, ${e}, ${a})`,className:"text-sm font-medium",children:s.split("\n").map((a,r)=>t.jsx("tspan",{x:e,dy:0===r?0:14,children:a},r))})},axisLine:!1,tickLine:!1,height:100}),i&&t.jsx($,{content:t.jsx(M,{})}),s.map((e,a)=>t.jsx(E,{dataKey:e.dataKey,fill:P(e.dataKey,"",a),name:e.name,radius:[4,4,0,0],stackId:y?"stack":void 0,barSize:w,onClick:e=>((e,t)=>{u&&u(e,t)})(e.payload,a),onMouseEnter:e=>((e,t)=>{const a=e[n]||"unknown";v(`${s[t].dataKey}-${a}`),h&&h(e)})(e.payload,a),onMouseLeave:F,style:{cursor:u?"pointer":"default",transition:"all 0.3s ease"}},e.dataKey))]})})})});B.displayName="BarChart";e.forwardRef((e,a)=>t.jsx(B,{ref:a,...e,stacked:!0,bars:e.bars.map(e=>({...e,stackId:"stack"}))})).displayName="StackedBarChart";const H=({data:a,title:r,bars:s,selectedItems:n,onItemClick:l,onItemHover:i,theme:o,showPercentage:c=!1,showExportControls:d=!0,yAxisTickFormatter:m,xAxisTickFormatter:u})=>{const h=e.useRef(null),[f,x]=e.useState(!1);e.useEffect(()=>{const e=window.matchMedia("print"),t=e=>x(e.matches);return x(e.matches),e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]);const p=s.map((e,t)=>({dataKey:e.dataKey,name:e.name,color:e.color||I.normal[t%I.normal.length]}));return t.jsxs("div",{className:"w-full",children:[d&&t.jsx("div",{className:"flex justify-end items-center mb-4 no-print",children:t.jsx(V,{containerRef:h,data:a,title:r,filename:r.toLowerCase().replace(/\s+/g,"-"),variant:"compact"})}),t.jsx("div",{ref:h,style:{width:f?"80%":"100%",margin:"0 auto"},children:t.jsx(B,{data:a,bars:p,xAxisKey:"product",showGrid:!0,showTooltip:!0,tooltipFormatter:(e,t)=>t.toLowerCase().includes("quantity")||"Quantity"===t?e.toLocaleString():`₹${e.toLocaleString()}`,yAxisTickFormatter:m,xAxisTickFormatter:u,onClick:(e,t)=>{l(e)},onHover:e=>{i(e)},selectedItems:n,layout:"horizontal",stacked:!1})})]})},O=({data:e,selectedItems:a,onItemToggle:r,theme:s,showPercentage:n=!0,formatAsCurrency:l=!0,className:c=""})=>{const d=t=>{const a=e.find(e=>e.name===t);return a?.color||"#8884d8"},m=e=>a.includes(e),u=(e,t=!1)=>l?`₹${e.toLocaleString()}`:e.toLocaleString();return t.jsxs("div",{className:`w-full InteractiveLegend ${c}`,children:[a.length>0&&t.jsx("div",{className:"mb-3 flex justify-end",children:t.jsxs("button",{onClick:()=>a.forEach(e=>r(e)),className:"text-xs text-muted-foreground hover:text-primary transition-colors px-2 py-1 rounded hover:bg-accent/50",children:["Clear All Filters (",a.length,")"]})}),t.jsx("div",{className:"print:overflow-visible overflow-y-auto print:scrollbar-hide h-20 print:h-auto",children:t.jsx("div",{className:"grid grid-cols-2 gap-1 print:columns-2 print:gap-1 print:!grid-cols-none print:w-full",children:e.map((e,a)=>t.jsxs("div",{className:"flex items-center gap-1 px-3 py-2 print:w-8 print:px-0.5 print:py-0.5 print:text-xs rounded-lg transition-all duration-200 cursor-pointer hover:bg-accent/50 legend-item "+(m(e.name)?"bg-primary/10 border border-primary/20":"border border-transparent"),onClick:()=>r(e.name),children:[t.jsx("div",{className:"relative",children:m(e.name)?t.jsx(i,{className:"w-4 h-4 text-primary",style:{color:d(e.name)}}):t.jsx(o,{className:"w-4 h-4 text-muted-foreground"})}),t.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:d(e.name)}}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-medium "+(m(e.name)?"text-primary":"text-foreground"),children:e.name}),n&&e.percentage&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.percentage.toFixed(1),"% • ",u(e.value)]}),!n&&t.jsx("div",{className:"text-xs "+(m(e.name)?"text-primary":"text-muted-foreground"),children:u(e.value)})]})]},e.name))})})]})};const q=e.forwardRef(({className:a,data:r,dataKey:s,nameKey:n,colors:l,innerRadius:i,outerRadius:o,paddingAngle:c=1,showLabel:d=!0,showTooltip:m=!0,tooltipFormatter:u,labelFormatter:h,onClick:f,onHover:p,selectedItems:g=[],activeShape:y,theme:w,...b},j)=>{const{width:v,height:k}=function(){const[t,a]=e.useState({width:null,height:null});return e.useLayoutEffect(()=>{const e=()=>{a({width:window.innerWidth,height:window.innerHeight})};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),t}(),S=v<640,C=v>=640&&v<1024,L=S?60:C?80:100,E=S?70:C?100:120,I=S||C?L:i??L,T=S||C?E:o??E,A=l||["#894829","#f69568","#d97706","#dc2626","#059669","#7c3aed","#db2777","#0891b2"],z="dark"===w?"#f5f5f5":"#1a1a1a",U=r.reduce((e,t)=>e+(t[s]||0),0),G=({active:e,payload:a,theme:r})=>{if(!e||!a?.length)return null;const l=a[0].payload,i=U>0?l[s]/U*100:0,o="dark"===r;return t.jsxs("div",{className:x("rounded-lg border p-3 shadow-md",o?"bg-slate-800 border-slate-700 text-white":"bg-white border-gray-300 text-black"),children:[t.jsx("p",{className:"font-medium text-sm mb-2",children:l[n]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:o?"text-gray-300":"text-gray-600",children:"Value:"}),t.jsx("span",{className:"font-medium",children:u?u(l[s],l[n],l):`₹${l[s].toLocaleString()}`})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:o?"text-gray-300":"text-gray-600",children:"Percentage:"}),t.jsxs("span",{className:"font-medium",children:[i.toFixed(1),"%"]})]})]})]})};return t.jsx("div",{ref:j,className:x("w-full pb-8",a),...b,children:t.jsx(N,{width:"100%",height:450,children:t.jsxs(R,{children:[t.jsx(F,{data:r,innerRadius:I,outerRadius:T,paddingAngle:c,dataKey:s,nameKey:n,onClick:(e,t)=>{f&&f(e,t)},label:({name:e,value:a,percent:r=0,cx:s,cy:n,midAngle:l=0})=>{let i=`${e||""} ${`₹${a.toLocaleString()}`} (${(100*r).toFixed(0)}%)`;h&&(i=h(e||"",a,{name:e,value:a,percent:r}));const o=((e,t=15)=>{if(!e)return"";if(e.length<=t)return e;const a=e.split(" "),r=[];let s="";for(const n of a)(s+" "+n).trim().length<=t?s=(s+" "+n).trim():(s&&r.push(s),s=n);return s&&r.push(s),r.join("\n")})(i,12),c=Math.PI/180,d=(l+360)%360,m=T+20+(d>150&&d<210?0:15),u=s+m*Math.cos(-l*c),f=n+m*Math.sin(-l*c),x=u>s?"start":"end";return t.jsx("text",{x:u,y:f,fill:z,textAnchor:x,dominantBaseline:"central",className:"text-sm font-medium",children:o.split("\n").map((e,a)=>t.jsx("tspan",{x:u,dy:0===a?0:14,children:e},a))})},labelLine:!0,children:r.map((e,a)=>{const r=g.includes(String(e[n]||"")),s=a%A.length,l=A[s];return t.jsx(P,{fill:l,stroke:"var(--background)",strokeWidth:2,style:{transition:"all 0.3s ease",transformOrigin:"center",filter:r?"drop-shadow(0 0 8px rgba(59, 130, 246, 0.5))":"none",cursor:f?"pointer":"default",opacity:r?1:void 0}},`cell-${a}`)})}),m&&t.jsx($,{content:t.jsx(G,{})})]})})})});q.displayName="PieChart";e.forwardRef((e,a)=>t.jsx(q,{ref:a,...e,innerRadius:e.innerRadius??80,outerRadius:e.outerRadius??100})).displayName="DonutChart";const W=({data:a,title:r,dataKey:s,nameKey:n,selectedItems:l,onItemClick:i,onItemHover:o,theme:c,innerRadius:d=120,outerRadius:m=140,showExportControls:u=!0,labelFormatter:h,tooltipFormatter:f})=>{const x=e.useRef(null),[p,g]=e.useState(!1);e.useEffect(()=>{const e=window.matchMedia("print"),t=e=>g(e.matches);return g(e.matches),e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]);const y=a.reduce((e,t)=>e+(t[s]||0),0),w=I.normal;return t.jsxs("div",{className:"w-full",children:[u&&t.jsx("div",{className:"flex justify-end items-center mb-4 no-print",children:t.jsx(V,{containerRef:x,data:a.map(e=>({...e,percentage:y>0?(e[s]||0)/y*100:0})),title:r,filename:r.toLowerCase().replace(/\s+/g,"-"),variant:"compact"})}),t.jsx("div",{ref:x,children:t.jsx(q,{data:a,dataKey:s,nameKey:n,colors:w,innerRadius:d,outerRadius:m,paddingAngle:1,showLabel:!0,showTooltip:!0,tooltipFormatter:(e,t,a)=>f?f(e,t,a):`₹${e.toLocaleString()}`,labelFormatter:h,onClick:(e,t)=>{i(e)},onHover:e=>{o(e)},selectedItems:l,theme:c})})]})};export{z as A,U as G,W as I,O as a,H as b,T as c,I as i,A as t};
