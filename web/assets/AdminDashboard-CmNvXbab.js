import{a as e,j as s}from"./vendor-animation-CcgChT4Y.js";import{A as a}from"./AdminNavBar--NFVZBTP.js";import{C as t}from"./dropdown-menu-DjLdUzkQ.js";import{O as l}from"./OrdersTable-RSnglsfB.js";import{u as r,A as n,e as o,B as d}from"./index-QkJ4t2go.js";import{A as i,c,i as m,G as u,I as h,a as x,t as p,b as g}from"./InteractivePieChart-e0UyLK3L.js";import{C as j}from"./calendar-D3_6b9UR.js";import{C as b,c as f,a as y,b as v}from"./card-CZoDjOMW.js";import{L as N}from"./label-CdSwSrYM.js";import{P as S,a as w,b as A}from"./popover-8ziMr3tt.js";import{S as C,a as k,b as I,c as O,d as D}from"./select-BywG2TtB.js";import{R as T,F as P,f as $,D as F,i as L,a as M,j as Q}from"./vendor-icons-BYe_-sqm.js";import{f as R}from"./vendor-dates-BQQoqOpn.js";import"./TopBar-CO3pAy7f.js";import"./vendor-radix-CgisZDtL.js";import"./vendor-charts-1c3qO8Q0.js";import"./vendor-ui-utils-B4kPJlQS.js";import"./badge-DjmmXEHi.js";import"./table-18gPuSSS.js";import"./vendor-pdf-export-F3dE0gEs.js";import"./vendor-print-DRS-tmGd.js";const U=({title:e,value:a,icon:t,trend:l,trendUp:r,isLoading:n,lastUpdated:o})=>s.jsxs(b,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsx(y,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:e}),s.jsx("div",{className:"p-2 rounded-lg bg-primary/10 text-primary",children:t})]})}),s.jsxs(f,{children:[s.jsx("div",{className:"text-2xl font-bold mb-1",children:n?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(T,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):a}),l&&s.jsxs("div",{className:"flex items-center text-xs "+(r?"text-green-600":"text-red-600"),children:[s.jsx(L,{className:"w-3 h-3 mr-1"}),l]}),o&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Updated: ",R(o,"HH:mm:ss")]})]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),E=({isAutoRefreshEnabled:e,onToggleAutoRefresh:a})=>s.jsx("div",{className:"flex basis-43",children:s.jsxs(d,{variant:"outline",size:"default",onClick:a,className:"items-center gap-3 flex basis-43 w-full transition-colors hover:text-primary "+(e?"text-green-600 border-green-600":"text-muted-foreground"),children:[s.jsx(T,{className:"w-4 h-4 "+(e?"animate-spin":"")}),"Auto-Refresh"]})}),K=()=>{const{effectiveTheme:K}=r(),H=e.useRef(null),V=new Date,q=new Date(V.getFullYear(),V.getMonth(),1),B=V,[z,J]=e.useState({from:q,to:B}),{from:Y,to:G}=z||{},[W,X]=e.useState("All"),[Z,_]=e.useState("All"),[ee,se]=e.useState("All"),[ae,te]=e.useState("All"),[le,re]=e.useState(!1),[ne,oe]=e.useState([]),[de,ie]=e.useState([]),[ce,me]=e.useState([]),[ue,he]=e.useState([]),[xe,pe]=e.useState(null),[ge,je]=e.useState(!0),[be,fe]=e.useState(null),[ye,ve]=e.useState(!1),[Ne,Se]=e.useState({fromDate:Y?Y.toISOString().split("T")[0]:null,toDate:G?G.toISOString().split("T")[0]:null,orderStatus:"All"!==W?W:null,category:"All"!==Z?Z:null,product:"All"!==ee?ee:null,name:null,phone:null}),we=["Payment Processed","Ordered","Processing","Packed","Shipped"],Ae=e=>"Pending"===e?we:"Delivered"===e?["Delivered"]:"Cancelled"===e?["Cancelled"]:[],[Ce,ke]=e.useState([]),[Ie,Oe]=e.useState([]),[De,Te]=e.useState([]),[Pe,$e]=e.useState([]),[Fe,Le]=e.useState([]),[Me,Qe]=e.useState([]),[Re,Ue]=e.useState([]),[Ee,Ke]=e.useState({totalSales:0,avgOrderValue:0,totalOrders:0,pendingOrders:0}),[He,Ve]=e.useState([]),[qe,Be]=e.useState(null),[ze]=e.useState(()=>new i);e.useEffect(()=>{n.postData({endpoint:"/inventory/get-categories",body:{request:o({type:"Product"})},successCallback:e=>{Array.isArray(e)?ke(e):ke([])},errorCallback:()=>ke([])})},[]),e.useEffect(()=>{const e=localStorage.getItem("token");e&&n.get("/admin/user-list",{Authorization:`Bearer ${e}`}).then(e=>{Array.isArray(e?.users)?Te(e?.users||[]):Te([])}).catch(e=>{Te([])})},[]),e.useEffect(()=>{n.postData({endpoint:"/inventory/get-products",body:{request:o({category:"All"===Z?void 0:Z})},successCallback:e=>{Oe(e)}})},[Z]);const Je=e.useCallback(()=>{ve(!0);const e=localStorage.getItem("token");if(!e)return void ve(!1);const s=(e=>{if("All"===e||!e)return{name:null,phone:null};try{const s=JSON.parse(e);return{name:s.name,phone:s.phone}}catch(s){return{name:null,phone:null}}})(ae),a={fromDate:Y?Y.toISOString().split("T")[0]:null,toDate:G?G.toISOString().split("T")[0]:null,orderStatus:"All"!==W?W:null,category:"All"!==Z?Z:null,product:"All"!==ee?ee:null,name:s.name,phone:s.phone};Se(a),n.postData({endpoint:"/admin/dashboard-kpis",body:{request:o(a)},Authorization:`Bearer ${e}`,successCallback:e=>{Ke(e)},errorCallback:e=>{}}),n.postData({endpoint:"/admin/chart-data",body:{request:o(a)},Authorization:`Bearer ${e}`,successCallback:e=>{$e(e.totalsalesbycategory||[]),Le(e.totalsalesbyproduct||[]),Qe(e.totalsalesbyorderstatus||[]),Ue(e.productswithquantitiesbyorderstatus||[])},errorCallback:e=>{}}),n.postData({endpoint:"/admin/fetch-orders",body:{request:o(a)},Authorization:`Bearer ${e}`,successCallback:e=>{Ve(e.orders||[]),fe(new Date),ve(!1)},errorCallback:e=>{ve(!1)}})},[Y,G,W,Z,ee,ae]);e.useEffect(()=>(ge?ze.start(()=>{Je()},3e4):ze.stop(),()=>{ze.stop()}),[ge,Je,ze]),e.useEffect(()=>{me(Ae(W))},[W]),e.useEffect(()=>{Je()},[Je]);const Ye=e.useCallback(e=>{},[]),Ge=e.useCallback(e=>{},[]),We=e.useCallback(e=>{},[]),Xe=e.useCallback(e=>{},[]),Ze=e.useCallback(e=>{pe(e)},[]),_e=e.useCallback(e=>{pe(e)},[]),es=e.useCallback(e=>{pe(e)},[]),ss=e.useCallback(e=>{pe(e)},[]),as=e.useCallback(()=>{je(e=>!e)},[]),ts=()=>Y&&G?`${R(Y,"dd/MM/yyyy")} - ${R(G,"dd/MM/yyyy")}`:"Select date range",ls=e.useMemo(()=>c(Pe.map((e,s)=>({...e,name:e.category,value:e.totalSales,color:m.normal[s%m.normal.length]}))),[Pe]),rs=e.useMemo(()=>c(Fe.map((e,s)=>({...e,name:e.product,value:e.totalSales,color:m.normal[(s+3)%m.normal.length]}))),[Fe]),ns=e.useMemo(()=>c(Me.map((e,s)=>({...e,name:e.orderStatus,value:e.totalSales,color:m.normal[(s+6)%m.normal.length]}))),[Me]),os=e.useMemo(()=>{const e=Re.reduce((e,s)=>e+(s.pendingQuantity||0)+(s.fulfilledQuantity||0),0);return Re.map((s,a)=>({...s,name:s.product,value:(s.pendingQuantity||0)+(s.fulfilledQuantity||0),percentage:e>0?((s.pendingQuantity||0)+(s.fulfilledQuantity||0))/e*100:0,color:m.normal[a%m.normal.length]}))},[Re]);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"min-h-screen",children:[s.jsx(a,{}),s.jsxs("div",{className:"container mx-auto p-6 space-y-6",ref:H,children:[s.jsx("div",{className:"p-0 m-0 flex justify-end items-center",children:be&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated: ",R(be,"dd/mm/yyyy HH:mm:ss")]})}),s.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-4",children:[s.jsx("h1",{className:"text-primary text-2xl font-bold",children:"Admin Dashboard"}),s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsx("div",{className:"flex basis-43",children:s.jsx(E,{isAutoRefreshEnabled:ge,onToggleAutoRefresh:as})}),s.jsxs(d,{variant:"outline",onClick:Je,disabled:ye,className:"flex items-center gap-2 flex basis-47 dark:border-green-600 hover:text-primary",children:[s.jsx(T,{className:"h-4 w-4 "+(ye?"animate-spin":"")}),"Refresh"]})]}),s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsxs(d,{variant:"outline",onClick:()=>re(!le),className:"flex items-center gap-2 hover:text-primary transition-colors flex basis-40 dark:border-green-600",children:[s.jsx(P,{className:"h-4 w-4"}),"Filters"]}),s.jsx("div",{className:"flex-1",children:s.jsx(u,{dashboardRef:H,tableData:He,filterState:Ne,tableColumns:[{key:"orderId",label:"Order ID"},{key:"customerName",label:"Customer"},{key:"orderStatus",label:"Status"},{key:"totalAmount",label:"Amount"},{key:"orderDate",label:"Date"}],title:"Admin Dashboard",kpis:Ee,dateRange:ts()})})]})]})]}),le&&s.jsx(b,{className:"mb-6 shadow-sm border-0 bg-card/50 backdrop-blur-sm",children:s.jsx(f,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{children:"Date Range"}),s.jsxs(S,{children:[s.jsx(w,{asChild:!0,children:s.jsxs(d,{variant:"outline",className:`w-full justify-start text-left font-normal hover:bg-accent transition-colors ${!Y&&!G&&"text-muted-foreground"}`,children:[s.jsx($,{className:"mr-2 h-4 w-4"}),ts()]})}),s.jsx(A,{className:"w-auto p-0",align:"start",children:s.jsx(j,{mode:"range",selected:z,onSelect:J,numberOfMonths:1,autoFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{children:"Order Status"}),s.jsxs(C,{value:W,onValueChange:X,children:[s.jsx(k,{className:"hover:bg-accent transition-colors",children:s.jsx(I,{placeholder:"Select status"})}),s.jsxs(O,{children:[s.jsx(D,{value:"All",children:"All"}),s.jsx(D,{value:"Pending",children:"Pending"}),s.jsx(D,{value:"Delivered",children:"Delivered"}),s.jsx(D,{value:"Cancelled",children:"Cancelled"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{children:"Category"}),s.jsxs(C,{value:Z,onValueChange:_,children:[s.jsx(k,{className:"hover:bg-accent transition-colors",children:s.jsx(I,{placeholder:"Select Category"})}),s.jsxs(O,{children:[s.jsx(D,{value:"All",children:"All"}),Ce.map(e=>s.jsx(D,{value:e.category,children:e.category},e.category))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{children:"Product"}),s.jsxs(C,{value:ee,onValueChange:se,children:[s.jsx(k,{className:"hover:bg-accent transition-colors",children:s.jsx(I,{placeholder:"Select product"})}),s.jsxs(O,{children:[s.jsx(D,{value:"All",children:"All"}),Ie?.map(e=>s.jsx(D,{value:e.name,children:e.name},e.name))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(N,{children:"User"}),s.jsxs(C,{value:ae,onValueChange:te,children:[s.jsx(k,{className:"hover:bg-accent transition-colors",children:s.jsx(I,{placeholder:"Select user"})}),s.jsxs(O,{children:[s.jsx(D,{value:"All",children:"All"}),De.map(e=>s.jsxs(D,{value:JSON.stringify(e),children:[e.name," (",e.phone,")"]},`${e.name}-${e.phone}`))]})]})]})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(U,{title:"Total Sales",value:`₹${Ee.totalSales?.toLocaleString()||"0"}`,icon:s.jsx(F,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Avg Order Value",value:`₹${Ee.avgOrderValue?.toFixed(2).toLocaleString()||"0.00"}`,icon:s.jsx(L,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Total Orders",value:Ee.totalOrders||0,icon:s.jsx(M,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be}),s.jsx(U,{title:"Pending Orders",value:Ee.pendingOrders||0,icon:s.jsx(Q,{className:"h-4 w-4"}),isLoading:ye,lastUpdated:be})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(b,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"category",children:[s.jsx(y,{children:s.jsxs(v,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Category"]})}),s.jsxs(f,{className:"space-y-4",children:[s.jsx(h,{data:Pe,title:"Total Sales by Category",dataKey:"totalSales",nameKey:"category",selectedItems:ne,onItemClick:Ye,onItemHover:Ze,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`,theme:K}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(x,{data:ls,selectedItems:ne,onItemToggle:e=>{oe(s=>p(s,e)),_(e===Z?"All":e)},theme:K})]})]})]}),s.jsxs(b,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"product",children:[s.jsx(y,{children:s.jsxs(v,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Product"]})}),s.jsxs(f,{className:"space-y-4",children:[s.jsx(h,{data:rs,title:"Total Sales by Product",dataKey:"value",nameKey:"name",selectedItems:de,onItemClick:Ge,onItemHover:_e,theme:K,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(x,{data:rs,selectedItems:de,onItemToggle:e=>{ie(s=>p(s,e)),he(s=>p(s,e)),se(e===ee?"All":e)},theme:K})]})]})]}),s.jsxs(b,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"status",children:[s.jsx(y,{children:s.jsxs(v,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Total Sales by Order Status"]})}),s.jsxs(f,{className:"space-y-4",children:[s.jsx(h,{data:Me,title:"Total Sales by Order Status",dataKey:"totalSales",nameKey:"orderStatus",selectedItems:ce,labelFormatter:(e,s,a)=>`${e} ₹${s.toLocaleString()} (${(100*a.percent).toFixed(2)}%)`,onItemClick:We,onItemHover:es,theme:K}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(x,{data:ns,selectedItems:ce,onItemToggle:e=>{const s=(e=>we.includes(e)?"Pending":e)(e);X(s===W?"All":s),me(Ae(s===W?"All":s))},theme:K})]})]})]}),s.jsxs(b,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 border-0 bg-card/50 backdrop-blur-sm","data-chart":"quantities",children:[s.jsx(y,{children:s.jsxs(v,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),"Products with Quantities by Order Status"]})}),s.jsxs(f,{className:"space-y-4",children:[s.jsx(g,{data:Re,title:"Products with Quantities by Order Status",bars:[{dataKey:"pendingQuantity",name:"Pending",color:"#f69568"},{dataKey:"fulfilledQuantity",name:"Fulfilled",color:"#059669"}],selectedItems:ue,onItemClick:Xe,onItemHover:ss,theme:K,showPercentage:!0,yAxisTickFormatter:e=>e.toLocaleString()}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Filter & Legend"}),s.jsx(x,{data:os,selectedItems:ue,onItemToggle:e=>{he(s=>p(s,e)),ie(s=>p(s,e)),se(e===ee?"All":e)},theme:K,showPercentage:!0,formatAsCurrency:!1})]})]})]})]}),s.jsx(b,{className:"shadow-lg border-0 bg-card/50 backdrop-blur-sm",children:s.jsx(f,{children:s.jsx(l,{orders:He,expandedOrderId:qe,setExpandedOrderId:Be,viewType:"ViewOnly"})})})]})]}),s.jsx("div",{className:"no-print",children:s.jsx(t,{})})]})};export{K as default};
